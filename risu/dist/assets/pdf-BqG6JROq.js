var La=Object.defineProperty;var zi=fe=>{throw TypeError(fe)};var Da=(fe,Ae,ve)=>Ae in fe?La(fe,Ae,{enumerable:!0,configurable:!0,writable:!0,value:ve}):fe[Ae]=ve;var he=(fe,Ae,ve)=>Da(fe,typeof Ae!="symbol"?Ae+"":Ae,ve),Vs=(fe,Ae,ve)=>Ae.has(fe)||zi("Cannot "+ve);var t=(fe,Ae,ve)=>(Vs(fe,Ae,"read from private field"),ve?ve.call(fe):Ae.get(fe)),F=(fe,Ae,ve)=>Ae.has(fe)?zi("Cannot add the same private member more than once"):Ae instanceof WeakSet?Ae.add(fe):Ae.set(fe,ve),R=(fe,Ae,ve,Xt)=>(Vs(fe,Ae,"write to private field"),Xt?Xt.call(fe,ve):Ae.set(fe,ve),ve),x=(fe,Ae,ve)=>(Vs(fe,Ae,"access private method"),ve);var Be=(fe,Ae,ve,Xt)=>({set _(Zt){R(fe,Ae,Zt,ve)},get _(){return t(fe,Ae,Xt)}});import{_ as Ge,__tla as Oa}from"./index-C69vQpjh.js";let ji,Vi,$i,Ui,Gi,qi,Wi,Xi,Ki,Yi,Qi,Ji,Zi,tn,en,sn,nn,an,rn,on,hn,ln,cn,dn,un,pn,gn,mn,fn,An,bn,vn,yn,_n,En,xn,wn,Sn,Tn,Cn,Pn,kn,Mn,Rn,Fn,In,Ba=Promise.all([(()=>{try{return Oa}catch{}})()]).then(async()=>{var fe={640:(Zt,Nt,lt)=>{var kt,ne,qe,Ln,Dn,ue,O,s,e,i,o,l,g,_,G,w,r,u,I,at,nt,st,gt,On,Es,$s,Us,J,C,d,T,k,K,rt,Gs,ft,It,m,Q,Bn,qs;lt.d(Nt,{AnnotationLayer:()=>me,FreeTextAnnotationElement:()=>Ct,InkAnnotationElement:()=>jt,StampAnnotationElement:()=>Wt});var c=lt(266),it=lt(473),P=lt(780);function W(bt){return Math.floor(Math.max(0,Math.min(1,bt))*255).toString(16).padStart(2,"0")}function dt(bt){return Math.max(0,Math.min(255,255*bt))}class X{static CMYK_G([p,h,S,U]){return["G",1-Math.min(1,.3*p+.59*S+.11*h+U)]}static G_CMYK([p]){return["CMYK",0,0,0,1-p]}static G_RGB([p]){return["RGB",p,p,p]}static G_rgb([p]){return p=dt(p),[p,p,p]}static G_HTML([p]){const h=W(p);return`#${h}${h}${h}`}static RGB_G([p,h,S]){return["G",.3*p+.59*h+.11*S]}static RGB_rgb(p){return p.map(dt)}static RGB_HTML(p){return`#${p.map(W).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([p,h,S,U]){return["RGB",1-Math.min(1,p+U),1-Math.min(1,S+U),1-Math.min(1,h+U)]}static CMYK_rgb([p,h,S,U]){return[dt(1-Math.min(1,p+U)),dt(1-Math.min(1,S+U)),dt(1-Math.min(1,h+U))]}static CMYK_HTML(p){const h=this.CMYK_RGB(p).slice(1);return this.RGB_HTML(h)}static RGB_CMYK([p,h,S]){const U=1-p,tt=1-h,ct=1-S,ut=Math.min(U,tt,ct);return["CMYK",U,tt,ct,ut]}}var j=lt(160);const v=1e3,$=9,z=new WeakSet;function A(bt){return{width:bt[2]-bt[0],height:bt[3]-bt[1]}}class L{static create(p){switch(p.data.annotationType){case c.AnnotationType.LINK:return new b(p);case c.AnnotationType.TEXT:return new y(p);case c.AnnotationType.WIDGET:switch(p.data.fieldType){case"Tx":return new Y(p);case"Btn":return p.data.radioButton?new D(p):p.data.checkBox?new H(p):new B(p);case"Ch":return new et(p);case"Sig":return new M(p)}return new V(p);case c.AnnotationType.POPUP:return new At(p);case c.AnnotationType.FREETEXT:return new Ct(p);case c.AnnotationType.LINE:return new qt(p);case c.AnnotationType.SQUARE:return new Yt(p);case c.AnnotationType.CIRCLE:return new ie(p);case c.AnnotationType.POLYLINE:return new Kt(p);case c.AnnotationType.CARET:return new Ut(p);case c.AnnotationType.INK:return new jt(p);case c.AnnotationType.POLYGON:return new Bt(p);case c.AnnotationType.HIGHLIGHT:return new ee(p);case c.AnnotationType.UNDERLINE:return new $t(p);case c.AnnotationType.SQUIGGLY:return new te(p);case c.AnnotationType.STRIKEOUT:return new le(p);case c.AnnotationType.STAMP:return new Wt(p);case c.AnnotationType.FILEATTACHMENT:return new Qt(p);default:return new E(p)}}}const Jt=class Jt{constructor(p,{isRenderable:h=!1,ignoreBorder:S=!1,createQuadrilaterals:U=!1}={}){F(this,kt,!1);this.isRenderable=h,this.data=p.data,this.layer=p.layer,this.linkService=p.linkService,this.downloadManager=p.downloadManager,this.imageResourcesPath=p.imageResourcesPath,this.renderForms=p.renderForms,this.svgFactory=p.svgFactory,this.annotationStorage=p.annotationStorage,this.enableScripting=p.enableScripting,this.hasJSActions=p.hasJSActions,this._fieldObjects=p.fieldObjects,this.parent=p.parent,h&&(this.container=this._createContainer(S)),U&&this._createQuadrilaterals()}static _hasPopupData({titleObj:p,contentsObj:h,richText:S}){return!!(p!=null&&p.str||h!=null&&h.str||S!=null&&S.str)}get hasPopupData(){return Jt._hasPopupData(this.data)}_createContainer(p){const{data:h,parent:{page:S,viewport:U}}=this,tt=document.createElement("section");tt.setAttribute("data-annotation-id",h.id),this instanceof V||(tt.tabIndex=v),tt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&tt.setAttribute("aria-haspopup","dialog"),h.noRotate&&tt.classList.add("norotate");const{pageWidth:ct,pageHeight:ut,pageX:Tt,pageY:Ht}=U.rawDims;if(!h.rect||this instanceof At){const{rotation:Ot}=h;return!h.hasOwnCanvas&&Ot!==0&&this.setRotation(Ot,tt),tt}const{width:Pt,height:Gt}=A(h.rect),_t=c.Util.normalizeRect([h.rect[0],S.view[3]-h.rect[1]+S.view[1],h.rect[2],S.view[3]-h.rect[3]+S.view[1]]);if(!p&&h.borderStyle.width>0){tt.style.borderWidth=`${h.borderStyle.width}px`;const Ot=h.borderStyle.horizontalCornerRadius,Vt=h.borderStyle.verticalCornerRadius;if(Ot>0||Vt>0){const Lt=`calc(${Ot}px * var(--scale-factor)) / calc(${Vt}px * var(--scale-factor))`;tt.style.borderRadius=Lt}else if(this instanceof D){const Lt=`calc(${Pt}px * var(--scale-factor)) / calc(${Gt}px * var(--scale-factor))`;tt.style.borderRadius=Lt}switch(h.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:tt.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:tt.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:tt.style.borderBottomStyle="solid";break}const Mt=h.borderColor||null;Mt?(R(this,kt,!0),tt.style.borderColor=c.Util.makeHexColor(Mt[0]|0,Mt[1]|0,Mt[2]|0)):tt.style.borderWidth=0}tt.style.left=`${100*(_t[0]-Tt)/ct}%`,tt.style.top=`${100*(_t[1]-Ht)/ut}%`;const{rotation:wt}=h;return h.hasOwnCanvas||wt===0?(tt.style.width=`${100*Pt/ct}%`,tt.style.height=`${100*Gt/ut}%`):this.setRotation(wt,tt),tt}setRotation(p,h=this.container){if(!this.data.rect)return;const{pageWidth:S,pageHeight:U}=this.parent.viewport.rawDims,{width:tt,height:ct}=A(this.data.rect);let ut,Tt;p%180===0?(ut=100*tt/S,Tt=100*ct/U):(ut=100*ct/S,Tt=100*tt/U),h.style.width=`${ut}%`,h.style.height=`${Tt}%`,h.setAttribute("data-main-rotation",(360-p)%360)}get _commonActions(){const p=(h,S,U)=>{const tt=U.detail[h],ct=tt[0],ut=tt.slice(1);U.target.style[S]=X[`${ct}_HTML`](ut),this.annotationStorage.setValue(this.data.id,{[S]:X[`${ct}_rgb`](ut)})};return(0,c.shadow)(this,"_commonActions",{display:h=>{const{display:S}=h.detail,U=S%2===1;this.container.style.visibility=U?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:U,noPrint:S===1||S===2})},print:h=>{this.annotationStorage.setValue(this.data.id,{noPrint:!h.detail.print})},hidden:h=>{const{hidden:S}=h.detail;this.container.style.visibility=S?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:S,noView:S})},focus:h=>{setTimeout(()=>h.target.focus({preventScroll:!1}),0)},userName:h=>{h.target.title=h.detail.userName},readonly:h=>{h.target.disabled=h.detail.readonly},required:h=>{this._setRequired(h.target,h.detail.required)},bgColor:h=>{p("bgColor","backgroundColor",h)},fillColor:h=>{p("fillColor","backgroundColor",h)},fgColor:h=>{p("fgColor","color",h)},textColor:h=>{p("textColor","color",h)},borderColor:h=>{p("borderColor","borderColor",h)},strokeColor:h=>{p("strokeColor","borderColor",h)},rotation:h=>{const S=h.detail.rotation;this.setRotation(S),this.annotationStorage.setValue(this.data.id,{rotation:S})}})}_dispatchEventFromSandbox(p,h){var U;const S=this._commonActions;for(const tt of Object.keys(h.detail))(U=p[tt]||S[tt])==null||U(h)}_setDefaultPropertiesFromJS(p){if(!this.enableScripting)return;const h=this.annotationStorage.getRawValue(this.data.id);if(!h)return;const S=this._commonActions;for(const[U,tt]of Object.entries(h)){const ct=S[U];if(ct){const ut={detail:{[U]:tt},target:p};ct(ut),delete h[U]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:p}=this.data;if(!p)return;const[h,S,U,tt]=this.data.rect;if(p.length===1){const[,{x:Vt,y:Mt},{x:Lt,y:oe}]=p[0];if(U===Vt&&tt===Mt&&h===Lt&&S===oe)return}const{style:ct}=this.container;let ut;if(t(this,kt)){const{borderColor:Vt,borderWidth:Mt}=ct;ct.borderWidth=0,ut=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Vt}" stroke-width="${Mt}">`],this.container.classList.add("hasBorder")}const Tt=U-h,Ht=tt-S,{svgFactory:Pt}=this,Gt=Pt.createElement("svg");Gt.classList.add("quadrilateralsContainer"),Gt.setAttribute("width",0),Gt.setAttribute("height",0);const _t=Pt.createElement("defs");Gt.append(_t);const wt=Pt.createElement("clipPath"),Ot=`clippath_${this.data.id}`;wt.setAttribute("id",Ot),wt.setAttribute("clipPathUnits","objectBoundingBox"),_t.append(wt);for(const[,{x:Vt,y:Mt},{x:Lt,y:oe}]of p){const ye=Pt.createElement("rect"),we=(Lt-h)/Tt,Se=(tt-Mt)/Ht,Ee=(Vt-Lt)/Tt,Re=(Mt-oe)/Ht;ye.setAttribute("x",we),ye.setAttribute("y",Se),ye.setAttribute("width",Ee),ye.setAttribute("height",Re),wt.append(ye),ut==null||ut.push(`<rect vector-effect="non-scaling-stroke" x="${we}" y="${Se}" width="${Ee}" height="${Re}"/>`)}t(this,kt)&&(ut.push("</g></svg>')"),ct.backgroundImage=ut.join("")),this.container.append(Gt),this.container.style.clipPath=`url(#${Ot})`}_createPopup(){const{container:p,data:h}=this;p.setAttribute("aria-haspopup","dialog");const S=new At({data:{color:h.color,titleObj:h.titleObj,modificationDate:h.modificationDate,contentsObj:h.contentsObj,richText:h.richText,parentRect:h.rect,borderStyle:0,id:`popup_${h.id}`,rotation:h.rotation},parent:this.parent,elements:[this]});this.parent.div.append(S.render())}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(p,h=null){const S=[];if(this._fieldObjects){const U=this._fieldObjects[p];if(U)for(const{page:tt,id:ct,exportValues:ut}of U){if(tt===-1||ct===h)continue;const Tt=typeof ut=="string"?ut:null,Ht=document.querySelector(`[data-element-id="${ct}"]`);if(Ht&&!z.has(Ht)){(0,c.warn)(`_getElementsByName - element not allowed: ${ct}`);continue}S.push({id:ct,exportValue:Tt,domElement:Ht})}return S}for(const U of document.getElementsByName(p)){const{exportValue:tt}=U,ct=U.getAttribute("data-element-id");ct!==h&&z.has(U)&&S.push({id:ct,exportValue:tt,domElement:U})}return S}show(){var p;this.container&&(this.container.hidden=!1),(p=this.popup)==null||p.maybeShow()}hide(){var p;this.container&&(this.container.hidden=!0),(p=this.popup)==null||p.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const p=this.getElementsToTriggerPopup();if(Array.isArray(p))for(const h of p)h.classList.add("highlightArea");else p.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:p,data:{id:h}}=this;this.container.addEventListener("dblclick",()=>{var S;(S=this.linkService.eventBus)==null||S.dispatch("switchannotationeditormode",{source:this,mode:p,editId:h})})}};kt=new WeakMap;let E=Jt;class b extends E{constructor(h,S=null){super(h,{isRenderable:!0,ignoreBorder:!!(S!=null&&S.ignoreBorder),createQuadrilaterals:!0});F(this,ne);this.isTooltipOnly=h.data.isTooltipOnly}render(){const{data:h,linkService:S}=this,U=document.createElement("a");U.setAttribute("data-element-id",h.id);let tt=!1;return h.url?(S.addLinkAttributes(U,h.url,h.newWindow),tt=!0):h.action?(this._bindNamedAction(U,h.action),tt=!0):h.attachment?(x(this,ne,Ln).call(this,U,h.attachment,h.attachmentDest),tt=!0):h.setOCGState?(x(this,ne,Dn).call(this,U,h.setOCGState),tt=!0):h.dest?(this._bindLink(U,h.dest),tt=!0):(h.actions&&(h.actions.Action||h.actions["Mouse Up"]||h.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(U,h),tt=!0),h.resetForm?(this._bindResetFormAction(U,h.resetForm),tt=!0):this.isTooltipOnly&&!tt&&(this._bindLink(U,""),tt=!0)),this.container.classList.add("linkAnnotation"),tt&&this.container.append(U),this.container}_bindLink(h,S){h.href=this.linkService.getDestinationHash(S),h.onclick=()=>(S&&this.linkService.goToDestination(S),!1),(S||S==="")&&x(this,ne,qe).call(this)}_bindNamedAction(h,S){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>(this.linkService.executeNamedAction(S),!1),x(this,ne,qe).call(this)}_bindJSAction(h,S){h.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const tt of Object.keys(S.actions)){const ct=U.get(tt);ct&&(h[ct]=()=>{var ut;return(ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S.id,name:tt}}),!1})}h.onclick||(h.onclick=()=>!1),x(this,ne,qe).call(this)}_bindResetFormAction(h,S){const U=h.onclick;if(U||(h.href=this.linkService.getAnchorUrl("")),x(this,ne,qe).call(this),!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),U||(h.onclick=()=>!1);return}h.onclick=()=>{var Gt;U==null||U();const{fields:tt,refs:ct,include:ut}=S,Tt=[];if(tt.length!==0||ct.length!==0){const _t=new Set(ct);for(const wt of tt){const Ot=this._fieldObjects[wt]||[];for(const{id:Vt}of Ot)_t.add(Vt)}for(const wt of Object.values(this._fieldObjects))for(const Ot of wt)_t.has(Ot.id)===ut&&Tt.push(Ot)}else for(const _t of Object.values(this._fieldObjects))Tt.push(..._t);const Ht=this.annotationStorage,Pt=[];for(const _t of Tt){const{id:wt}=_t;switch(Pt.push(wt),_t.type){case"text":{const Vt=_t.defaultValue||"";Ht.setValue(wt,{value:Vt});break}case"checkbox":case"radiobutton":{const Vt=_t.defaultValue===_t.exportValues;Ht.setValue(wt,{value:Vt});break}case"combobox":case"listbox":{const Vt=_t.defaultValue||"";Ht.setValue(wt,{value:Vt});break}default:continue}const Ot=document.querySelector(`[data-element-id="${wt}"]`);if(Ot){if(!z.has(Ot)){(0,c.warn)(`_bindResetFormAction - element not allowed: ${wt}`);continue}}else continue;Ot.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Pt,name:"ResetForm"}})),!1}}}ne=new WeakSet,qe=function(){this.container.setAttribute("data-internal-link","")},Ln=function(h,S,U=null){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>{var tt;return(tt=this.downloadManager)==null||tt.openOrDownloadData(S.content,S.filename,U),!1},x(this,ne,qe).call(this)},Dn=function(h,S){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>(this.linkService.executeSetOCGState(S),!1),x(this,ne,qe).call(this)};class y extends E{constructor(p){super(p,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const p=document.createElement("img");return p.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",p.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),p.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(p),this.container}}class V extends E{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(p){var h;this.data.hasOwnCanvas&&(((h=p.previousSibling)==null?void 0:h.nodeName)==="CANVAS"&&(p.previousSibling.hidden=!0),p.hidden=!1)}_getKeyModifier(p){return c.FeatureTest.platform.isMac?p.metaKey:p.ctrlKey}_setEventListener(p,h,S,U,tt){S.includes("mouse")?p.addEventListener(S,ct=>{var ut;(ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:tt(ct),shift:ct.shiftKey,modifier:this._getKeyModifier(ct)}})}):p.addEventListener(S,ct=>{var ut;if(S==="blur"){if(!h.focused||!ct.relatedTarget)return;h.focused=!1}else if(S==="focus"){if(h.focused)return;h.focused=!0}tt&&((ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:tt(ct)}}))})}_setEventListeners(p,h,S,U){var tt,ct,ut;for(const[Tt,Ht]of S)(Ht==="Action"||(tt=this.data.actions)!=null&&tt[Ht])&&((Ht==="Focus"||Ht==="Blur")&&(h||(h={focused:!1})),this._setEventListener(p,h,Tt,Ht,U),Ht==="Focus"&&!((ct=this.data.actions)!=null&&ct.Blur)?this._setEventListener(p,h,"blur","Blur",null):Ht==="Blur"&&!((ut=this.data.actions)!=null&&ut.Focus)&&this._setEventListener(p,h,"focus","Focus",null))}_setBackgroundColor(p){const h=this.data.backgroundColor||null;p.style.backgroundColor=h===null?"transparent":c.Util.makeHexColor(h[0],h[1],h[2])}_setTextStyle(p){const h=["left","center","right"],{fontColor:S}=this.data.defaultAppearanceData,U=this.data.defaultAppearanceData.fontSize||$,tt=p.style;let ct;const ut=2,Tt=Ht=>Math.round(10*Ht)/10;if(this.data.multiLine){const Ht=Math.abs(this.data.rect[3]-this.data.rect[1]-ut),Pt=Math.round(Ht/(c.LINE_FACTOR*U))||1,Gt=Ht/Pt;ct=Math.min(U,Tt(Gt/c.LINE_FACTOR))}else{const Ht=Math.abs(this.data.rect[3]-this.data.rect[1]-ut);ct=Math.min(U,Tt(Ht/c.LINE_FACTOR))}tt.fontSize=`calc(${ct}px * var(--scale-factor))`,tt.color=c.Util.makeHexColor(S[0],S[1],S[2]),this.data.textAlignment!==null&&(tt.textAlign=h[this.data.textAlignment])}_setRequired(p,h){h?p.setAttribute("required",!0):p.removeAttribute("required"),p.setAttribute("aria-required",h)}}class Y extends V{constructor(p){const h=p.renderForms||p.data.hasOwnCanvas||!p.data.hasAppearance&&!!p.data.fieldValue;super(p,{isRenderable:h})}setPropertyOnSiblings(p,h,S,U){const tt=this.annotationStorage;for(const ct of this._getElementsByName(p.name,p.id))ct.domElement&&(ct.domElement[h]=S),tt.setValue(ct.id,{[U]:S})}render(){var U,tt;const p=this.annotationStorage,h=this.data.id;this.container.classList.add("textWidgetAnnotation");let S=null;if(this.renderForms){const ct=p.getValue(h,{value:this.data.fieldValue});let ut=ct.value||"";const Tt=p.getValue(h,{charLimit:this.data.maxLen}).charLimit;Tt&&ut.length>Tt&&(ut=ut.slice(0,Tt));let Ht=ct.formattedValue||((U=this.data.textContent)==null?void 0:U.join(`
`))||null;Ht&&this.data.comb&&(Ht=Ht.replaceAll(/\s+/g,""));const Pt={userValue:ut,formattedValue:Ht,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(S=document.createElement("textarea"),S.textContent=Ht??ut,this.data.doNotScroll&&(S.style.overflowY="hidden")):(S=document.createElement("input"),S.type="text",S.setAttribute("value",Ht??ut),this.data.doNotScroll&&(S.style.overflowX="hidden")),this.data.hasOwnCanvas&&(S.hidden=!0),z.add(S),S.setAttribute("data-element-id",h),S.disabled=this.data.readOnly,S.name=this.data.fieldName,S.tabIndex=v,this._setRequired(S,this.data.required),Tt&&(S.maxLength=Tt),S.addEventListener("input",_t=>{p.setValue(h,{value:_t.target.value}),this.setPropertyOnSiblings(S,"value",_t.target.value,"value"),Pt.formattedValue=null}),S.addEventListener("resetform",_t=>{const wt=this.data.defaultFieldValue??"";S.value=Pt.userValue=wt,Pt.formattedValue=null});let Gt=_t=>{const{formattedValue:wt}=Pt;wt!=null&&(_t.target.value=wt),_t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){S.addEventListener("focus",wt=>{var Vt;if(Pt.focused)return;const{target:Ot}=wt;Pt.userValue&&(Ot.value=Pt.userValue),Pt.lastCommittedValue=Ot.value,Pt.commitKey=1,(Vt=this.data.actions)!=null&&Vt.Focus||(Pt.focused=!0)}),S.addEventListener("updatefromsandbox",wt=>{this.showElementAndHideCanvas(wt.target);const Ot={value(Vt){Pt.userValue=Vt.detail.value??"",p.setValue(h,{value:Pt.userValue.toString()}),Vt.target.value=Pt.userValue},formattedValue(Vt){const{formattedValue:Mt}=Vt.detail;Pt.formattedValue=Mt,Mt!=null&&Vt.target!==document.activeElement&&(Vt.target.value=Mt),p.setValue(h,{formattedValue:Mt})},selRange(Vt){Vt.target.setSelectionRange(...Vt.detail.selRange)},charLimit:Vt=>{var ye;const{charLimit:Mt}=Vt.detail,{target:Lt}=Vt;if(Mt===0){Lt.removeAttribute("maxLength");return}Lt.setAttribute("maxLength",Mt);let oe=Pt.userValue;!oe||oe.length<=Mt||(oe=oe.slice(0,Mt),Lt.value=Pt.userValue=oe,p.setValue(h,{value:oe}),(ye=this.linkService.eventBus)==null||ye.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:oe,willCommit:!0,commitKey:1,selStart:Lt.selectionStart,selEnd:Lt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ot,wt)}),S.addEventListener("keydown",wt=>{var Mt;Pt.commitKey=1;let Ot=-1;if(wt.key==="Escape"?Ot=0:wt.key==="Enter"&&!this.data.multiLine?Ot=2:wt.key==="Tab"&&(Pt.commitKey=3),Ot===-1)return;const{value:Vt}=wt.target;Pt.lastCommittedValue!==Vt&&(Pt.lastCommittedValue=Vt,Pt.userValue=Vt,(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Vt,willCommit:!0,commitKey:Ot,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}}))});const _t=Gt;Gt=null,S.addEventListener("blur",wt=>{var Vt,Mt;if(!Pt.focused||!wt.relatedTarget)return;(Vt=this.data.actions)!=null&&Vt.Blur||(Pt.focused=!1);const{value:Ot}=wt.target;Pt.userValue=Ot,Pt.lastCommittedValue!==Ot&&((Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Ot,willCommit:!0,commitKey:Pt.commitKey,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}})),_t(wt)}),(tt=this.data.actions)!=null&&tt.Keystroke&&S.addEventListener("beforeinput",wt=>{var Se;Pt.lastCommittedValue=null;const{data:Ot,target:Vt}=wt,{value:Mt,selectionStart:Lt,selectionEnd:oe}=Vt;let ye=Lt,we=oe;switch(wt.inputType){case"deleteWordBackward":{const Ee=Mt.substring(0,Lt).match(/\w*[^\w]*$/);Ee&&(ye-=Ee[0].length);break}case"deleteWordForward":{const Ee=Mt.substring(Lt).match(/^[^\w]*\w*/);Ee&&(we+=Ee[0].length);break}case"deleteContentBackward":Lt===oe&&(ye-=1);break;case"deleteContentForward":Lt===oe&&(we+=1);break}wt.preventDefault(),(Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Mt,change:Ot||"",willCommit:!1,selStart:ye,selEnd:we}})}),this._setEventListeners(S,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.value)}if(Gt&&S.addEventListener("blur",Gt),this.data.comb){const _t=(this.data.rect[2]-this.data.rect[0])/Tt;S.classList.add("comb"),S.style.letterSpacing=`calc(${_t}px * var(--scale-factor) - 1ch)`}}else S=document.createElement("div"),S.textContent=this.data.fieldValue,S.style.verticalAlign="middle",S.style.display="table-cell",this.data.hasOwnCanvas&&(S.hidden=!0);return this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class M extends V{constructor(p){super(p,{isRenderable:!!p.data.hasOwnCanvas})}}class H extends V{constructor(p){super(p,{isRenderable:p.renderForms})}render(){const p=this.annotationStorage,h=this.data,S=h.id;let U=p.getValue(S,{value:h.exportValue===h.fieldValue}).value;typeof U=="string"&&(U=U!=="Off",p.setValue(S,{value:U})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const tt=document.createElement("input");return z.add(tt),tt.setAttribute("data-element-id",S),tt.disabled=h.readOnly,this._setRequired(tt,this.data.required),tt.type="checkbox",tt.name=h.fieldName,U&&tt.setAttribute("checked",!0),tt.setAttribute("exportValue",h.exportValue),tt.tabIndex=v,tt.addEventListener("change",ct=>{const{name:ut,checked:Tt}=ct.target;for(const Ht of this._getElementsByName(ut,S)){const Pt=Tt&&Ht.exportValue===h.exportValue;Ht.domElement&&(Ht.domElement.checked=Pt),p.setValue(Ht.id,{value:Pt})}p.setValue(S,{value:Tt})}),tt.addEventListener("resetform",ct=>{const ut=h.defaultFieldValue||"Off";ct.target.checked=ut===h.exportValue}),this.enableScripting&&this.hasJSActions&&(tt.addEventListener("updatefromsandbox",ct=>{const ut={value(Tt){Tt.target.checked=Tt.detail.value!=="Off",p.setValue(S,{value:Tt.target.checked})}};this._dispatchEventFromSandbox(ut,ct)}),this._setEventListeners(tt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ct=>ct.target.checked)),this._setBackgroundColor(tt),this._setDefaultPropertiesFromJS(tt),this.container.append(tt),this.container}}class D extends V{constructor(p){super(p,{isRenderable:p.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const p=this.annotationStorage,h=this.data,S=h.id;let U=p.getValue(S,{value:h.fieldValue===h.buttonValue}).value;if(typeof U=="string"&&(U=U!==h.buttonValue,p.setValue(S,{value:U})),U)for(const ct of this._getElementsByName(h.fieldName,S))p.setValue(ct.id,{value:!1});const tt=document.createElement("input");if(z.add(tt),tt.setAttribute("data-element-id",S),tt.disabled=h.readOnly,this._setRequired(tt,this.data.required),tt.type="radio",tt.name=h.fieldName,U&&tt.setAttribute("checked",!0),tt.tabIndex=v,tt.addEventListener("change",ct=>{const{name:ut,checked:Tt}=ct.target;for(const Ht of this._getElementsByName(ut,S))p.setValue(Ht.id,{value:!1});p.setValue(S,{value:Tt})}),tt.addEventListener("resetform",ct=>{const ut=h.defaultFieldValue;ct.target.checked=ut!=null&&ut===h.buttonValue}),this.enableScripting&&this.hasJSActions){const ct=h.buttonValue;tt.addEventListener("updatefromsandbox",ut=>{const Tt={value:Ht=>{const Pt=ct===Ht.detail.value;for(const Gt of this._getElementsByName(Ht.target.name)){const _t=Pt&&Gt.id===S;Gt.domElement&&(Gt.domElement.checked=_t),p.setValue(Gt.id,{value:_t})}}};this._dispatchEventFromSandbox(Tt,ut)}),this._setEventListeners(tt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ut=>ut.target.checked)}return this._setBackgroundColor(tt),this._setDefaultPropertiesFromJS(tt),this.container.append(tt),this.container}}class B extends b{constructor(p){super(p,{ignoreBorder:p.data.hasAppearance})}render(){const p=super.render();p.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(p.title=this.data.alternativeText);const h=p.lastChild;return this.enableScripting&&this.hasJSActions&&h&&(this._setDefaultPropertiesFromJS(h),h.addEventListener("updatefromsandbox",S=>{this._dispatchEventFromSandbox({},S)})),p}}class et extends V{constructor(p){super(p,{isRenderable:p.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const p=this.annotationStorage,h=this.data.id,S=p.getValue(h,{value:this.data.fieldValue}),U=document.createElement("select");z.add(U),U.setAttribute("data-element-id",h),U.disabled=this.data.readOnly,this._setRequired(U,this.data.required),U.name=this.data.fieldName,U.tabIndex=v;let tt=this.data.combo&&this.data.options.length>0;this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0)),U.addEventListener("resetform",Pt=>{const Gt=this.data.defaultFieldValue;for(const _t of U.options)_t.selected=_t.value===Gt});for(const Pt of this.data.options){const Gt=document.createElement("option");Gt.textContent=Pt.displayValue,Gt.value=Pt.exportValue,S.value.includes(Pt.exportValue)&&(Gt.setAttribute("selected",!0),tt=!1),U.append(Gt)}let ct=null;if(tt){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),U.prepend(Pt),ct=()=>{Pt.remove(),U.removeEventListener("input",ct),ct=null},U.addEventListener("input",ct)}const ut=Pt=>{const Gt=Pt?"value":"textContent",{options:_t,multiple:wt}=U;return wt?Array.prototype.filter.call(_t,Ot=>Ot.selected).map(Ot=>Ot[Gt]):_t.selectedIndex===-1?null:_t[_t.selectedIndex][Gt]};let Tt=ut(!1);const Ht=Pt=>{const Gt=Pt.target.options;return Array.prototype.map.call(Gt,_t=>({displayValue:_t.textContent,exportValue:_t.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",Pt=>{const Gt={value(_t){ct==null||ct();const wt=_t.detail.value,Ot=new Set(Array.isArray(wt)?wt:[wt]);for(const Vt of U.options)Vt.selected=Ot.has(Vt.value);p.setValue(h,{value:ut(!0)}),Tt=ut(!1)},multipleSelection(_t){U.multiple=!0},remove(_t){const wt=U.options,Ot=_t.detail.remove;wt[Ot].selected=!1,U.remove(Ot),wt.length>0&&Array.prototype.findIndex.call(wt,Vt=>Vt.selected)===-1&&(wt[0].selected=!0),p.setValue(h,{value:ut(!0),items:Ht(_t)}),Tt=ut(!1)},clear(_t){for(;U.length!==0;)U.remove(0);p.setValue(h,{value:null,items:[]}),Tt=ut(!1)},insert(_t){const{index:wt,displayValue:Ot,exportValue:Vt}=_t.detail.insert,Mt=U.children[wt],Lt=document.createElement("option");Lt.textContent=Ot,Lt.value=Vt,Mt?Mt.before(Lt):U.append(Lt),p.setValue(h,{value:ut(!0),items:Ht(_t)}),Tt=ut(!1)},items(_t){const{items:wt}=_t.detail;for(;U.length!==0;)U.remove(0);for(const Ot of wt){const{displayValue:Vt,exportValue:Mt}=Ot,Lt=document.createElement("option");Lt.textContent=Vt,Lt.value=Mt,U.append(Lt)}U.options.length>0&&(U.options[0].selected=!0),p.setValue(h,{value:ut(!0),items:Ht(_t)}),Tt=ut(!1)},indices(_t){const wt=new Set(_t.detail.indices);for(const Ot of _t.target.options)Ot.selected=wt.has(Ot.index);p.setValue(h,{value:ut(!0)}),Tt=ut(!1)},editable(_t){_t.target.disabled=!_t.detail.editable}};this._dispatchEventFromSandbox(Gt,Pt)}),U.addEventListener("input",Pt=>{var _t;const Gt=ut(!0);p.setValue(h,{value:Gt}),Pt.preventDefault(),(_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Tt,changeEx:Gt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):U.addEventListener("input",function(Pt){p.setValue(h,{value:ut(!0)})}),this.data.combo&&this._setTextStyle(U),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class At extends E{constructor(p){const{data:h,elements:S}=p;super(p,{isRenderable:E._hasPopupData(h)}),this.elements=S}render(){this.container.classList.add("popupAnnotation");const p=new St({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),h=[];for(const S of this.elements)S.popup=p,h.push(S.data.id),S.addHighlightArea();return this.container.setAttribute("aria-controls",h.map(S=>`${c.AnnotationPrefix}${S}`).join(",")),this.container}}class St{constructor({container:p,color:h,elements:S,titleObj:U,modificationDate:tt,contentsObj:ct,richText:ut,parent:Tt,rect:Ht,parentRect:Pt,open:Gt}){F(this,gt);F(this,ue,x(this,gt,On).bind(this));F(this,O,x(this,gt,Us).bind(this));F(this,s,x(this,gt,$s).bind(this));F(this,e,x(this,gt,Es).bind(this));F(this,i,null);F(this,o,null);F(this,l,null);F(this,g,null);F(this,_,null);F(this,G,null);F(this,w,null);F(this,r,!1);F(this,u,null);F(this,I,null);F(this,at,null);F(this,nt,null);F(this,st,!1);var _t;R(this,o,p),R(this,nt,U),R(this,l,ct),R(this,at,ut),R(this,G,Tt),R(this,i,h),R(this,I,Ht),R(this,w,Pt),R(this,_,S),R(this,g,it.PDFDateString.toDateObject(tt)),this.trigger=S.flatMap(wt=>wt.getElementsToTriggerPopup());for(const wt of this.trigger)wt.addEventListener("click",t(this,e)),wt.addEventListener("mouseenter",t(this,s)),wt.addEventListener("mouseleave",t(this,O)),wt.classList.add("popupTriggerArea");for(const wt of S)(_t=wt.container)==null||_t.addEventListener("keydown",t(this,ue));t(this,o).hidden=!0,Gt&&x(this,gt,Es).call(this)}render(){if(t(this,u))return;const{page:{view:p},viewport:{rawDims:{pageWidth:h,pageHeight:S,pageX:U,pageY:tt}}}=t(this,G),ct=R(this,u,document.createElement("div"));if(ct.className="popup",t(this,i)){const oe=ct.style.outlineColor=c.Util.makeHexColor(...t(this,i));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ct.style.backgroundColor=`color-mix(in srgb, ${oe} 30%, white)`:ct.style.backgroundColor=c.Util.makeHexColor(...t(this,i).map(ye=>Math.floor(.7*(255-ye)+ye)))}const ut=document.createElement("span");ut.className="header";const Tt=document.createElement("h1");if(ut.append(Tt),{dir:Tt.dir,str:Tt.textContent}=t(this,nt),ct.append(ut),t(this,g)){const oe=document.createElement("span");oe.classList.add("popupDate"),oe.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),oe.setAttribute("data-l10n-args",JSON.stringify({date:t(this,g).toLocaleDateString(),time:t(this,g).toLocaleTimeString()})),ut.append(oe)}const Ht=t(this,l),Pt=t(this,at);if(Pt!=null&&Pt.str&&(!(Ht!=null&&Ht.str)||Ht.str===Pt.str))j.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:ct}),ct.lastChild.classList.add("richText","popupContent");else{const oe=this._formatContents(Ht);ct.append(oe)}let Gt=!!t(this,w),_t=Gt?t(this,w):t(this,I);for(const oe of t(this,_))if(!_t||c.Util.intersect(oe.data.rect,_t)!==null){_t=oe.data.rect,Gt=!0;break}const wt=c.Util.normalizeRect([_t[0],p[3]-_t[1]+p[1],_t[2],p[3]-_t[3]+p[1]]),Ot=Gt?_t[2]-_t[0]+5:0,Vt=wt[0]+Ot,Mt=wt[1],{style:Lt}=t(this,o);Lt.left=`${100*(Vt-U)/h}%`,Lt.top=`${100*(Mt-tt)/S}%`,t(this,o).append(ct)}_formatContents({str:p,dir:h}){const S=document.createElement("p");S.classList.add("popupContent"),S.dir=h;const U=p.split(/(?:\r\n?|\n)/);for(let tt=0,ct=U.length;tt<ct;++tt){const ut=U[tt];S.append(document.createTextNode(ut)),tt<ct-1&&S.append(document.createElement("br"))}return S}forceHide(){R(this,st,this.isVisible),t(this,st)&&(t(this,o).hidden=!0)}maybeShow(){t(this,st)&&(R(this,st,!1),t(this,o).hidden=!1)}get isVisible(){return t(this,o).hidden===!1}}ue=new WeakMap,O=new WeakMap,s=new WeakMap,e=new WeakMap,i=new WeakMap,o=new WeakMap,l=new WeakMap,g=new WeakMap,_=new WeakMap,G=new WeakMap,w=new WeakMap,r=new WeakMap,u=new WeakMap,I=new WeakMap,at=new WeakMap,nt=new WeakMap,st=new WeakMap,gt=new WeakSet,On=function(p){p.altKey||p.shiftKey||p.ctrlKey||p.metaKey||(p.key==="Enter"||p.key==="Escape"&&t(this,r))&&x(this,gt,Es).call(this)},Es=function(){R(this,r,!t(this,r)),t(this,r)?(x(this,gt,$s).call(this),t(this,o).addEventListener("click",t(this,e)),t(this,o).addEventListener("keydown",t(this,ue))):(x(this,gt,Us).call(this),t(this,o).removeEventListener("click",t(this,e)),t(this,o).removeEventListener("keydown",t(this,ue)))},$s=function(){t(this,u)||this.render(),this.isVisible?t(this,r)&&t(this,o).classList.add("focused"):(t(this,o).hidden=!1,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)+1e3)},Us=function(){t(this,o).classList.remove("focused"),!(t(this,r)||!this.isVisible)&&(t(this,o).hidden=!0,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)-1e3)};class Ct extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0}),this.textContent=p.data.textContent,this.textPosition=p.data.textPosition,this.annotationEditorType=c.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const p=document.createElement("div");p.classList.add("annotationTextContent"),p.setAttribute("role","comment");for(const h of this.textContent){const S=document.createElement("span");S.textContent=h,p.append(S)}this.container.append(p)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class qt extends E{constructor(h){super(h,{isRenderable:!0,ignoreBorder:!0});F(this,J,null)}render(){this.container.classList.add("lineAnnotation");const h=this.data,{width:S,height:U}=A(h.rect),tt=this.svgFactory.create(S,U,!0),ct=R(this,J,this.svgFactory.createElement("svg:line"));return ct.setAttribute("x1",h.rect[2]-h.lineCoordinates[0]),ct.setAttribute("y1",h.rect[3]-h.lineCoordinates[1]),ct.setAttribute("x2",h.rect[2]-h.lineCoordinates[2]),ct.setAttribute("y2",h.rect[3]-h.lineCoordinates[3]),ct.setAttribute("stroke-width",h.borderStyle.width||1),ct.setAttribute("stroke","transparent"),ct.setAttribute("fill","transparent"),tt.append(ct),this.container.append(tt),!h.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,J)}addHighlightArea(){this.container.classList.add("highlightArea")}}J=new WeakMap;class Yt extends E{constructor(h){super(h,{isRenderable:!0,ignoreBorder:!0});F(this,C,null)}render(){this.container.classList.add("squareAnnotation");const h=this.data,{width:S,height:U}=A(h.rect),tt=this.svgFactory.create(S,U,!0),ct=h.borderStyle.width,ut=R(this,C,this.svgFactory.createElement("svg:rect"));return ut.setAttribute("x",ct/2),ut.setAttribute("y",ct/2),ut.setAttribute("width",S-ct),ut.setAttribute("height",U-ct),ut.setAttribute("stroke-width",ct||1),ut.setAttribute("stroke","transparent"),ut.setAttribute("fill","transparent"),tt.append(ut),this.container.append(tt),!h.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,C)}addHighlightArea(){this.container.classList.add("highlightArea")}}C=new WeakMap;class ie extends E{constructor(h){super(h,{isRenderable:!0,ignoreBorder:!0});F(this,d,null)}render(){this.container.classList.add("circleAnnotation");const h=this.data,{width:S,height:U}=A(h.rect),tt=this.svgFactory.create(S,U,!0),ct=h.borderStyle.width,ut=R(this,d,this.svgFactory.createElement("svg:ellipse"));return ut.setAttribute("cx",S/2),ut.setAttribute("cy",U/2),ut.setAttribute("rx",S/2-ct/2),ut.setAttribute("ry",U/2-ct/2),ut.setAttribute("stroke-width",ct||1),ut.setAttribute("stroke","transparent"),ut.setAttribute("fill","transparent"),tt.append(ut),this.container.append(tt),!h.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,d)}addHighlightArea(){this.container.classList.add("highlightArea")}}d=new WeakMap;class Kt extends E{constructor(h){super(h,{isRenderable:!0,ignoreBorder:!0});F(this,T,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const h=this.data,{width:S,height:U}=A(h.rect),tt=this.svgFactory.create(S,U,!0);let ct=[];for(const Tt of h.vertices){const Ht=Tt.x-h.rect[0],Pt=h.rect[3]-Tt.y;ct.push(Ht+","+Pt)}ct=ct.join(" ");const ut=R(this,T,this.svgFactory.createElement(this.svgElementName));return ut.setAttribute("points",ct),ut.setAttribute("stroke-width",h.borderStyle.width||1),ut.setAttribute("stroke","transparent"),ut.setAttribute("fill","transparent"),tt.append(ut),this.container.append(tt),!h.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,T)}addHighlightArea(){this.container.classList.add("highlightArea")}}T=new WeakMap;class Bt extends Kt{constructor(p){super(p),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ut extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class jt extends E{constructor(h){super(h,{isRenderable:!0,ignoreBorder:!0});F(this,k,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=c.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const h=this.data,{width:S,height:U}=A(h.rect),tt=this.svgFactory.create(S,U,!0);for(const ct of h.inkLists){let ut=[];for(const Ht of ct){const Pt=Ht.x-h.rect[0],Gt=h.rect[3]-Ht.y;ut.push(`${Pt},${Gt}`)}ut=ut.join(" ");const Tt=this.svgFactory.createElement(this.svgElementName);t(this,k).push(Tt),Tt.setAttribute("points",ut),Tt.setAttribute("stroke-width",h.borderStyle.width||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),!h.popupRef&&this.hasPopupData&&this._createPopup(),tt.append(Tt)}return this.container.append(tt),this.container}getElementsToTriggerPopup(){return t(this,k)}addHighlightArea(){this.container.classList.add("highlightArea")}}k=new WeakMap;class ee extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class $t extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class te extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class le extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Wt extends E{constructor(p){super(p,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Qt extends E{constructor(h){var tt;super(h,{isRenderable:!0});F(this,rt);F(this,K,null);const{filename:S,content:U}=this.data.file;this.filename=(0,it.getFilenameFromUrl)(S,!0),this.content=U,(tt=this.linkService.eventBus)==null||tt.dispatch("fileattachmentannotation",{source:this,filename:S,content:U})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:h,data:S}=this;let U;S.hasAppearance||S.fillAlpha===0?U=document.createElement("div"):(U=document.createElement("img"),U.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(S.name)?"paperclip":"pushpin"}.svg`,S.fillAlpha&&S.fillAlpha<1&&(U.style=`filter: opacity(${Math.round(S.fillAlpha*100)}%);`)),U.addEventListener("dblclick",x(this,rt,Gs).bind(this)),R(this,K,U);const{isMac:tt}=c.FeatureTest.platform;return h.addEventListener("keydown",ct=>{ct.key==="Enter"&&(tt?ct.metaKey:ct.ctrlKey)&&x(this,rt,Gs).call(this)}),!S.popupRef&&this.hasPopupData?this._createPopup():U.classList.add("popupTriggerArea"),h.append(U),h}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap,rt=new WeakSet,Gs=function(){var h;(h=this.downloadManager)==null||h.openOrDownloadData(this.content,this.filename)};class me{constructor({div:p,accessibilityManager:h,annotationCanvasMap:S,page:U,viewport:tt}){F(this,Q);F(this,ft,null);F(this,It,null);F(this,m,new Map);this.div=p,R(this,ft,h),R(this,It,S),this.page=U,this.viewport=tt,this.zIndex=0}async render(p){const{annotations:h}=p,S=this.div;(0,it.setLayerDimensions)(S,this.viewport);const U=new Map,tt={data:null,layer:S,linkService:p.linkService,downloadManager:p.downloadManager,imageResourcesPath:p.imageResourcesPath||"",renderForms:p.renderForms!==!1,svgFactory:new it.DOMSVGFactory,annotationStorage:p.annotationStorage||new P.AnnotationStorage,enableScripting:p.enableScripting===!0,hasJSActions:p.hasJSActions,fieldObjects:p.fieldObjects,parent:this,elements:null};for(const ct of h){if(ct.noHTML)continue;const ut=ct.annotationType===c.AnnotationType.POPUP;if(ut){const Pt=U.get(ct.id);if(!Pt)continue;tt.elements=Pt}else{const{width:Pt,height:Gt}=A(ct.rect);if(Pt<=0||Gt<=0)continue}tt.data=ct;const Tt=L.create(tt);if(!Tt.isRenderable)continue;if(!ut&&ct.popupRef){const Pt=U.get(ct.popupRef);Pt?Pt.push(Tt):U.set(ct.popupRef,[Tt])}Tt.annotationEditorType>0&&t(this,m).set(Tt.data.id,Tt);const Ht=Tt.render();ct.hidden&&(Ht.style.visibility="hidden"),x(this,Q,Bn).call(this,Ht,ct.id)}x(this,Q,qs).call(this)}update({viewport:p}){const h=this.div;this.viewport=p,(0,it.setLayerDimensions)(h,{rotation:p.rotation}),x(this,Q,qs).call(this),h.hidden=!1}getEditableAnnotations(){return Array.from(t(this,m).values())}getEditableAnnotation(p){return t(this,m).get(p)}}ft=new WeakMap,It=new WeakMap,m=new WeakMap,Q=new WeakSet,Bn=function(p,h){var U;const S=p.firstChild||p;S.id=`${c.AnnotationPrefix}${h}`,this.div.append(p),(U=t(this,ft))==null||U.moveElementInDOM(this.div,p,S,!1)},qs=function(){if(!t(this,It))return;const p=this.div;for(const[h,S]of t(this,It)){const U=p.querySelector(`[data-annotation-id="${h}"]`);if(!U)continue;const{firstChild:tt}=U;tt?tt.nodeName==="CANVAS"?tt.replaceWith(S):tt.before(S):U.append(S)}t(this,It).clear()}},780:(Zt,Nt,lt)=>{var j,v,$,Nn,A;lt.d(Nt,{AnnotationStorage:()=>dt,PrintAnnotationStorage:()=>X,SerializableEmpty:()=>W});var c=lt(266),it=lt(115),P=lt(825);const W=Object.freeze({map:null,hash:"",transfer:void 0});class dt{constructor(){F(this,$);F(this,j,!1);F(this,v,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(E,b){const y=t(this,v).get(E);return y===void 0?b:Object.assign(b,y)}getRawValue(E){return t(this,v).get(E)}remove(E){if(t(this,v).delete(E),t(this,v).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const b of t(this,v).values())if(b instanceof it.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(E,b){const y=t(this,v).get(E);let V=!1;if(y!==void 0)for(const[Y,M]of Object.entries(b))y[Y]!==M&&(V=!0,y[Y]=M);else V=!0,t(this,v).set(E,b);V&&x(this,$,Nn).call(this),b instanceof it.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(b.constructor._type)}has(E){return t(this,v).has(E)}getAll(){return t(this,v).size>0?(0,c.objectFromMap)(t(this,v)):null}setAll(E){for(const[b,y]of Object.entries(E))this.setValue(b,y)}get size(){return t(this,v).size}resetModified(){t(this,j)&&(R(this,j,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new X(this)}get serializable(){if(t(this,v).size===0)return W;const E=new Map,b=new P.MurmurHash3_64,y=[],V=Object.create(null);let Y=!1;for(const[M,H]of t(this,v)){const D=H instanceof it.AnnotationEditor?H.serialize(!1,V):H;D&&(E.set(M,D),b.update(`${M}:${JSON.stringify(D)}`),Y||(Y=!!D.bitmap))}if(Y)for(const M of E.values())M.bitmap&&y.push(M.bitmap);return E.size>0?{map:E,hash:b.hexdigest(),transfer:y}:W}}j=new WeakMap,v=new WeakMap,$=new WeakSet,Nn=function(){t(this,j)||(R(this,j,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class X extends dt{constructor(b){super();F(this,A);const{map:y,hash:V,transfer:Y}=b.serializable,M=structuredClone(y,Y?{transfer:Y}:null);R(this,A,{map:M,hash:V,transfer:Y})}get print(){(0,c.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,A)}}A=new WeakMap},406:(Zt,Nt,lt)=>{lt.a(Zt,async(c,it)=>{var H,D,B,et,Ye,xs,Ct,qt,Yt,ie,Kt,ws,Ut,jt,ee,$t,te,Ss,Wt,Qt,Ws,kt,Jt;try{let ne=function(C){if(typeof C=="string"||C instanceof URL?C={url:C}:(0,P.isArrayBuffer)(C)&&(C={data:C}),typeof C!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!C.url&&!C.data&&!C.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const d=new g,{docId:T}=d,k=C.url?be(C.url):null,K=C.data?_e(C.data):null,rt=C.httpHeaders||null,vt=C.withCredentials===!0,ft=C.password??null,It=C.range instanceof _?C.range:null,m=Number.isInteger(C.rangeChunkSize)&&C.rangeChunkSize>0?C.rangeChunkSize:ae;let Q=C.worker instanceof I?C.worker:null;const Et=C.verbosity,yt=typeof C.docBaseUrl=="string"&&!(0,dt.isDataScheme)(C.docBaseUrl)?C.docBaseUrl:null,bt=typeof C.cMapUrl=="string"?C.cMapUrl:null,p=C.cMapPacked!==!1,h=C.CMapReaderFactory||e,S=typeof C.standardFontDataUrl=="string"?C.standardFontDataUrl:null,U=C.StandardFontDataFactory||o,tt=C.stopAtErrors!==!0,ct=Number.isInteger(C.maxImageSize)&&C.maxImageSize>-1?C.maxImageSize:-1,ut=C.isEvalSupported!==!1,Tt=typeof C.isOffscreenCanvasSupported=="boolean"?C.isOffscreenCanvasSupported:!P.isNodeJS,Ht=Number.isInteger(C.canvasMaxAreaInBytes)?C.canvasMaxAreaInBytes:-1,Pt=typeof C.disableFontFace=="boolean"?C.disableFontFace:P.isNodeJS,Gt=C.fontExtraProperties===!0,_t=C.enableXfa===!0,wt=C.ownerDocument||globalThis.document,Ot=C.disableRange===!0,Vt=C.disableStream===!0,Mt=C.disableAutoFetch===!0,Lt=C.pdfBug===!0,oe=It?It.length:C.length??NaN,ye=typeof C.useSystemFonts=="boolean"?C.useSystemFonts:!P.isNodeJS&&!Pt,we=typeof C.useWorkerFetch=="boolean"?C.useWorkerFetch:h===dt.DOMCMapReaderFactory&&U===dt.DOMStandardFontDataFactory&&bt&&S&&(0,dt.isValidFetchUrl)(bt,document.baseURI)&&(0,dt.isValidFetchUrl)(S,document.baseURI),Se=C.canvasFactory||new s({ownerDocument:wt}),Ee=C.filterFactory||new i({docId:T,ownerDocument:wt}),Re=null;(0,P.setVerbosityLevel)(Et);const ce={canvasFactory:Se,filterFactory:Ee};if(we||(ce.cMapReaderFactory=new h({baseUrl:bt,isCompressed:p}),ce.standardFontDataFactory=new U({baseUrl:S})),!Q){const es={verbosity:Et,port:$.GlobalWorkerOptions.workerPort};Q=es.port?I.fromPort(es):new I(es),d._worker=Q}const ka={docId:T,apiVersion:"4.0.379",data:K,password:ft,disableAutoFetch:Mt,rangeChunkSize:m,length:oe,docBaseUrl:yt,enableXfa:_t,evaluatorOptions:{maxImageSize:ct,disableFontFace:Pt,ignoreErrors:tt,isEvalSupported:ut,isOffscreenCanvasSupported:Tt,canvasMaxAreaInBytes:Ht,fontExtraProperties:Gt,useSystemFonts:ye,cMapUrl:we?bt:null,standardFontDataUrl:we?S:null}},Ma={ignoreErrors:tt,isEvalSupported:ut,disableFontFace:Pt,fontExtraProperties:Gt,enableXfa:_t,ownerDocument:wt,disableAutoFetch:Mt,pdfBug:Lt,styleElement:Re};return Q.promise.then(function(){if(d.destroyed)throw new Error("Loading aborted");const es=l(Q,ka),Ra=new Promise(function(Hs){let ss;It?ss=new E.PDFDataTransportStream({length:oe,initialData:It.initialData,progressiveDone:It.progressiveDone,contentDispositionFilename:It.contentDispositionFilename,disableRange:Ot,disableStream:Vt},It):K||(ss=(Ve=>P.isNodeJS?new V.PDFNodeStream(Ve):(0,dt.isValidFetchUrl)(Ve.url)?new b.PDFFetchStream(Ve):new y.PDFNetworkStream(Ve))({url:k,length:oe,httpHeaders:rt,withCredentials:vt,rangeChunkSize:m,disableRange:Ot,disableStream:Vt})),Hs(ss)});return Promise.all([es,Ra]).then(function([Hs,ss]){if(d.destroyed)throw new Error("Loading aborted");const Ve=new z.MessageHandler(T,Hs,Q.port),Fa=new at(Ve,d,ss,Ma,ce);d._transport=Fa,Ve.send("Ready",null)})}).catch(d._capability.reject),d},be=function(C){if(C instanceof URL)return C.href;try{return new URL(C,window.location).href}catch{if(P.isNodeJS&&typeof C=="string")return C}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},_e=function(C){if(P.isNodeJS&&typeof Buffer<"u"&&C instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(C instanceof Uint8Array&&C.byteLength===C.buffer.byteLength)return C;if(typeof C=="string")return(0,P.stringToBytes)(C);if(typeof C=="object"&&!isNaN(C==null?void 0:C.length)||(0,P.isArrayBuffer)(C))return new Uint8Array(C);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};lt.d(Nt,{PDFDataRangeTransport:()=>_,PDFWorker:()=>I,build:()=>Ft,getDocument:()=>ne,version:()=>mt});var P=lt(266),W=lt(780),dt=lt(473),X=lt(742),j=lt(738),v=lt(250),$=lt(368),z=lt(694),A=lt(472),L=lt(890),E=lt(92),b=lt(171),y=lt(474),V=lt(498),Y=lt(521),M=c([j,V]);[j,V]=M.then?(await M)():M;const ae=65536,ue=100,O=5e3,s=P.isNodeJS?j.NodeCanvasFactory:dt.DOMCanvasFactory,e=P.isNodeJS?j.NodeCMapReaderFactory:dt.DOMCMapReaderFactory,i=P.isNodeJS?j.NodeFilterFactory:dt.DOMFilterFactory,o=P.isNodeJS?j.NodeStandardFontDataFactory:dt.DOMStandardFontDataFactory;async function l(C,d){if(C.destroyed)throw new Error("Worker was destroyed");const T=await C.messageHandler.sendWithPromise("GetDocRequest",d,d.data?[d.data.buffer]:null);if(C.destroyed)throw new Error("Worker was destroyed");return T}const a=class a{constructor(){this._capability=new P.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Be(a,H)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var d,T,k;this.destroyed=!0;try{(d=this._worker)!=null&&d.port&&(this._worker._pendingDestroy=!0),await((T=this._transport)==null?void 0:T.destroy())}catch(K){throw(k=this._worker)!=null&&k.port&&delete this._worker._pendingDestroy,K}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};H=new WeakMap,F(a,H,0);let g=a;class _{constructor(d,T,k=!1,K=null){this.length=d,this.initialData=T,this.progressiveDone=k,this.contentDispositionFilename=K,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new P.PromiseCapability}addRangeListener(d){this._rangeListeners.push(d)}addProgressListener(d){this._progressListeners.push(d)}addProgressiveReadListener(d){this._progressiveReadListeners.push(d)}addProgressiveDoneListener(d){this._progressiveDoneListeners.push(d)}onDataRange(d,T){for(const k of this._rangeListeners)k(d,T)}onDataProgress(d,T){this._readyCapability.promise.then(()=>{for(const k of this._progressListeners)k(d,T)})}onDataProgressiveRead(d){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(d)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const d of this._progressiveDoneListeners)d()})}transportReady(){this._readyCapability.resolve()}requestDataRange(d,T){(0,P.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class G{constructor(d,T){this._pdfInfo=d,this._transport=T}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,P.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(d){return this._transport.getPage(d)}getPageIndex(d){return this._transport.getPageIndex(d)}getDestinations(){return this._transport.getDestinations()}getDestination(d){return this._transport.getDestination(d)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(d=!1){return this._transport.startCleanup(d||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class w{constructor(d,T,k,K=!1){F(this,et);F(this,D,null);F(this,B,!1);this._pageIndex=d,this._pageInfo=T,this._transport=k,this._stats=K?new dt.StatTimer:null,this._pdfBug=K,this.commonObjs=k.commonObjs,this.objs=new nt,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:d,rotation:T=this.rotate,offsetX:k=0,offsetY:K=0,dontFlip:rt=!1}={}){return new dt.PageViewport({viewBox:this.view,scale:d,rotation:T,offsetX:k,offsetY:K,dontFlip:rt})}getAnnotations({intent:d="display"}={}){const T=this._transport.getRenderingIntent(d);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,P.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var d;return((d=this._transport._htmlForXfa)==null?void 0:d.children[this._pageIndex])||null}render({canvasContext:d,viewport:T,intent:k="display",annotationMode:K=P.AnnotationMode.ENABLE,transform:rt=null,background:vt=null,optionalContentConfigPromise:ft=null,annotationCanvasMap:It=null,pageColors:m=null,printAnnotationStorage:Q=null}){var U,tt;(U=this._stats)==null||U.time("Overall");const Et=this._transport.getRenderingIntent(k,K,Q);R(this,B,!1),x(this,et,xs).call(this),ft||(ft=this._transport.getOptionalContentConfig());let yt=this._intentStates.get(Et.cacheKey);yt||(yt=Object.create(null),this._intentStates.set(Et.cacheKey,yt)),yt.streamReaderCancelTimeout&&(clearTimeout(yt.streamReaderCancelTimeout),yt.streamReaderCancelTimeout=null);const bt=!!(Et.renderingIntent&P.RenderingIntentFlag.PRINT);yt.displayReadyCapability||(yt.displayReadyCapability=new P.PromiseCapability,yt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(tt=this._stats)==null||tt.time("Page Request"),this._pumpOperatorList(Et));const p=ct=>{var ut,Tt;yt.renderTasks.delete(h),(this._maybeCleanupAfterRender||bt)&&R(this,B,!0),x(this,et,Ye).call(this,!bt),ct?(h.capability.reject(ct),this._abortOperatorList({intentState:yt,reason:ct instanceof Error?ct:new Error(ct)})):h.capability.resolve(),(ut=this._stats)==null||ut.timeEnd("Rendering"),(Tt=this._stats)==null||Tt.timeEnd("Overall")},h=new gt({callback:p,params:{canvasContext:d,viewport:T,transform:rt,background:vt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:It,operatorList:yt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!bt,pdfBug:this._pdfBug,pageColors:m});(yt.renderTasks||(yt.renderTasks=new Set)).add(h);const S=h.task;return Promise.all([yt.displayReadyCapability.promise,ft]).then(([ct,ut])=>{var Tt;if(this.destroyed){p();return}(Tt=this._stats)==null||Tt.time("Rendering"),h.initializeGraphics({transparency:ct,optionalContentConfig:ut}),h.operatorListChanged()}).catch(p),S}getOperatorList({intent:d="display",annotationMode:T=P.AnnotationMode.ENABLE,printAnnotationStorage:k=null}={}){var It;function K(){vt.operatorList.lastChunk&&(vt.opListReadCapability.resolve(vt.operatorList),vt.renderTasks.delete(ft))}const rt=this._transport.getRenderingIntent(d,T,k,!0);let vt=this._intentStates.get(rt.cacheKey);vt||(vt=Object.create(null),this._intentStates.set(rt.cacheKey,vt));let ft;return vt.opListReadCapability||(ft=Object.create(null),ft.operatorListChanged=K,vt.opListReadCapability=new P.PromiseCapability,(vt.renderTasks||(vt.renderTasks=new Set)).add(ft),vt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(It=this._stats)==null||It.time("Page Request"),this._pumpOperatorList(rt)),vt.opListReadCapability.promise}streamTextContent({includeMarkedContent:d=!1,disableNormalization:T=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:d===!0,disableNormalization:T===!0},{highWaterMark:100,size(k){return k.items.length}})}getTextContent(d={}){if(this._transport._htmlForXfa)return this.getXfa().then(k=>Y.XfaText.textContent(k));const T=this.streamTextContent(d);return new Promise(function(k,K){function rt(){vt.read().then(function({value:It,done:m}){if(m){k(ft);return}Object.assign(ft.styles,It.styles),ft.items.push(...It.items),rt()},K)}const vt=T.getReader(),ft={items:[],styles:Object.create(null)};rt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const d=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const k of T.renderTasks)d.push(k.completed),k.cancel();return this.objs.clear(),R(this,B,!1),x(this,et,xs).call(this),Promise.all(d)}cleanup(d=!1){R(this,B,!0);const T=x(this,et,Ye).call(this,!1);return d&&T&&this._stats&&(this._stats=new dt.StatTimer),T}_startRenderPage(d,T){var K,rt;const k=this._intentStates.get(T);k&&((K=this._stats)==null||K.timeEnd("Page Request"),(rt=k.displayReadyCapability)==null||rt.resolve(d))}_renderPageChunk(d,T){for(let k=0,K=d.length;k<K;k++)T.operatorList.fnArray.push(d.fnArray[k]),T.operatorList.argsArray.push(d.argsArray[k]);T.operatorList.lastChunk=d.lastChunk,T.operatorList.separateAnnots=d.separateAnnots;for(const k of T.renderTasks)k.operatorListChanged();d.lastChunk&&x(this,et,Ye).call(this,!0)}_pumpOperatorList({renderingIntent:d,cacheKey:T,annotationStorageSerializable:k}){const{map:K,transfer:rt}=k,vt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:d,cacheKey:T,annotationStorage:K},rt).getReader(),ft=this._intentStates.get(T);ft.streamReader=vt;const It=()=>{vt.read().then(({value:m,done:Q})=>{if(Q){ft.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,ft),It())},m=>{if(ft.streamReader=null,!this._transport.destroyed){if(ft.operatorList){ft.operatorList.lastChunk=!0;for(const Q of ft.renderTasks)Q.operatorListChanged();x(this,et,Ye).call(this,!0)}if(ft.displayReadyCapability)ft.displayReadyCapability.reject(m);else if(ft.opListReadCapability)ft.opListReadCapability.reject(m);else throw m}})};It()}_abortOperatorList({intentState:d,reason:T,force:k=!1}){if(d.streamReader){if(d.streamReaderCancelTimeout&&(clearTimeout(d.streamReaderCancelTimeout),d.streamReaderCancelTimeout=null),!k){if(d.renderTasks.size>0)return;if(T instanceof dt.RenderingCancelledException){let K=ue;T.extraDelay>0&&T.extraDelay<1e3&&(K+=T.extraDelay),d.streamReaderCancelTimeout=setTimeout(()=>{d.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:d,reason:T,force:!0})},K);return}}if(d.streamReader.cancel(new P.AbortException(T.message)).catch(()=>{}),d.streamReader=null,!this._transport.destroyed){for(const[K,rt]of this._intentStates)if(rt===d){this._intentStates.delete(K);break}this.cleanup()}}}get stats(){return this._stats}}D=new WeakMap,B=new WeakMap,et=new WeakSet,Ye=function(d=!1){if(x(this,et,xs).call(this),!t(this,B)||this.destroyed)return!1;if(d)return R(this,D,setTimeout(()=>{R(this,D,null),x(this,et,Ye).call(this,!1)},O)),!1;for(const{renderTasks:T,operatorList:k}of this._intentStates.values())if(T.size>0||!k.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),R(this,B,!1),!0},xs=function(){t(this,D)&&(clearTimeout(t(this,D)),R(this,D,null))};class r{constructor(){F(this,Ct,new Set);F(this,qt,Promise.resolve())}postMessage(d,T){const k={data:structuredClone(d,T?{transfer:T}:null)};t(this,qt).then(()=>{for(const K of t(this,Ct))K.call(this,k)})}addEventListener(d,T){t(this,Ct).add(T)}removeEventListener(d,T){t(this,Ct).delete(T)}terminate(){t(this,Ct).clear()}}Ct=new WeakMap,qt=new WeakMap;const u={isWorkerDisabled:!1,fakeWorkerId:0};P.isNodeJS&&(u.isWorkerDisabled=!0,(Yt=$.GlobalWorkerOptions).workerSrc||(Yt.workerSrc="./pdf.worker.mjs")),u.isSameOrigin=function(C,d){let T;try{if(T=new URL(C),!T.origin||T.origin==="null")return!1}catch{return!1}const k=new URL(d,T);return T.origin===k.origin},u.createCDNWrapper=function(C){const d=`await import("${C}");`;return URL.createObjectURL(new Blob([d],{type:"text/javascript"}))};const N=class N{constructor({name:d=null,port:T=null,verbosity:k=(0,P.getVerbosityLevel)()}={}){var K;if(this.name=d,this.destroyed=!1,this.verbosity=k,this._readyCapability=new P.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,T){if((K=t(N,ie))!=null&&K.has(T))throw new Error("Cannot use more than one PDFWorker per port.");(t(N,ie)||R(N,ie,new WeakMap)).set(T,this),this._initializeFromPort(T);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(d){this._port=d,this._messageHandler=new z.MessageHandler("main","worker",d),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!u.isWorkerDisabled&&!t(N,Kt,ws)){let{workerSrc:d}=N;try{u.isSameOrigin(window.location.href,d)||(d=u.createCDNWrapper(new URL(d,window.location).href));const T=new Worker(d,{type:"module"}),k=new z.MessageHandler("main","worker",T),K=()=>{T.removeEventListener("error",rt),k.destroy(),T.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},rt=()=>{this._webWorker||K()};T.addEventListener("error",rt),k.on("test",ft=>{if(T.removeEventListener("error",rt),this.destroyed){K();return}ft?(this._messageHandler=k,this._port=T,this._webWorker=T,this._readyCapability.resolve(),k.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),k.destroy(),T.terminate())}),k.on("ready",ft=>{if(T.removeEventListener("error",rt),this.destroyed){K();return}try{vt()}catch{this._setupFakeWorker()}});const vt=()=>{const ft=new Uint8Array;k.send("test",ft,[ft.buffer])};vt();return}catch{(0,P.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){u.isWorkerDisabled||((0,P.warn)("Setting up fake worker."),u.isWorkerDisabled=!0),N._setupFakeWorkerGlobal.then(d=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const T=new r;this._port=T;const k=`fake${u.fakeWorkerId++}`,K=new z.MessageHandler(k+"_worker",k,T);d.setup(K,T);const rt=new z.MessageHandler(k,k+"_worker",T);this._messageHandler=rt,this._readyCapability.resolve(),rt.send("configure",{verbosity:this.verbosity})}).catch(d=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${d.message}".`))})}destroy(){var d;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(d=t(N,ie))==null||d.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(d){var k;if(!(d!=null&&d.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const T=(k=t(this,ie))==null?void 0:k.get(d.port);if(T){if(T._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return T}return new N(d)}static get workerSrc(){if($.GlobalWorkerOptions.workerSrc)return $.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const d=async()=>t(this,Kt,ws)?t(this,Kt,ws):(await import(this.workerSrc).then(async T=>(await T.__tla,T))).WorkerMessageHandler;return(0,P.shadow)(this,"_setupFakeWorkerGlobal",d())}};ie=new WeakMap,Kt=new WeakSet,ws=function(){var d;try{return((d=globalThis.pdfjsWorker)==null?void 0:d.WorkerMessageHandler)||null}catch{return null}},F(N,Kt),F(N,ie);let I=N;class at{constructor(d,T,k,K,rt){F(this,te);F(this,Ut,new Map);F(this,jt,new Map);F(this,ee,new Map);F(this,$t,null);this.messageHandler=d,this.loadingTask=T,this.commonObjs=new nt,this.fontLoader=new X.FontLoader({ownerDocument:K.ownerDocument,styleElement:K.styleElement}),this._params=K,this.canvasFactory=rt.canvasFactory,this.filterFactory=rt.filterFactory,this.cMapReaderFactory=rt.cMapReaderFactory,this.standardFontDataFactory=rt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=k,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new P.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,P.shadow)(this,"annotationStorage",new W.AnnotationStorage)}getRenderingIntent(d,T=P.AnnotationMode.ENABLE,k=null,K=!1){let rt=P.RenderingIntentFlag.DISPLAY,vt=W.SerializableEmpty;switch(d){case"any":rt=P.RenderingIntentFlag.ANY;break;case"display":break;case"print":rt=P.RenderingIntentFlag.PRINT;break;default:(0,P.warn)(`getRenderingIntent - invalid intent: ${d}`)}switch(T){case P.AnnotationMode.DISABLE:rt+=P.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case P.AnnotationMode.ENABLE:break;case P.AnnotationMode.ENABLE_FORMS:rt+=P.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case P.AnnotationMode.ENABLE_STORAGE:rt+=P.RenderingIntentFlag.ANNOTATIONS_STORAGE,vt=(rt&P.RenderingIntentFlag.PRINT&&k instanceof W.PrintAnnotationStorage?k:this.annotationStorage).serializable;break;default:(0,P.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return K&&(rt+=P.RenderingIntentFlag.OPLIST),{renderingIntent:rt,cacheKey:`${rt}_${vt.hash}`,annotationStorageSerializable:vt}}destroy(){var k;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new P.PromiseCapability,(k=t(this,$t))==null||k.reject(new Error("Worker was destroyed during onPassword callback"));const d=[];for(const K of t(this,jt).values())d.push(K._destroy());t(this,jt).clear(),t(this,ee).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return d.push(T),Promise.all(d).then(()=>{var K;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Ut).clear(),this.filterFactory.destroy(),(K=this._networkStream)==null||K.cancelAllRequests(new P.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:d,loadingTask:T}=this;d.on("GetReader",(k,K)=>{(0,P.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=rt=>{this._lastProgress={loaded:rt.loaded,total:rt.total}},K.onPull=()=>{this._fullReader.read().then(function({value:rt,done:vt}){if(vt){K.close();return}(0,P.assert)(rt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),K.enqueue(new Uint8Array(rt),1,[rt])}).catch(rt=>{K.error(rt)})},K.onCancel=rt=>{this._fullReader.cancel(rt),K.ready.catch(vt=>{if(!this.destroyed)throw vt})}}),d.on("ReaderHeadersReady",k=>{const K=new P.PromiseCapability,rt=this._fullReader;return rt.headersReady.then(()=>{var vt;(!rt.isStreamingSupported||!rt.isRangeSupported)&&(this._lastProgress&&((vt=T.onProgress)==null||vt.call(T,this._lastProgress)),rt.onProgress=ft=>{var It;(It=T.onProgress)==null||It.call(T,{loaded:ft.loaded,total:ft.total})}),K.resolve({isStreamingSupported:rt.isStreamingSupported,isRangeSupported:rt.isRangeSupported,contentLength:rt.contentLength})},K.reject),K.promise}),d.on("GetRangeReader",(k,K)=>{(0,P.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const rt=this._networkStream.getRangeReader(k.begin,k.end);if(!rt){K.close();return}K.onPull=()=>{rt.read().then(function({value:vt,done:ft}){if(ft){K.close();return}(0,P.assert)(vt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),K.enqueue(new Uint8Array(vt),1,[vt])}).catch(vt=>{K.error(vt)})},K.onCancel=vt=>{rt.cancel(vt),K.ready.catch(ft=>{if(!this.destroyed)throw ft})}}),d.on("GetDoc",({pdfInfo:k})=>{this._numPages=k.numPages,this._htmlForXfa=k.htmlForXfa,delete k.htmlForXfa,T._capability.resolve(new G(k,this))}),d.on("DocException",function(k){let K;switch(k.name){case"PasswordException":K=new P.PasswordException(k.message,k.code);break;case"InvalidPDFException":K=new P.InvalidPDFException(k.message);break;case"MissingPDFException":K=new P.MissingPDFException(k.message);break;case"UnexpectedResponseException":K=new P.UnexpectedResponseException(k.message,k.status);break;case"UnknownErrorException":K=new P.UnknownErrorException(k.message,k.details);break;default:(0,P.unreachable)("DocException - expected a valid Error.")}T._capability.reject(K)}),d.on("PasswordRequest",k=>{if(R(this,$t,new P.PromiseCapability),T.onPassword){const K=rt=>{rt instanceof Error?t(this,$t).reject(rt):t(this,$t).resolve({password:rt})};try{T.onPassword(K,k.code)}catch(rt){t(this,$t).reject(rt)}}else t(this,$t).reject(new P.PasswordException(k.message,k.code));return t(this,$t).promise}),d.on("DataLoaded",k=>{var K;(K=T.onProgress)==null||K.call(T,{loaded:k.length,total:k.length}),this.downloadInfoCapability.resolve(k)}),d.on("StartRenderPage",k=>{this.destroyed||t(this,jt).get(k.pageIndex)._startRenderPage(k.transparency,k.cacheKey)}),d.on("commonobj",([k,K,rt])=>{var vt;if(this.destroyed||this.commonObjs.has(k))return null;switch(K){case"Font":const ft=this._params;if("error"in rt){const Et=rt.error;(0,P.warn)(`Error during font loading: ${Et}`),this.commonObjs.resolve(k,Et);break}const It=ft.pdfBug&&((vt=globalThis.FontInspector)!=null&&vt.enabled)?(Et,yt)=>globalThis.FontInspector.fontAdded(Et,yt):null,m=new X.FontFaceObject(rt,{isEvalSupported:ft.isEvalSupported,disableFontFace:ft.disableFontFace,ignoreErrors:ft.ignoreErrors,inspectFont:It});this.fontLoader.bind(m).catch(Et=>d.sendWithPromise("FontFallback",{id:k})).finally(()=>{!ft.fontExtraProperties&&m.data&&(m.data=null),this.commonObjs.resolve(k,m)});break;case"CopyLocalImage":const{imageRef:Q}=rt;(0,P.assert)(Q,"The imageRef must be defined.");for(const Et of t(this,jt).values())for(const[,yt]of Et.objs)if(yt.ref===Q)return yt.dataLen?(this.commonObjs.resolve(k,structuredClone(yt)),yt.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(k,rt);break;default:throw new Error(`Got unknown common object type ${K}`)}return null}),d.on("obj",([k,K,rt,vt])=>{var It;if(this.destroyed)return;const ft=t(this,jt).get(K);if(!ft.objs.has(k)){if(ft._intentStates.size===0){(It=vt==null?void 0:vt.bitmap)==null||It.close();return}switch(rt){case"Image":ft.objs.resolve(k,vt),(vt==null?void 0:vt.dataLen)>P.MAX_IMAGE_SIZE_TO_CACHE&&(ft._maybeCleanupAfterRender=!0);break;case"Pattern":ft.objs.resolve(k,vt);break;default:throw new Error(`Got unknown object type ${rt}`)}}}),d.on("DocProgress",k=>{var K;this.destroyed||((K=T.onProgress)==null||K.call(T,{loaded:k.loaded,total:k.total}))}),d.on("FetchBuiltInCMap",k=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(k):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),d.on("FetchStandardFontData",k=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(k):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var k;this.annotationStorage.size<=0&&(0,P.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:d,transfer:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:d,filename:((k=this._fullReader)==null?void 0:k.filename)??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(d){if(!Number.isInteger(d)||d<=0||d>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=d-1,k=t(this,ee).get(T);if(k)return k;const K=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(rt=>{if(this.destroyed)throw new Error("Transport destroyed");const vt=new w(T,rt,this,this._params.pdfBug);return t(this,jt).set(T,vt),vt});return t(this,ee).set(T,K),K}getPageIndex(d){return typeof d!="object"||d===null||!Number.isInteger(d.num)||d.num<0||!Number.isInteger(d.gen)||d.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:d.num,gen:d.gen})}getAnnotations(d,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:d,intent:T})}getFieldObjects(){return x(this,te,Ss).call(this,"GetFieldObjects")}hasJSActions(){return x(this,te,Ss).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(d){return typeof d!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:d})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return x(this,te,Ss).call(this,"GetDocJSActions")}getPageJSActions(d){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:d})}getStructTree(d){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:d})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(d=>new L.OptionalContentConfig(d))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const d="GetMetadata",T=t(this,Ut).get(d);if(T)return T;const k=this.messageHandler.sendWithPromise(d,null).then(K=>{var rt,vt;return{info:K[0],metadata:K[1]?new A.Metadata(K[1]):null,contentDispositionFilename:((rt=this._fullReader)==null?void 0:rt.filename)??null,contentLength:((vt=this._fullReader)==null?void 0:vt.contentLength)??null}});return t(this,Ut).set(d,k),k}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(d=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of t(this,jt).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),d||this.fontLoader.clear(),t(this,Ut).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:d,enableXfa:T}=this._params;return(0,P.shadow)(this,"loadingParams",{disableAutoFetch:d,enableXfa:T})}}Ut=new WeakMap,jt=new WeakMap,ee=new WeakMap,$t=new WeakMap,te=new WeakSet,Ss=function(d,T=null){const k=t(this,Ut).get(d);if(k)return k;const K=this.messageHandler.sendWithPromise(d,T);return t(this,Ut).set(d,K),K};class nt{constructor(){F(this,Qt);F(this,Wt,Object.create(null))}get(d,T=null){if(T){const K=x(this,Qt,Ws).call(this,d);return K.capability.promise.then(()=>T(K.data)),null}const k=t(this,Wt)[d];if(!(k!=null&&k.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${d}.`);return k.data}has(d){var T;return((T=t(this,Wt)[d])==null?void 0:T.capability.settled)??!1}resolve(d,T=null){const k=x(this,Qt,Ws).call(this,d);k.data=T,k.capability.resolve()}clear(){var d;for(const T in t(this,Wt)){const{data:k}=t(this,Wt)[T];(d=k==null?void 0:k.bitmap)==null||d.close()}R(this,Wt,Object.create(null))}*[Symbol.iterator](){for(const d in t(this,Wt)){const{capability:T,data:k}=t(this,Wt)[d];T.settled&&(yield[d,k])}}}Wt=new WeakMap,Qt=new WeakSet,Ws=function(d){var T;return(T=t(this,Wt))[d]||(T[d]={capability:new P.PromiseCapability,data:null})};class st{constructor(d){F(this,kt,null);R(this,kt,d),this.onContinue=null}get promise(){return t(this,kt).capability.promise}cancel(d=0){t(this,kt).cancel(null,d)}get separateAnnots(){const{separateAnnots:d}=t(this,kt).operatorList;if(!d)return!1;const{annotationCanvasMap:T}=t(this,kt);return d.form||d.canvas&&(T==null?void 0:T.size)>0}}kt=new WeakMap;const J=class J{constructor({callback:d,params:T,objs:k,commonObjs:K,annotationCanvasMap:rt,operatorList:vt,pageIndex:ft,canvasFactory:It,filterFactory:m,useRequestAnimationFrame:Q=!1,pdfBug:Et=!1,pageColors:yt=null}){this.callback=d,this.params=T,this.objs=k,this.commonObjs=K,this.annotationCanvasMap=rt,this.operatorListIdx=null,this.operatorList=vt,this._pageIndex=ft,this.canvasFactory=It,this.filterFactory=m,this._pdfBug=Et,this.pageColors=yt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Q===!0&&typeof window<"u",this.cancelled=!1,this.capability=new P.PromiseCapability,this.task=new st(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=T.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:d=!1,optionalContentConfig:T}){var ft,It;if(this.cancelled)return;if(this._canvas){if(t(J,Jt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(J,Jt).add(this._canvas)}this._pdfBug&&((ft=globalThis.StepperManager)!=null&&ft.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:k,viewport:K,transform:rt,background:vt}=this.params;this.gfx=new v.CanvasGraphics(k,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:T},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:rt,viewport:K,transparency:d,background:vt}),this.operatorListIdx=0,this.graphicsReady=!0,(It=this.graphicsReadyCallback)==null||It.call(this)}cancel(d=null,T=0){var k;this.running=!1,this.cancelled=!0,(k=this.gfx)==null||k.endDrawing(),t(J,Jt).delete(this._canvas),this.callback(d||new dt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var d;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(d=this.stepper)==null||d.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(J,Jt).delete(this._canvas),this.callback())))}};Jt=new WeakMap,F(J,Jt,new WeakSet);let gt=J;const mt="4.0.379",Ft="9e14d04fd";it()}catch(ne){it(ne)}})},822:(Zt,Nt,lt)=>{lt.d(Nt,{BaseCMapReaderFactory:()=>W,BaseCanvasFactory:()=>P,BaseFilterFactory:()=>it,BaseSVGFactory:()=>X,BaseStandardFontDataFactory:()=>dt});var c=lt(266);class it{constructor(){this.constructor===it&&(0,c.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(v){return"none"}addHCMFilter(v,$){return"none"}addHighlightHCMFilter(v,$,z,A){return"none"}destroy(v=!1){}}class P{constructor(){this.constructor===P&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,$){if(v<=0||$<=0)throw new Error("Invalid canvas size");const z=this._createCanvas(v,$);return{canvas:z,context:z.getContext("2d")}}reset(v,$,z){if(!v.canvas)throw new Error("Canvas is not specified");if($<=0||z<=0)throw new Error("Invalid canvas size");v.canvas.width=$,v.canvas.height=z}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,$){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}class W{constructor({baseUrl:v=null,isCompressed:$=!0}){this.constructor===W&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=$}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const $=this.baseUrl+v+(this.isCompressed?".bcmap":""),z=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData($,z).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${$}`)})}_fetchData(v,$){(0,c.unreachable)("Abstract method `_fetchData` called.")}}class dt{constructor({baseUrl:v=null}){this.constructor===dt&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const $=`${this.baseUrl}${v}`;return this._fetchData($).catch(z=>{throw new Error(`Unable to load font data at: ${$}`)})}_fetchData(v){(0,c.unreachable)("Abstract method `_fetchData` called.")}}class X{constructor(){this.constructor===X&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,$,z=!1){if(v<=0||$<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),z||(A.setAttribute("width",`${v}px`),A.setAttribute("height",`${$}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${v} ${$}`),A}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,c.unreachable)("Abstract method `_createSVG` called.")}}},250:(Zt,Nt,lt)=>{var be,Xs,Ks;lt.d(Nt,{CanvasGraphics:()=>Jt});var c=lt(266),it=lt(473);const P={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function W(O,s){if(!s)return;const e=s[2]-s[0],i=s[3]-s[1],o=new Path2D;o.rect(s[0],s[1],e,i),O.clip(o)}class dt{constructor(){this.constructor===dt&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class X extends dt{constructor(s){super(),this._type=s[1],this._bbox=s[2],this._colorStops=s[3],this._p0=s[4],this._p1=s[5],this._r0=s[6],this._r1=s[7],this.matrix=null}_createGradient(s){let e;this._type==="axial"?e=s.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=s.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(s,e,i,o){let l;if(o===P.STROKE||o===P.FILL){const g=e.current.getClippedPathBoundingBox(o,(0,it.getCurrentTransform)(s))||[0,0,0,0],_=Math.ceil(g[2]-g[0])||1,G=Math.ceil(g[3]-g[1])||1,w=e.cachedCanvases.getCanvas("pattern",_,G,!0),r=w.context;r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(0,0,r.canvas.width,r.canvas.height),r.translate(-g[0],-g[1]),i=c.Util.transform(i,[1,0,0,1,g[0],g[1]]),r.transform(...e.baseTransform),this.matrix&&r.transform(...this.matrix),W(r,this._bbox),r.fillStyle=this._createGradient(r),r.fill(),l=s.createPattern(w.canvas,"no-repeat");const u=new DOMMatrix(i);l.setTransform(u)}else W(s,this._bbox),l=this._createGradient(s);return l}}function j(O,s,e,i,o,l,g,_){const G=s.coords,w=s.colors,r=O.data,u=O.width*4;let I;G[e+1]>G[i+1]&&(I=e,e=i,i=I,I=l,l=g,g=I),G[i+1]>G[o+1]&&(I=i,i=o,o=I,I=g,g=_,_=I),G[e+1]>G[i+1]&&(I=e,e=i,i=I,I=l,l=g,g=I);const at=(G[e]+s.offsetX)*s.scaleX,nt=(G[e+1]+s.offsetY)*s.scaleY,st=(G[i]+s.offsetX)*s.scaleX,gt=(G[i+1]+s.offsetY)*s.scaleY,mt=(G[o]+s.offsetX)*s.scaleX,Ft=(G[o+1]+s.offsetY)*s.scaleY;if(nt>=Ft)return;const a=w[l],N=w[l+1],J=w[l+2],C=w[g],d=w[g+1],T=w[g+2],k=w[_],K=w[_+1],rt=w[_+2],vt=Math.round(nt),ft=Math.round(Ft);let It,m,Q,Et,yt,bt,p,h;for(let S=vt;S<=ft;S++){if(S<gt){const Tt=S<nt?0:(nt-S)/(nt-gt);It=at-(at-st)*Tt,m=a-(a-C)*Tt,Q=N-(N-d)*Tt,Et=J-(J-T)*Tt}else{let Tt;S>Ft?Tt=1:gt===Ft?Tt=0:Tt=(gt-S)/(gt-Ft),It=st-(st-mt)*Tt,m=C-(C-k)*Tt,Q=d-(d-K)*Tt,Et=T-(T-rt)*Tt}let U;S<nt?U=0:S>Ft?U=1:U=(nt-S)/(nt-Ft),yt=at-(at-mt)*U,bt=a-(a-k)*U,p=N-(N-K)*U,h=J-(J-rt)*U;const tt=Math.round(Math.min(It,yt)),ct=Math.round(Math.max(It,yt));let ut=u*S+tt*4;for(let Tt=tt;Tt<=ct;Tt++)U=(It-Tt)/(It-yt),U<0?U=0:U>1&&(U=1),r[ut++]=m-(m-bt)*U|0,r[ut++]=Q-(Q-p)*U|0,r[ut++]=Et-(Et-h)*U|0,r[ut++]=255}}function v(O,s,e){const i=s.coords,o=s.colors;let l,g;switch(s.type){case"lattice":const _=s.verticesPerRow,G=Math.floor(i.length/_)-1,w=_-1;for(l=0;l<G;l++){let r=l*_;for(let u=0;u<w;u++,r++)j(O,e,i[r],i[r+1],i[r+_],o[r],o[r+1],o[r+_]),j(O,e,i[r+_+1],i[r+1],i[r+_],o[r+_+1],o[r+1],o[r+_])}break;case"triangles":for(l=0,g=i.length;l<g;l+=3)j(O,e,i[l],i[l+1],i[l+2],o[l],o[l+1],o[l+2]);break;default:throw new Error("illegal figure")}}class $ extends dt{constructor(s){super(),this._coords=s[2],this._colors=s[3],this._figures=s[4],this._bounds=s[5],this._bbox=s[7],this._background=s[8],this.matrix=null}_createMeshCanvas(s,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),g=Math.ceil(this._bounds[2])-o,_=Math.ceil(this._bounds[3])-l,G=Math.min(Math.ceil(Math.abs(g*s[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(_*s[1]*1.1)),3e3),r=g/G,u=_/w,I={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/r,scaleY:1/u},at=G+2*2,nt=w+2*2,st=i.getCanvas("mesh",at,nt,!1),gt=st.context,mt=gt.createImageData(G,w);if(e){const Ft=mt.data;for(let a=0,N=Ft.length;a<N;a+=4)Ft[a]=e[0],Ft[a+1]=e[1],Ft[a+2]=e[2],Ft[a+3]=255}for(const Ft of this._figures)v(mt,Ft,I);return gt.putImageData(mt,2,2),{canvas:st.canvas,offsetX:o-2*r,offsetY:l-2*u,scaleX:r,scaleY:u}}getPattern(s,e,i,o){W(s,this._bbox);let l;if(o===P.SHADING)l=c.Util.singularValueDecompose2dScale((0,it.getCurrentTransform)(s));else if(l=c.Util.singularValueDecompose2dScale(e.baseTransform),this.matrix){const _=c.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*_[0],l[1]*_[1]]}const g=this._createMeshCanvas(l,o===P.SHADING?null:this._background,e.cachedCanvases);return o!==P.SHADING&&(s.setTransform(...e.baseTransform),this.matrix&&s.transform(...this.matrix)),s.translate(g.offsetX,g.offsetY),s.scale(g.scaleX,g.scaleY),s.createPattern(g.canvas,"no-repeat")}}class z extends dt{getPattern(){return"hotpink"}}function A(O){switch(O[0]){case"RadialAxial":return new X(O);case"Mesh":return new $(O);case"Dummy":return new z}throw new Error(`Unknown IR type: ${O[0]}`)}const L={COLORED:1,UNCOLORED:2},ne=class ne{constructor(s,e,i,o,l){this.operatorList=s[2],this.matrix=s[3]||[1,0,0,1,0,0],this.bbox=s[4],this.xstep=s[5],this.ystep=s[6],this.paintType=s[7],this.tilingType=s[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=o,this.baseTransform=l}createPatternCanvas(s){const e=this.operatorList,i=this.bbox,o=this.xstep,l=this.ystep,g=this.paintType,_=this.tilingType,G=this.color,w=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+_);const r=i[0],u=i[1],I=i[2],at=i[3],nt=c.Util.singularValueDecompose2dScale(this.matrix),st=c.Util.singularValueDecompose2dScale(this.baseTransform),gt=[nt[0]*st[0],nt[1]*st[1]],mt=this.getSizeAndScale(o,this.ctx.canvas.width,gt[0]),Ft=this.getSizeAndScale(l,this.ctx.canvas.height,gt[1]),a=s.cachedCanvases.getCanvas("pattern",mt.size,Ft.size,!0),N=a.context,J=w.createCanvasGraphics(N);J.groupLevel=s.groupLevel,this.setFillAndStrokeStyleToContext(J,g,G);let C=r,d=u,T=I,k=at;return r<0&&(C=0,T+=Math.abs(r)),u<0&&(d=0,k+=Math.abs(u)),N.translate(-(mt.scale*C),-(Ft.scale*d)),J.transform(mt.scale,0,0,Ft.scale,0,0),N.save(),this.clipBbox(J,C,d,T,k),J.baseTransform=(0,it.getCurrentTransform)(J.ctx),J.executeOperatorList(e),J.endDrawing(),{canvas:a.canvas,scaleX:mt.scale,scaleY:Ft.scale,offsetX:C,offsetY:d}}getSizeAndScale(s,e,i){s=Math.abs(s);const o=Math.max(ne.MAX_PATTERN_SIZE,e);let l=Math.ceil(s*i);return l>=o?l=o:i=l/s,{scale:i,size:l}}clipBbox(s,e,i,o,l){const g=o-e,_=l-i;s.ctx.rect(e,i,g,_),s.current.updateRectMinMax((0,it.getCurrentTransform)(s.ctx),[e,i,o,l]),s.clip(),s.endPath()}setFillAndStrokeStyleToContext(s,e,i){const o=s.ctx,l=s.current;switch(e){case L.COLORED:const g=this.ctx;o.fillStyle=g.fillStyle,o.strokeStyle=g.strokeStyle,l.fillColor=g.fillStyle,l.strokeColor=g.strokeStyle;break;case L.UNCOLORED:const _=c.Util.makeHexColor(i[0],i[1],i[2]);o.fillStyle=_,o.strokeStyle=_,l.fillColor=_,l.strokeColor=_;break;default:throw new c.FormatError(`Unsupported paint type: ${e}`)}}getPattern(s,e,i,o){let l=i;o!==P.SHADING&&(l=c.Util.transform(l,e.baseTransform),this.matrix&&(l=c.Util.transform(l,this.matrix)));const g=this.createPatternCanvas(e);let _=new DOMMatrix(l);_=_.translate(g.offsetX,g.offsetY),_=_.scale(1/g.scaleX,1/g.scaleY);const G=s.createPattern(g.canvas,"repeat");return G.setTransform(_),G}};he(ne,"MAX_PATTERN_SIZE",3e3);let E=ne;function b({src:O,srcPos:s=0,dest:e,width:i,height:o,nonBlackColor:l=4294967295,inverseDecode:g=!1}){const _=c.FeatureTest.isLittleEndian?4278190080:255,[G,w]=g?[l,_]:[_,l],r=i>>3,u=i&7,I=O.length;e=new Uint32Array(e.buffer);let at=0;for(let nt=0;nt<o;nt++){for(const gt=s+r;s<gt;s++){const mt=s<I?O[s]:255;e[at++]=mt&128?w:G,e[at++]=mt&64?w:G,e[at++]=mt&32?w:G,e[at++]=mt&16?w:G,e[at++]=mt&8?w:G,e[at++]=mt&4?w:G,e[at++]=mt&2?w:G,e[at++]=mt&1?w:G}if(u===0)continue;const st=s<I?O[s++]:255;for(let gt=0;gt<u;gt++)e[at++]=st&1<<7-gt?w:G}return{srcPos:s,destPos:at}}const y=16,V=100,Y=4096,M=15,H=10,D=1e3,B=16;function et(O,s){if(O._removeMirroring)throw new Error("Context is already forwarding operations.");O.__originalSave=O.save,O.__originalRestore=O.restore,O.__originalRotate=O.rotate,O.__originalScale=O.scale,O.__originalTranslate=O.translate,O.__originalTransform=O.transform,O.__originalSetTransform=O.setTransform,O.__originalResetTransform=O.resetTransform,O.__originalClip=O.clip,O.__originalMoveTo=O.moveTo,O.__originalLineTo=O.lineTo,O.__originalBezierCurveTo=O.bezierCurveTo,O.__originalRect=O.rect,O.__originalClosePath=O.closePath,O.__originalBeginPath=O.beginPath,O._removeMirroring=()=>{O.save=O.__originalSave,O.restore=O.__originalRestore,O.rotate=O.__originalRotate,O.scale=O.__originalScale,O.translate=O.__originalTranslate,O.transform=O.__originalTransform,O.setTransform=O.__originalSetTransform,O.resetTransform=O.__originalResetTransform,O.clip=O.__originalClip,O.moveTo=O.__originalMoveTo,O.lineTo=O.__originalLineTo,O.bezierCurveTo=O.__originalBezierCurveTo,O.rect=O.__originalRect,O.closePath=O.__originalClosePath,O.beginPath=O.__originalBeginPath,delete O._removeMirroring},O.save=function(){s.save(),this.__originalSave()},O.restore=function(){s.restore(),this.__originalRestore()},O.translate=function(e,i){s.translate(e,i),this.__originalTranslate(e,i)},O.scale=function(e,i){s.scale(e,i),this.__originalScale(e,i)},O.transform=function(e,i,o,l,g,_){s.transform(e,i,o,l,g,_),this.__originalTransform(e,i,o,l,g,_)},O.setTransform=function(e,i,o,l,g,_){s.setTransform(e,i,o,l,g,_),this.__originalSetTransform(e,i,o,l,g,_)},O.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},O.rotate=function(e){s.rotate(e),this.__originalRotate(e)},O.clip=function(e){s.clip(e),this.__originalClip(e)},O.moveTo=function(e,i){s.moveTo(e,i),this.__originalMoveTo(e,i)},O.lineTo=function(e,i){s.lineTo(e,i),this.__originalLineTo(e,i)},O.bezierCurveTo=function(e,i,o,l,g,_){s.bezierCurveTo(e,i,o,l,g,_),this.__originalBezierCurveTo(e,i,o,l,g,_)},O.rect=function(e,i,o,l){s.rect(e,i,o,l),this.__originalRect(e,i,o,l)},O.closePath=function(){s.closePath(),this.__originalClosePath()},O.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class At{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,e,i){let o;return this.cache[s]!==void 0?(o=this.cache[s],this.canvasFactory.reset(o,e,i)):(o=this.canvasFactory.create(e,i),this.cache[s]=o),o}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const e=this.cache[s];this.canvasFactory.destroy(e),delete this.cache[s]}}}function St(O,s,e,i,o,l,g,_,G,w){const[r,u,I,at,nt,st]=(0,it.getCurrentTransform)(O);if(u===0&&I===0){const Ft=g*r+nt,a=Math.round(Ft),N=_*at+st,J=Math.round(N),C=(g+G)*r+nt,d=Math.abs(Math.round(C)-a)||1,T=(_+w)*at+st,k=Math.abs(Math.round(T)-J)||1;return O.setTransform(Math.sign(r),0,0,Math.sign(at),a,J),O.drawImage(s,e,i,o,l,0,0,d,k),O.setTransform(r,u,I,at,nt,st),[d,k]}if(r===0&&at===0){const Ft=_*I+nt,a=Math.round(Ft),N=g*u+st,J=Math.round(N),C=(_+w)*I+nt,d=Math.abs(Math.round(C)-a)||1,T=(g+G)*u+st,k=Math.abs(Math.round(T)-J)||1;return O.setTransform(0,Math.sign(u),Math.sign(I),0,a,J),O.drawImage(s,e,i,o,l,0,0,k,d),O.setTransform(r,u,I,at,nt,st),[k,d]}O.drawImage(s,e,i,o,l,g,_,G,w);const gt=Math.hypot(r,u),mt=Math.hypot(I,at);return[gt*G,mt*w]}function Ct(O){const{width:s,height:e}=O;if(s>D||e>D)return null;const i=1e3,o=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=s+1;let g=new Uint8Array(l*(e+1)),_,G,w;const r=s+7&-8;let u=new Uint8Array(r*e),I=0;for(const gt of O.data){let mt=128;for(;mt>0;)u[I++]=gt&mt?0:255,mt>>=1}let at=0;for(I=0,u[I]!==0&&(g[0]=1,++at),G=1;G<s;G++)u[I]!==u[I+1]&&(g[G]=u[I]?2:1,++at),I++;for(u[I]!==0&&(g[G]=2,++at),_=1;_<e;_++){I=_*r,w=_*l,u[I-r]!==u[I]&&(g[w]=u[I]?1:8,++at);let gt=(u[I]?4:0)+(u[I-r]?8:0);for(G=1;G<s;G++)gt=(gt>>2)+(u[I+1]?4:0)+(u[I-r+1]?8:0),o[gt]&&(g[w+G]=o[gt],++at),I++;if(u[I-r]!==u[I]&&(g[w+G]=u[I]?2:4,++at),at>i)return null}for(I=r*(e-1),w=_*l,u[I]!==0&&(g[w]=8,++at),G=1;G<s;G++)u[I]!==u[I+1]&&(g[w+G]=u[I]?4:8,++at),I++;if(u[I]!==0&&(g[w+G]=4,++at),at>i)return null;const nt=new Int32Array([0,l,-1,0,-l,0,0,0,1]),st=new Path2D;for(_=0;at&&_<=e;_++){let gt=_*l;const mt=gt+s;for(;gt<mt&&!g[gt];)gt++;if(gt===mt)continue;st.moveTo(gt%l,_);const Ft=gt;let a=g[gt];do{const N=nt[a];do gt+=N;while(!g[gt]);const J=g[gt];J!==5&&J!==10?(a=J,g[gt]=0):(a=J&51*a>>4,g[gt]&=a>>2|a<<2),st.lineTo(gt%l,gt/l|0),g[gt]||--at}while(Ft!==gt);--_}return u=null,g=null,function(gt){gt.save(),gt.scale(1/s,-1/e),gt.translate(0,-e),gt.fill(st),gt.beginPath(),gt.restore()}}class qt{constructor(s,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,e])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,e){this.x=s,this.y=e}updatePathMinMax(s,e,i){[e,i]=c.Util.applyTransform([e,i],s),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(s,e){const i=c.Util.applyTransform(e,s),o=c.Util.applyTransform(e.slice(2),s),l=c.Util.applyTransform([e[0],e[3]],s),g=c.Util.applyTransform([e[2],e[1]],s);this.minX=Math.min(this.minX,i[0],o[0],l[0],g[0]),this.minY=Math.min(this.minY,i[1],o[1],l[1],g[1]),this.maxX=Math.max(this.maxX,i[0],o[0],l[0],g[0]),this.maxY=Math.max(this.maxY,i[1],o[1],l[1],g[1])}updateScalingPathMinMax(s,e){c.Util.scaleMinMax(s,e),this.minX=Math.min(this.minX,e[0]),this.maxX=Math.max(this.maxX,e[1]),this.minY=Math.min(this.minY,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(s,e,i,o,l,g,_,G,w,r){const u=c.Util.bezierBoundingBox(e,i,o,l,g,_,G,w);if(r){r[0]=Math.min(r[0],u[0],u[2]),r[1]=Math.max(r[1],u[0],u[2]),r[2]=Math.min(r[2],u[1],u[3]),r[3]=Math.max(r[3],u[1],u[3]);return}this.updateRectMinMax(s,u)}getPathBoundingBox(s=P.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(s===P.STROKE){e||(0,c.unreachable)("Stroke bounding box must include transform.");const o=c.Util.singularValueDecompose2dScale(e),l=o[0]*this.lineWidth/2,g=o[1]*this.lineWidth/2;i[0]-=l,i[1]-=g,i[2]+=l,i[3]+=g}return i}updateClipFromPath(){const s=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=P.FILL,e=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(s,e))}}function Yt(O,s){if(typeof ImageData<"u"&&s instanceof ImageData){O.putImageData(s,0,0);return}const e=s.height,i=s.width,o=e%B,l=(e-o)/B,g=o===0?l:l+1,_=O.createImageData(i,B);let G=0,w;const r=s.data,u=_.data;let I,at,nt,st;if(s.kind===c.ImageKind.GRAYSCALE_1BPP){const gt=r.byteLength,mt=new Uint32Array(u.buffer,0,u.byteLength>>2),Ft=mt.length,a=i+7>>3,N=4294967295,J=c.FeatureTest.isLittleEndian?4278190080:255;for(I=0;I<g;I++){for(nt=I<l?B:o,w=0,at=0;at<nt;at++){const C=gt-G;let d=0;const T=C>a?i:C*8-7,k=T&-8;let K=0,rt=0;for(;d<k;d+=8)rt=r[G++],mt[w++]=rt&128?N:J,mt[w++]=rt&64?N:J,mt[w++]=rt&32?N:J,mt[w++]=rt&16?N:J,mt[w++]=rt&8?N:J,mt[w++]=rt&4?N:J,mt[w++]=rt&2?N:J,mt[w++]=rt&1?N:J;for(;d<T;d++)K===0&&(rt=r[G++],K=128),mt[w++]=rt&K?N:J,K>>=1}for(;w<Ft;)mt[w++]=0;O.putImageData(_,0,I*B)}}else if(s.kind===c.ImageKind.RGBA_32BPP){for(at=0,st=i*B*4,I=0;I<l;I++)u.set(r.subarray(G,G+st)),G+=st,O.putImageData(_,0,at),at+=B;I<g&&(st=i*o*4,u.set(r.subarray(G,G+st)),O.putImageData(_,0,at))}else if(s.kind===c.ImageKind.RGB_24BPP)for(nt=B,st=i*nt,I=0;I<g;I++){for(I>=l&&(nt=o,st=i*nt),w=0,at=st;at--;)u[w++]=r[G++],u[w++]=r[G++],u[w++]=r[G++],u[w++]=255;O.putImageData(_,0,I*B)}else throw new Error(`bad image kind: ${s.kind}`)}function ie(O,s){if(s.bitmap){O.drawImage(s.bitmap,0,0);return}const e=s.height,i=s.width,o=e%B,l=(e-o)/B,g=o===0?l:l+1,_=O.createImageData(i,B);let G=0;const w=s.data,r=_.data;for(let u=0;u<g;u++){const I=u<l?B:o;({srcPos:G}=b({src:w,srcPos:G,dest:r,width:i,height:I,nonBlackColor:0})),O.putImageData(_,0,u*B)}}function Kt(O,s){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)O[i]!==void 0&&(s[i]=O[i]);O.setLineDash!==void 0&&(s.setLineDash(O.getLineDash()),s.lineDashOffset=O.lineDashOffset)}function Bt(O){if(O.strokeStyle=O.fillStyle="#000000",O.fillRule="nonzero",O.globalAlpha=1,O.lineWidth=1,O.lineCap="butt",O.lineJoin="miter",O.miterLimit=10,O.globalCompositeOperation="source-over",O.font="10px sans-serif",O.setLineDash!==void 0&&(O.setLineDash([]),O.lineDashOffset=0),!c.isNodeJS){const{filter:s}=O;s!=="none"&&s!==""&&(O.filter="none")}}function Ut(O,s,e,i){const o=O.length;for(let l=3;l<o;l+=4){const g=O[l];if(g===0)O[l-3]=s,O[l-2]=e,O[l-1]=i;else if(g<255){const _=255-g;O[l-3]=O[l-3]*g+s*_>>8,O[l-2]=O[l-2]*g+e*_>>8,O[l-1]=O[l-1]*g+i*_>>8}}}function jt(O,s,e){const i=O.length,o=1/255;for(let l=3;l<i;l+=4){const g=e?e[O[l]]:O[l];s[l]=s[l]*g*o|0}}function ee(O,s,e){const i=O.length;for(let o=3;o<i;o+=4){const l=O[o-3]*77+O[o-2]*152+O[o-1]*28;s[o]=e?s[o]*e[l>>8]>>8:s[o]*l>>16}}function $t(O,s,e,i,o,l,g,_,G,w,r){const u=!!l,I=u?l[0]:0,at=u?l[1]:0,nt=u?l[2]:0,st=o==="Luminosity"?ee:jt,gt=Math.min(i,Math.ceil(1048576/e));for(let mt=0;mt<i;mt+=gt){const Ft=Math.min(gt,i-mt),a=O.getImageData(_-w,mt+(G-r),e,Ft),N=s.getImageData(_,mt+G,e,Ft);u&&Ut(a.data,I,at,nt),st(a.data,N.data,g),s.putImageData(N,_,mt+G)}}function te(O,s,e,i){const o=i[0],l=i[1],g=i[2]-o,_=i[3]-l;g===0||_===0||($t(s.context,e,g,_,s.subtype,s.backdrop,s.transferMap,o,l,s.offsetX,s.offsetY),O.save(),O.globalAlpha=1,O.globalCompositeOperation="source-over",O.setTransform(1,0,0,1,0,0),O.drawImage(e.canvas,0,0),O.restore())}function le(O,s){const e=c.Util.singularValueDecompose2dScale(O);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*it.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:e[0]<=i||e[1]<=i}const Wt=["butt","round","square"],Qt=["miter","round","bevel"],me={},kt={},ue=class ue{constructor(s,e,i,o,l,{optionalContentConfig:g,markedContentStack:_=null},G,w){F(this,be);this.ctx=s,this.current=new qt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=o,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=_||[],this.optionalContentConfig=g,this.cachedCanvases=new At(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=G,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=w,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,e=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):e}beginDrawing({transform:s,viewport:e,transparency:i=!1,background:o=null}){const l=this.ctx.canvas.width,g=this.ctx.canvas.height,_=this.ctx.fillStyle;if(this.ctx.fillStyle=o||"#ffffff",this.ctx.fillRect(0,0,l,g),this.ctx.fillStyle=_,i){const G=this.cachedCanvases.getCanvas("transparent",l,g);this.compositeCtx=this.ctx,this.transparentCanvas=G.canvas,this.ctx=G.context,this.ctx.save(),this.ctx.transform(...(0,it.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Bt(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=(0,it.getCurrentTransform)(this.ctx)}executeOperatorList(s,e,i,o){const l=s.argsArray,g=s.fnArray;let _=e||0;const G=l.length;if(G===_)return _;const w=G-_>H&&typeof i=="function",r=w?Date.now()+M:0;let u=0;const I=this.commonObjs,at=this.objs;let nt;for(;;){if(o!==void 0&&_===o.nextBreakPoint)return o.breakIt(_,i),_;if(nt=g[_],nt!==c.OPS.dependency)this[nt].apply(this,l[_]);else for(const st of l[_]){const gt=st.startsWith("g_")?I:at;if(!gt.has(st))return gt.get(st,i),_}if(_++,_===G)return _;if(w&&++u>H){if(Date.now()>r)return i(),_;u=0}}}endDrawing(){x(this,be,Xs).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const e of s.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);s.clear()}this._cachedBitmapsMap.clear(),x(this,be,Ks).call(this)}_scaleImage(s,e){const i=s.width,o=s.height;let l=Math.max(Math.hypot(e[0],e[1]),1),g=Math.max(Math.hypot(e[2],e[3]),1),_=i,G=o,w="prescale1",r,u;for(;l>2&&_>1||g>2&&G>1;){let I=_,at=G;l>2&&_>1&&(I=_>=16384?Math.floor(_/2)-1||1:Math.ceil(_/2),l/=_/I),g>2&&G>1&&(at=G>=16384?Math.floor(G/2)-1||1:Math.ceil(G)/2,g/=G/at),r=this.cachedCanvases.getCanvas(w,I,at),u=r.context,u.clearRect(0,0,I,at),u.drawImage(s,0,0,_,G,0,0,I,at),s=r.canvas,_=I,G=at,w=w==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:_,paintHeight:G}}_createMaskCanvas(s){const e=this.ctx,{width:i,height:o}=s,l=this.current.fillColor,g=this.current.patternFill,_=(0,it.getCurrentTransform)(e);let G,w,r,u;if((s.bitmap||s.data)&&s.count>1){const T=s.bitmap||s.data.buffer;w=JSON.stringify(g?_:[_.slice(0,4),l]),G=this._cachedBitmapsMap.get(T),G||(G=new Map,this._cachedBitmapsMap.set(T,G));const k=G.get(w);if(k&&!g){const K=Math.round(Math.min(_[0],_[2])+_[4]),rt=Math.round(Math.min(_[1],_[3])+_[5]);return{canvas:k,offsetX:K,offsetY:rt}}r=k}r||(u=this.cachedCanvases.getCanvas("maskCanvas",i,o),ie(u.context,s));let I=c.Util.transform(_,[1/i,0,0,-1/o,0,0]);I=c.Util.transform(I,[1,0,0,1,0,-o]);const[at,nt,st,gt]=c.Util.getAxialAlignedBoundingBox([0,0,i,o],I),mt=Math.round(st-at)||1,Ft=Math.round(gt-nt)||1,a=this.cachedCanvases.getCanvas("fillCanvas",mt,Ft),N=a.context,J=at,C=nt;N.translate(-J,-C),N.transform(...I),r||(r=this._scaleImage(u.canvas,(0,it.getCurrentTransformInverse)(N)),r=r.img,G&&g&&G.set(w,r)),N.imageSmoothingEnabled=le((0,it.getCurrentTransform)(N),s.interpolate),St(N,r,0,0,r.width,r.height,0,0,i,o),N.globalCompositeOperation="source-in";const d=c.Util.transform((0,it.getCurrentTransformInverse)(N),[1,0,0,1,-J,-C]);return N.fillStyle=g?l.getPattern(e,this,d,P.FILL):l,N.fillRect(0,0,i,o),G&&!g&&(this.cachedCanvases.delete("fillCanvas"),G.set(w,a.canvas)),{canvas:a.canvas,offsetX:Math.round(J),offsetY:Math.round(C)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=Wt[s]}setLineJoin(s){this.ctx.lineJoin=Qt[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(s),i.lineDashOffset=e)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[e,i]of s)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(i,s,e);this.suspendedCtx=this.ctx,this.ctx=o.context;const l=this.ctx;l.setTransform(...(0,it.getCurrentTransform)(this.suspendedCtx)),Kt(this.suspendedCtx,l),et(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Kt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;te(i,e,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Kt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Kt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,e,i,o,l,g){this.ctx.transform(s,e,i,o,l,g),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,e,i){const o=this.ctx,l=this.current;let g=l.x,_=l.y,G,w;const r=(0,it.getCurrentTransform)(o),u=r[0]===0&&r[3]===0||r[1]===0&&r[2]===0,I=u?i.slice(0):null;for(let at=0,nt=0,st=s.length;at<st;at++)switch(s[at]|0){case c.OPS.rectangle:g=e[nt++],_=e[nt++];const gt=e[nt++],mt=e[nt++],Ft=g+gt,a=_+mt;o.moveTo(g,_),gt===0||mt===0?o.lineTo(Ft,a):(o.lineTo(Ft,_),o.lineTo(Ft,a),o.lineTo(g,a)),u||l.updateRectMinMax(r,[g,_,Ft,a]),o.closePath();break;case c.OPS.moveTo:g=e[nt++],_=e[nt++],o.moveTo(g,_),u||l.updatePathMinMax(r,g,_);break;case c.OPS.lineTo:g=e[nt++],_=e[nt++],o.lineTo(g,_),u||l.updatePathMinMax(r,g,_);break;case c.OPS.curveTo:G=g,w=_,g=e[nt+4],_=e[nt+5],o.bezierCurveTo(e[nt],e[nt+1],e[nt+2],e[nt+3],g,_),l.updateCurvePathMinMax(r,G,w,e[nt],e[nt+1],e[nt+2],e[nt+3],g,_,I),nt+=6;break;case c.OPS.curveTo2:G=g,w=_,o.bezierCurveTo(g,_,e[nt],e[nt+1],e[nt+2],e[nt+3]),l.updateCurvePathMinMax(r,G,w,g,_,e[nt],e[nt+1],e[nt+2],e[nt+3],I),g=e[nt+2],_=e[nt+3],nt+=4;break;case c.OPS.curveTo3:G=g,w=_,g=e[nt+2],_=e[nt+3],o.bezierCurveTo(e[nt],e[nt+1],g,_,g,_),l.updateCurvePathMinMax(r,G,w,e[nt],e[nt+1],g,_,g,_,I),nt+=4;break;case c.OPS.closePath:o.closePath();break}u&&l.updateScalingPathMinMax(r,I),l.setCurrentPoint(g,_)}closePath(){this.ctx.closePath()}stroke(s=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(e.save(),e.strokeStyle=i.getPattern(e,this,(0,it.getCurrentTransformInverse)(e),P.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const e=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let l=!1;o&&(e.save(),e.fillStyle=i.getPattern(e,this,(0,it.getCurrentTransformInverse)(e),P.FILL),l=!0);const g=this.current.getClippedPathBoundingBox();this.contentVisible&&g!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),l&&e.restore(),s&&this.consumePath(g)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=me}eoClip(){this.pendingClip=kt}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,e=this.ctx;if(s===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of s)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,e){var r;const i=this.commonObjs.get(s),o=this.current;if(!i)throw new Error(`Can't find font for ${s}`);if(o.fontMatrix=i.fontMatrix||c.FONT_IDENTITY_MATRIX,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+s),e<0?(e=-e,o.fontDirection=-1):o.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const l=i.loadedName||"sans-serif",g=((r=i.systemFontInfo)==null?void 0:r.css)||`"${l}", ${i.fallbackName}`;let _="normal";i.black?_="900":i.bold&&(_="bold");const G=i.italic?"italic":"normal";let w=e;e<y?w=y:e>V&&(w=V),this.current.fontSizeScale=e/w,this.ctx.font=`${G} ${_} ${w}px ${g}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,e){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=e}setLeadingMoveText(s,e){this.setLeading(-e),this.moveText(s,e)}setTextMatrix(s,e,i,o,l,g){this.current.textMatrix=[s,e,i,o,l,g],this.current.textMatrixScale=Math.hypot(s,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,e,i,o){const l=this.ctx,g=this.current,_=g.font,G=g.textRenderingMode,w=g.fontSize/g.fontSizeScale,r=G&c.TextRenderingMode.FILL_STROKE_MASK,u=!!(G&c.TextRenderingMode.ADD_TO_PATH_FLAG),I=g.patternFill&&!_.missingFile;let at;(_.disableFontFace||u||I)&&(at=_.getPathGenerator(this.commonObjs,s)),_.disableFontFace||I?(l.save(),l.translate(e,i),l.beginPath(),at(l,w),o&&l.setTransform(...o),(r===c.TextRenderingMode.FILL||r===c.TextRenderingMode.FILL_STROKE)&&l.fill(),(r===c.TextRenderingMode.STROKE||r===c.TextRenderingMode.FILL_STROKE)&&l.stroke(),l.restore()):((r===c.TextRenderingMode.FILL||r===c.TextRenderingMode.FILL_STROKE)&&l.fillText(s,e,i),(r===c.TextRenderingMode.STROKE||r===c.TextRenderingMode.FILL_STROKE)&&l.strokeText(s,e,i)),u&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,it.getCurrentTransform)(l),x:e,y:i,fontSize:w,addToPath:at})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const e=s.getImageData(0,0,10,10).data;let i=!1;for(let o=3;o<e.length;o+=4)if(e[o]>0&&e[o]<255){i=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(s){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(s);const o=e.fontSize;if(o===0)return;const l=this.ctx,g=e.fontSizeScale,_=e.charSpacing,G=e.wordSpacing,w=e.fontDirection,r=e.textHScale*w,u=s.length,I=i.vertical,at=I?1:-1,nt=i.defaultVMetrics,st=o*e.fontMatrix[0],gt=e.textRenderingMode===c.TextRenderingMode.FILL&&!i.disableFontFace&&!e.patternFill;l.save(),l.transform(...e.textMatrix),l.translate(e.x,e.y+e.textRise),w>0?l.scale(r,-1):l.scale(r,1);let mt;if(e.patternFill){l.save();const C=e.fillColor.getPattern(l,this,(0,it.getCurrentTransformInverse)(l),P.FILL);mt=(0,it.getCurrentTransform)(l),l.restore(),l.fillStyle=C}let Ft=e.lineWidth;const a=e.textMatrixScale;if(a===0||Ft===0){const C=e.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(C===c.TextRenderingMode.STROKE||C===c.TextRenderingMode.FILL_STROKE)&&(Ft=this.getSinglePixelWidth())}else Ft/=a;if(g!==1&&(l.scale(g,g),Ft/=g),l.lineWidth=Ft,i.isInvalidPDFjsFont){const C=[];let d=0;for(const T of s)C.push(T.unicode),d+=T.width;l.fillText(C.join(""),0,0),e.x+=d*st*r,l.restore(),this.compose();return}let N=0,J;for(J=0;J<u;++J){const C=s[J];if(typeof C=="number"){N+=at*C*o/1e3;continue}let d=!1;const T=(C.isSpace?G:0)+_,k=C.fontChar,K=C.accent;let rt,vt,ft=C.width;if(I){const m=C.vmetric||nt,Q=-(C.vmetric?m[1]:ft*.5)*st,Et=m[2]*st;ft=m?-m[0]:ft,rt=Q/g,vt=(N+Et)/g}else rt=N/g,vt=0;if(i.remeasure&&ft>0){const m=l.measureText(k).width*1e3/o*g;if(ft<m&&this.isFontSubpixelAAEnabled){const Q=ft/m;d=!0,l.save(),l.scale(Q,1),rt/=Q}else ft!==m&&(rt+=(ft-m)/2e3*o/g)}if(this.contentVisible&&(C.isInFont||i.missingFile)){if(gt&&!K)l.fillText(k,rt,vt);else if(this.paintChar(k,rt,vt,mt),K){const m=rt+o*K.offset.x/g,Q=vt-o*K.offset.y/g;this.paintChar(K.fontChar,m,Q,mt)}}const It=I?ft*st-T*w:ft*st+T*w;N+=It,d&&l.restore()}I?e.y-=N:e.x+=N*r,l.restore(),this.compose()}showType3Text(s){const e=this.ctx,i=this.current,o=i.font,l=i.fontSize,g=i.fontDirection,_=o.vertical?1:-1,G=i.charSpacing,w=i.wordSpacing,r=i.textHScale*g,u=i.fontMatrix||c.FONT_IDENTITY_MATRIX,I=s.length,at=i.textRenderingMode===c.TextRenderingMode.INVISIBLE;let nt,st,gt,mt;if(!(at||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(r,g),nt=0;nt<I;++nt){if(st=s[nt],typeof st=="number"){mt=_*st*l/1e3,this.ctx.translate(mt,0),i.x+=mt*r;continue}const Ft=(st.isSpace?w:0)+G,a=o.charProcOperatorList[st.operatorListId];if(!a){(0,c.warn)(`Type3 character "${st.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=st,this.save(),e.scale(l,l),e.transform(...u),this.executeOperatorList(a),this.restore()),gt=c.Util.applyTransform([st.width,0],u)[0]*l+Ft,e.translate(gt,0),i.x+=gt*r}e.restore(),this.processingType3=null}}setCharWidth(s,e){}setCharWidthAndBounds(s,e,i,o,l,g){this.ctx.rect(i,o,l-i,g-o),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let e;if(s[0]==="TilingPattern"){const i=s[1],o=this.baseTransform||(0,it.getCurrentTransform)(this.ctx),l={createCanvasGraphics:g=>new ue(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new E(s,i,this.ctx,l,o)}else e=this._getPattern(s[1],s[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,e,i){const o=c.Util.makeHexColor(s,e,i);this.ctx.strokeStyle=o,this.current.strokeColor=o}setFillRGBColor(s,e,i){const o=c.Util.makeHexColor(s,e,i);this.ctx.fillStyle=o,this.current.fillColor=o,this.current.patternFill=!1}_getPattern(s,e=null){let i;return this.cachedPatterns.has(s)?i=this.cachedPatterns.get(s):(i=A(this.getObject(s)),this.cachedPatterns.set(s,i)),e&&(i.matrix=e),i}shadingFill(s){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(s);e.fillStyle=i.getPattern(e,this,(0,it.getCurrentTransformInverse)(e),P.SHADING);const o=(0,it.getCurrentTransformInverse)(e);if(o){const{width:l,height:g}=e.canvas,[_,G,w,r]=c.Util.getAxialAlignedBoundingBox([0,0,l,g],o);this.ctx.fillRect(_,G,w-_,r-G)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,it.getCurrentTransform)(this.ctx),e)){const i=e[2]-e[0],o=e[3]-e[1];this.ctx.rect(e[0],e[1],i,o),this.current.updateRectMinMax((0,it.getCurrentTransform)(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;s.isolated||(0,c.info)("TODO: Support non-isolated groups."),s.knockout&&(0,c.warn)("Knockout groups not supported.");const i=(0,it.getCurrentTransform)(e);if(s.matrix&&e.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let o=c.Util.getAxialAlignedBoundingBox(s.bbox,(0,it.getCurrentTransform)(e));const l=[0,0,e.canvas.width,e.canvas.height];o=c.Util.intersect(o,l)||[0,0,0,0];const g=Math.floor(o[0]),_=Math.floor(o[1]);let G=Math.max(Math.ceil(o[2])-g,1),w=Math.max(Math.ceil(o[3])-_,1),r=1,u=1;G>Y&&(r=G/Y,G=Y),w>Y&&(u=w/Y,w=Y),this.current.startNewPathAndClipBox([0,0,G,w]);let I="groupAt"+this.groupLevel;s.smask&&(I+="_smask_"+this.smaskCounter++%2);const at=this.cachedCanvases.getCanvas(I,G,w),nt=at.context;nt.scale(1/r,1/u),nt.translate(-g,-_),nt.transform(...i),s.smask?this.smaskStack.push({canvas:at.canvas,context:nt,offsetX:g,offsetY:_,scaleX:r,scaleY:u,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(g,_),e.scale(r,u),e.save()),Kt(e,nt),this.ctx=nt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const o=(0,it.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);const l=c.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],o);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(s,e,i,o,l){if(x(this,be,Xs).call(this),Bt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(e)&&e.length===4){const g=e[2]-e[0],_=e[3]-e[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=g,e[3]=_;const[G,w]=c.Util.singularValueDecompose2dScale((0,it.getCurrentTransform)(this.ctx)),{viewportScale:r}=this,u=Math.ceil(g*this.outputScaleX*r),I=Math.ceil(_*this.outputScaleY*r);this.annotationCanvas=this.canvasFactory.create(u,I);const{canvas:at,context:nt}=this.annotationCanvas;this.annotationCanvasMap.set(s,at),this.annotationCanvas.savedCtx=this.ctx,this.ctx=nt,this.ctx.save(),this.ctx.setTransform(G,0,0,-w,0,_*w),Bt(this.ctx)}else Bt(this.ctx),this.ctx.rect(e[0],e[1],g,_),this.ctx.clip(),this.endPath()}this.current=new qt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...o)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),x(this,be,Ks).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const e=s.count;s=this.getObject(s.data,s),s.count=e;const i=this.ctx,o=this.processingType3;if(o&&(o.compiled===void 0&&(o.compiled=Ct(s)),o.compiled)){o.compiled(i);return}const l=this._createMaskCanvas(s),g=l.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(g,l.offsetX,l.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(s,e,i=0,o=0,l,g){if(!this.contentVisible)return;s=this.getObject(s.data,s);const _=this.ctx;_.save();const G=(0,it.getCurrentTransform)(_);_.transform(e,i,o,l,0,0);const w=this._createMaskCanvas(s);_.setTransform(1,0,0,1,w.offsetX-G[4],w.offsetY-G[5]);for(let r=0,u=g.length;r<u;r+=2){const I=c.Util.transform(G,[e,i,o,l,g[r],g[r+1]]),[at,nt]=c.Util.applyTransform([0,0],I);_.drawImage(w.canvas,at,nt)}_.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,o=this.current.patternFill;for(const l of s){const{data:g,width:_,height:G,transform:w}=l,r=this.cachedCanvases.getCanvas("maskCanvas",_,G),u=r.context;u.save();const I=this.getObject(g,l);ie(u,I),u.globalCompositeOperation="source-in",u.fillStyle=o?i.getPattern(u,this,(0,it.getCurrentTransformInverse)(e),P.FILL):i,u.fillRect(0,0,_,G),u.restore(),e.save(),e.transform(...w),e.scale(1,-1),St(e,r.canvas,0,0,_,G,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const e=this.getObject(s);if(!e){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(s,e,i,o){if(!this.contentVisible)return;const l=this.getObject(s);if(!l){(0,c.warn)("Dependent image isn't ready yet");return}const g=l.width,_=l.height,G=[];for(let w=0,r=o.length;w<r;w+=2)G.push({transform:[e,0,0,i,o[w],o[w+1]],x:0,y:0,w:g,h:_});this.paintInlineImageXObjectGroup(l,G)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:e,width:i,height:o}=s,l=this.cachedCanvases.getCanvas("inlineImage",i,o),g=l.context;return g.filter=this.current.transferMaps,g.drawImage(e,0,0),g.filter="none",l.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const e=s.width,i=s.height,o=this.ctx;if(this.save(),!c.isNodeJS){const{filter:_}=o;_!=="none"&&_!==""&&(o.filter="none")}o.scale(1/e,-1/i);let l;if(s.bitmap)l=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)l=s;else{const _=this.cachedCanvases.getCanvas("inlineImage",e,i).context;Yt(_,s),l=this.applyTransferMapsToCanvas(_)}const g=this._scaleImage(l,(0,it.getCurrentTransformInverse)(o));o.imageSmoothingEnabled=le((0,it.getCurrentTransform)(o),s.interpolate),St(o,g.img,0,0,g.paintWidth,g.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,e){if(!this.contentVisible)return;const i=this.ctx;let o;if(s.bitmap)o=s.bitmap;else{const l=s.width,g=s.height,_=this.cachedCanvases.getCanvas("inlineImage",l,g).context;Yt(_,s),o=this.applyTransferMapsToCanvas(_)}for(const l of e)i.save(),i.transform(...l.transform),i.scale(1,-1),St(i,o,l.x,l.y,l.w,l.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,e){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,e){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===kt?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,it.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const e=Math.abs(s[0]*s[3]-s[2]*s[1]),i=Math.hypot(s[0],s[2]),o=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(i,o)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:e,b:i,c:o,d:l}=this.ctx.getTransform();let g,_;if(i===0&&o===0){const G=Math.abs(e),w=Math.abs(l);if(G===w)if(s===0)g=_=1/G;else{const r=G*s;g=_=r<1?1/r:1}else if(s===0)g=1/G,_=1/w;else{const r=G*s,u=w*s;g=r<1?1/r:1,_=u<1?1/u:1}}else{const G=Math.abs(e*l-i*o),w=Math.hypot(e,i),r=Math.hypot(o,l);if(s===0)g=r/G,_=w/G;else{const u=s*G;g=r>u?r/u:1,_=w>u?w/u:1}}this._cachedScaleForStroking[0]=g,this._cachedScaleForStroking[1]=_}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:e}=this,{lineWidth:i}=this.current,[o,l]=this.getScaleForStroking();if(e.lineWidth=i||1,o===1&&l===1){e.stroke();return}const g=e.getLineDash();if(s&&e.save(),e.scale(o,l),g.length>0){const _=Math.max(o,l);e.setLineDash(g.map(G=>G/_)),e.lineDashOffset/=_}e.stroke(),s&&e.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};be=new WeakSet,Xs=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ks=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const e=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let Jt=ue;for(const O in c.OPS)Jt.prototype[O]!==void 0&&(Jt.prototype[c.OPS[O]]=Jt.prototype[O])},473:(Zt,Nt,lt)=>{var Kt,Bt,Ut,jt,ee,$t,te,le,Wt,Qt,me,kt,Qe,Je,Ys,Ts,Cs,ls,cs;lt.d(Nt,{DOMCMapReaderFactory:()=>v,DOMCanvasFactory:()=>X,DOMFilterFactory:()=>dt,DOMSVGFactory:()=>z,DOMStandardFontDataFactory:()=>$,PDFDateString:()=>B,PageViewport:()=>A,PixelsPerInch:()=>W,RenderingCancelledException:()=>L,StatTimer:()=>Y,fetchData:()=>j,getColorValues:()=>St,getCurrentTransform:()=>Ct,getCurrentTransformInverse:()=>qt,getFilenameFromUrl:()=>y,getPdfFilenameFromUrl:()=>V,getRGB:()=>At,getXfaPageViewport:()=>et,isDataScheme:()=>E,isPdfFile:()=>b,isValidFetchUrl:()=>M,noContextMenu:()=>H,setLayerDimensions:()=>Yt});var c=lt(822),it=lt(266);const P="http://www.w3.org/2000/svg",ie=class ie{};he(ie,"CSS",96),he(ie,"PDF",72),he(ie,"PDF_TO_CSS_UNITS",ie.CSS/ie.PDF);let W=ie;class dt extends c.BaseFilterFactory{constructor({docId:i,ownerDocument:o=globalThis.document}={}){super();F(this,kt);F(this,Kt);F(this,Bt);F(this,Ut);F(this,jt);F(this,ee);F(this,$t);F(this,te);F(this,le);F(this,Wt);F(this,Qt);F(this,me,0);R(this,Ut,i),R(this,jt,o)}addFilter(i){if(!i)return"none";let o=t(this,kt,Qe).get(i);if(o)return o;let l,g,_,G;if(i.length===1){const I=i[0],at=new Array(256);for(let nt=0;nt<256;nt++)at[nt]=I[nt]/255;G=l=g=_=at.join(",")}else{const[I,at,nt]=i,st=new Array(256),gt=new Array(256),mt=new Array(256);for(let Ft=0;Ft<256;Ft++)st[Ft]=I[Ft]/255,gt[Ft]=at[Ft]/255,mt[Ft]=nt[Ft]/255;l=st.join(","),g=gt.join(","),_=mt.join(","),G=`${l}${g}${_}`}if(o=t(this,kt,Qe).get(G),o)return t(this,kt,Qe).set(i,o),o;const w=`g_${t(this,Ut)}_transfer_map_${Be(this,me)._++}`,r=`url(#${w})`;t(this,kt,Qe).set(i,r),t(this,kt,Qe).set(G,r);const u=x(this,kt,Ts).call(this,w);return x(this,kt,ls).call(this,l,g,_,u),r}addHCMFilter(i,o){var at;const l=`${i}-${o}`;if(t(this,$t)===l)return t(this,te);if(R(this,$t,l),R(this,te,"none"),(at=t(this,ee))==null||at.remove(),!i||!o)return t(this,te);const g=x(this,kt,cs).call(this,i);i=it.Util.makeHexColor(...g);const _=x(this,kt,cs).call(this,o);if(o=it.Util.makeHexColor(..._),t(this,kt,Je).style.color="",i==="#000000"&&o==="#ffffff"||i===o)return t(this,te);const G=new Array(256);for(let nt=0;nt<=255;nt++){const st=nt/255;G[nt]=st<=.03928?st/12.92:((st+.055)/1.055)**2.4}const w=G.join(","),r=`g_${t(this,Ut)}_hcm_filter`,u=R(this,le,x(this,kt,Ts).call(this,r));x(this,kt,ls).call(this,w,w,w,u),x(this,kt,Ys).call(this,u);const I=(nt,st)=>{const gt=g[nt]/255,mt=_[nt]/255,Ft=new Array(st+1);for(let a=0;a<=st;a++)Ft[a]=gt+a/st*(mt-gt);return Ft.join(",")};return x(this,kt,ls).call(this,I(0,5),I(1,5),I(2,5),u),R(this,te,`url(#${r})`),t(this,te)}addHighlightHCMFilter(i,o,l,g){var mt;const _=`${i}-${o}-${l}-${g}`;if(t(this,Wt)===_)return t(this,Qt);if(R(this,Wt,_),R(this,Qt,"none"),(mt=t(this,le))==null||mt.remove(),!i||!o)return t(this,Qt);const[G,w]=[i,o].map(x(this,kt,cs).bind(this));let r=Math.round(.2126*G[0]+.7152*G[1]+.0722*G[2]),u=Math.round(.2126*w[0]+.7152*w[1]+.0722*w[2]),[I,at]=[l,g].map(x(this,kt,cs).bind(this));u<r&&([r,u,I,at]=[u,r,at,I]),t(this,kt,Je).style.color="";const nt=(Ft,a,N)=>{const J=new Array(256),C=(u-r)/N,d=Ft/255,T=(a-Ft)/(255*N);let k=0;for(let K=0;K<=N;K++){const rt=Math.round(r+K*C),vt=d+K*T;for(let ft=k;ft<=rt;ft++)J[ft]=vt;k=rt+1}for(let K=k;K<256;K++)J[K]=J[k-1];return J.join(",")},st=`g_${t(this,Ut)}_hcm_highlight_filter`,gt=R(this,le,x(this,kt,Ts).call(this,st));return x(this,kt,Ys).call(this,gt),x(this,kt,ls).call(this,nt(I[0],at[0],5),nt(I[1],at[1],5),nt(I[2],at[2],5),gt),R(this,Qt,`url(#${st})`),t(this,Qt)}destroy(i=!1){i&&(t(this,te)||t(this,Qt))||(t(this,Bt)&&(t(this,Bt).parentNode.parentNode.remove(),R(this,Bt,null)),t(this,Kt)&&(t(this,Kt).clear(),R(this,Kt,null)),R(this,me,0))}}Kt=new WeakMap,Bt=new WeakMap,Ut=new WeakMap,jt=new WeakMap,ee=new WeakMap,$t=new WeakMap,te=new WeakMap,le=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,me=new WeakMap,kt=new WeakSet,Qe=function(){return t(this,Kt)||R(this,Kt,new Map)},Je=function(){if(!t(this,Bt)){const i=t(this,jt).createElement("div"),{style:o}=i;o.visibility="hidden",o.contain="strict",o.width=o.height=0,o.position="absolute",o.top=o.left=0,o.zIndex=-1;const l=t(this,jt).createElementNS(P,"svg");l.setAttribute("width",0),l.setAttribute("height",0),R(this,Bt,t(this,jt).createElementNS(P,"defs")),i.append(l),l.append(t(this,Bt)),t(this,jt).body.append(i)}return t(this,Bt)},Ys=function(i){const o=t(this,jt).createElementNS(P,"feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),i.append(o)},Ts=function(i){const o=t(this,jt).createElementNS(P,"filter");return o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("id",i),t(this,kt,Je).append(o),o},Cs=function(i,o,l){const g=t(this,jt).createElementNS(P,o);g.setAttribute("type","discrete"),g.setAttribute("tableValues",l),i.append(g)},ls=function(i,o,l,g){const _=t(this,jt).createElementNS(P,"feComponentTransfer");g.append(_),x(this,kt,Cs).call(this,_,"feFuncR",i),x(this,kt,Cs).call(this,_,"feFuncG",o),x(this,kt,Cs).call(this,_,"feFuncB",l)},cs=function(i){return t(this,kt,Je).style.color=i,At(getComputedStyle(t(this,kt,Je)).getPropertyValue("color"))};class X extends c.BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}_createCanvas(e,i){const o=this._document.createElement("canvas");return o.width=e,o.height=i,o}}async function j(s,e="text"){if(M(s,document.baseURI)){const i=await fetch(s);if(!i.ok)throw new Error(i.statusText);switch(e){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,o)=>{const l=new XMLHttpRequest;l.open("GET",s,!0),l.responseType=e,l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let g;switch(e){case"arraybuffer":case"blob":case"json":g=l.response;break;default:g=l.responseText;break}if(g){i(g);return}}o(new Error(l.statusText))}},l.send(null)})}class v extends c.BaseCMapReaderFactory{_fetchData(e,i){return j(e,this.isCompressed?"arraybuffer":"text").then(o=>({cMapData:o instanceof ArrayBuffer?new Uint8Array(o):(0,it.stringToBytes)(o),compressionType:i}))}}class $ extends c.BaseStandardFontDataFactory{_fetchData(e){return j(e,"arraybuffer").then(i=>new Uint8Array(i))}}class z extends c.BaseSVGFactory{_createSVG(e){return document.createElementNS(P,e)}}class A{constructor({viewBox:e,scale:i,rotation:o,offsetX:l=0,offsetY:g=0,dontFlip:_=!1}){this.viewBox=e,this.scale=i,this.rotation=o,this.offsetX=l,this.offsetY=g;const G=(e[2]+e[0])/2,w=(e[3]+e[1])/2;let r,u,I,at;switch(o%=360,o<0&&(o+=360),o){case 180:r=-1,u=0,I=0,at=1;break;case 90:r=0,u=1,I=1,at=0;break;case 270:r=0,u=-1,I=-1,at=0;break;case 0:r=1,u=0,I=0,at=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}_&&(I=-I,at=-at);let nt,st,gt,mt;r===0?(nt=Math.abs(w-e[1])*i+l,st=Math.abs(G-e[0])*i+g,gt=(e[3]-e[1])*i,mt=(e[2]-e[0])*i):(nt=Math.abs(G-e[0])*i+l,st=Math.abs(w-e[1])*i+g,gt=(e[2]-e[0])*i,mt=(e[3]-e[1])*i),this.transform=[r*i,u*i,I*i,at*i,nt-r*i*G-I*i*w,st-u*i*G-at*i*w],this.width=gt,this.height=mt}get rawDims(){const{viewBox:e}=this;return(0,it.shadow)(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:i=this.rotation,offsetX:o=this.offsetX,offsetY:l=this.offsetY,dontFlip:g=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:e,rotation:i,offsetX:o,offsetY:l,dontFlip:g})}convertToViewportPoint(e,i){return it.Util.applyTransform([e,i],this.transform)}convertToViewportRectangle(e){const i=it.Util.applyTransform([e[0],e[1]],this.transform),o=it.Util.applyTransform([e[2],e[3]],this.transform);return[i[0],i[1],o[0],o[1]]}convertToPdfPoint(e,i){return it.Util.applyInverseTransform([e,i],this.transform)}}class L extends it.BaseException{constructor(e,i=0){super(e,"RenderingCancelledException"),this.extraDelay=i}}function E(s){const e=s.length;let i=0;for(;i<e&&s[i].trim()==="";)i++;return s.substring(i,i+5).toLowerCase()==="data:"}function b(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function y(s,e=!1){return e||([s]=s.split(/[#?]/,1)),s.substring(s.lastIndexOf("/")+1)}function V(s,e="document.pdf"){if(typeof s!="string")return e;if(E(s))return(0,it.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,o=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=i.exec(s);let g=o.exec(l[1])||o.exec(l[2])||o.exec(l[3]);if(g&&(g=g[0],g.includes("%")))try{g=o.exec(decodeURIComponent(g))[0]}catch{}return g||e}class Y{constructor(){he(this,"started",Object.create(null));he(this,"times",[])}time(e){e in this.started&&(0,it.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,it.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let i=0;for(const{name:o}of this.times)i=Math.max(o.length,i);for(const{name:o,start:l,end:g}of this.times)e.push(`${o.padEnd(i)} ${g-l}ms
`);return e.join("")}}function M(s,e){try{const{protocol:i}=e?new URL(s,e):new URL(s);return i==="http:"||i==="https:"}catch{return!1}}function H(s){s.preventDefault()}let D;class B{static toDateObject(e){if(!e||typeof e!="string")return null;D||(D=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const i=D.exec(e);if(!i)return null;const o=parseInt(i[1],10);let l=parseInt(i[2],10);l=l>=1&&l<=12?l-1:0;let g=parseInt(i[3],10);g=g>=1&&g<=31?g:1;let _=parseInt(i[4],10);_=_>=0&&_<=23?_:0;let G=parseInt(i[5],10);G=G>=0&&G<=59?G:0;let w=parseInt(i[6],10);w=w>=0&&w<=59?w:0;const r=i[7]||"Z";let u=parseInt(i[8],10);u=u>=0&&u<=23?u:0;let I=parseInt(i[9],10)||0;return I=I>=0&&I<=59?I:0,r==="-"?(_+=u,G+=I):r==="+"&&(_-=u,G-=I),new Date(Date.UTC(o,l,g,_,G,w))}}function et(s,{scale:e=1,rotation:i=0}){const{width:o,height:l}=s.attributes.style,g=[0,0,parseInt(o),parseInt(l)];return new A({viewBox:g,scale:e,rotation:i})}function At(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):((0,it.warn)(`Not a valid color format: "${s}"`),[0,0,0])}function St(s){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const i of s.keys()){e.style.color=i;const o=window.getComputedStyle(e).color;s.set(i,At(o))}e.remove()}function Ct(s){const{a:e,b:i,c:o,d:l,e:g,f:_}=s.getTransform();return[e,i,o,l,g,_]}function qt(s){const{a:e,b:i,c:o,d:l,e:g,f:_}=s.getTransform().invertSelf();return[e,i,o,l,g,_]}function Yt(s,e,i=!1,o=!0){if(e instanceof A){const{pageWidth:l,pageHeight:g}=e.rawDims,{style:_}=s,G=it.FeatureTest.isCSSRoundSupported,w=`var(--scale-factor) * ${l}px`,r=`var(--scale-factor) * ${g}px`,u=G?`round(${w}, 1px)`:`calc(${w})`,I=G?`round(${r}, 1px)`:`calc(${r})`;!i||e.rotation%180===0?(_.width=u,_.height=I):(_.width=I,_.height=u)}o&&s.setAttribute("data-main-rotation",e.rotation)}},423:(Zt,Nt,lt)=>{var W,dt,X,j,Qs,$,Js,Zs;lt.d(Nt,{DrawLayer:()=>P});var c=lt(473),it=lt(266);const L=class L{constructor({pageIndex:b}){F(this,$);F(this,W,null);F(this,dt,0);F(this,X,new Map);this.pageIndex=b}setParent(b){if(!t(this,W)){R(this,W,b);return}if(t(this,W)!==b){if(t(this,X).size>0)for(const y of t(this,X).values())y.remove(),b.append(y);R(this,W,b)}}static get _svgFactory(){return(0,it.shadow)(this,"_svgFactory",new c.DOMSVGFactory)}highlight({outlines:b,box:y},V,Y){var Yt;const M=Be(this,dt)._++,H=x(this,$,Js).call(this,y);H.classList.add("highlight");const D=L._svgFactory.createElement("defs");H.append(D);const B=L._svgFactory.createElement("path");D.append(B);const et=`path_p${this.pageIndex}_${M}`;B.setAttribute("id",et),B.setAttribute("d",x(Yt=L,j,Zs).call(Yt,b));const At=L._svgFactory.createElement("clipPath");D.append(At);const St=`clip_${et}`;At.setAttribute("id",St),At.setAttribute("clipPathUnits","objectBoundingBox");const Ct=L._svgFactory.createElement("use");At.append(Ct),Ct.setAttribute("href",`#${et}`),Ct.classList.add("clip");const qt=L._svgFactory.createElement("use");return H.append(qt),H.setAttribute("fill",V),H.setAttribute("fill-opacity",Y),qt.setAttribute("href",`#${et}`),t(this,X).set(M,H),{id:M,clipPathId:`url(#${St})`}}highlightOutline({outlines:b,box:y}){var At;const V=Be(this,dt)._++,Y=x(this,$,Js).call(this,y);Y.classList.add("highlightOutline");const M=L._svgFactory.createElement("defs");Y.append(M);const H=L._svgFactory.createElement("path");M.append(H);const D=`path_p${this.pageIndex}_${V}`;H.setAttribute("id",D),H.setAttribute("d",x(At=L,j,Zs).call(At,b)),H.setAttribute("vector-effect","non-scaling-stroke");const B=L._svgFactory.createElement("use");Y.append(B),B.setAttribute("href",`#${D}`);const et=B.cloneNode();return Y.append(et),B.classList.add("mainOutline"),et.classList.add("secondaryOutline"),t(this,X).set(V,Y),V}updateBox(b,y){var V;x(V=L,j,Qs).call(V,t(this,X).get(b),y)}rotate(b,y){t(this,X).get(b).setAttribute("data-main-rotation",y)}changeColor(b,y){t(this,X).get(b).setAttribute("fill",y)}changeOpacity(b,y){t(this,X).get(b).setAttribute("fill-opacity",y)}addClass(b,y){t(this,X).get(b).classList.add(y)}removeClass(b,y){t(this,X).get(b).classList.remove(y)}remove(b){t(this,W)!==null&&(t(this,X).get(b).remove(),t(this,X).delete(b))}destroy(){R(this,W,null);for(const b of t(this,X).values())b.remove();t(this,X).clear()}};W=new WeakMap,dt=new WeakMap,X=new WeakMap,j=new WeakSet,Qs=function(b,{x:y,y:V,width:Y,height:M}){const{style:H}=b;H.top=`${100*V}%`,H.left=`${100*y}%`,H.width=`${100*Y}%`,H.height=`${100*M}%`},$=new WeakSet,Js=function(b){var V;const y=L._svgFactory.create(1,1,!0);return t(this,W).append(y),x(V=L,j,Qs).call(V,y,b),y},Zs=function(b){const y=[];for(const V of b){let[Y,M]=V;y.push(`M${Y} ${M}`);for(let H=2;H<V.length;H+=2){const D=V[H],B=V[H+1];D===Y?(y.push(`V${B}`),M=B):B===M&&(y.push(`H${D}`),Y=D)}y.push("Z")}return y.join(" ")},F(L,j);let P=L},629:(Zt,Nt,lt)=>{var E,b,y,V,Y,M,H,D,B,et,Hn,zn,jn,ds,ti,Vn,ei,Ut,jt,ee,$t,te,le,Wt,Qt,me,kt,Jt,si,$n,ii,Ps,ue,ni,Un,Gn,o,l,g,_,G,w,r,u,I,at,nt,st,gt,mt,Ft,a,qn,Wn,Xn,Kn,ai,Yn,ri,Qn,Jn,Zn,ta,ea,Ne,oi,ks,Ms,Ze,hi,Rs,U,sa,li,ia,na,ci,Fs,ts,wt,Ot,Vt,Mt,Lt,oe,ye,we,Se,Ee,Re,ce,us,ps,Is,di,aa,ra,ui,Ls,oa,$e,We,Le,ns,bs,as,De,rs,Ce,He,Xe,Ke,Oe,se,ze,xe,pi,gi,gs,mi,fi;lt.d(Nt,{AnnotationEditorLayer:()=>L});var c=lt(266),it=lt(115),P=lt(812),W=lt(640);const Bt=class Bt extends it.AnnotationEditor{constructor(n){super({...n,name:"freeTextEditor"});F(this,et);F(this,E,this.editorDivBlur.bind(this));F(this,b,this.editorDivFocus.bind(this));F(this,y,this.editorDivInput.bind(this));F(this,V,this.editorDivKeydown.bind(this));F(this,Y);F(this,M,"");F(this,H,`${this.id}-editor`);F(this,D);F(this,B,null);R(this,Y,n.color||Bt._defaultColor||it.AnnotationEditor._defaultLineColor),R(this,D,n.fontSize||Bt._defaultFontSize)}static get _keyboardManager(){const n=Bt.prototype,f=ht=>ht.isEmpty(),q=P.AnnotationEditorUIManager.TRANSLATE_SMALL,Z=P.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new P.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],n.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],n._translateEmpty,{args:[-q,0],checker:f}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],n._translateEmpty,{args:[-Z,0],checker:f}],[["ArrowRight","mac+ArrowRight"],n._translateEmpty,{args:[q,0],checker:f}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],n._translateEmpty,{args:[Z,0],checker:f}],[["ArrowUp","mac+ArrowUp"],n._translateEmpty,{args:[0,-q],checker:f}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],n._translateEmpty,{args:[0,-Z],checker:f}],[["ArrowDown","mac+ArrowDown"],n._translateEmpty,{args:[0,q],checker:f}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],n._translateEmpty,{args:[0,Z],checker:f}]]))}static initialize(n){it.AnnotationEditor.initialize(n,{strings:["pdfjs-free-text-default-content"]});const f=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(f.getPropertyValue("--freetext-padding"))}static updateDefaultParams(n,f){switch(n){case c.AnnotationEditorParamsType.FREETEXT_SIZE:Bt._defaultFontSize=f;break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:Bt._defaultColor=f;break}}updateParams(n,f){switch(n){case c.AnnotationEditorParamsType.FREETEXT_SIZE:x(this,et,Hn).call(this,f);break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:x(this,et,zn).call(this,f);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,Bt._defaultFontSize],[c.AnnotationEditorParamsType.FREETEXT_COLOR,Bt._defaultColor||it.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,D)],[c.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,Y)]]}_translateEmpty(n,f){this._uiManager.translateSelectedEditors(n,f,!0)}getInitialTranslation(){const n=this.parentScale;return[-Bt._internalPadding*n,-(Bt._internalPadding+t(this,D))*n]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(c.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,V)),this.editorDiv.addEventListener("focus",t(this,b)),this.editorDiv.addEventListener("blur",t(this,E)),this.editorDiv.addEventListener("input",t(this,y)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,H)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,V)),this.editorDiv.removeEventListener("focus",t(this,b)),this.editorDiv.removeEventListener("blur",t(this,E)),this.editorDiv.removeEventListener("input",t(this,y)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(n){this._focusEventsAllowed&&(super.focusin(n),n.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var n;if(this.width){x(this,et,ei).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const n=t(this,M),f=R(this,M,x(this,et,jn).call(this).trimEnd());if(n===f)return;const q=Z=>{if(R(this,M,Z),!Z){this.remove();return}x(this,et,ti).call(this),this._uiManager.rebuild(this),x(this,et,ds).call(this)};this.addCommands({cmd:()=>{q(f)},undo:()=>{q(n)},mustExec:!1}),x(this,et,ds).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(n){this.enterInEditMode()}keydown(n){n.target===this.div&&n.key==="Enter"&&(this.enterInEditMode(),n.preventDefault())}editorDivKeydown(n){Bt._keyboardManager.exec(this,n)}editorDivFocus(n){this.isEditing=!0}editorDivBlur(n){this.isEditing=!1}editorDivInput(n){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let n,f;this.width&&(n=this.x,f=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,H)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),it.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(Z=>{var ht;return(ht=this.editorDiv)==null?void 0:ht.setAttribute("default-content",Z)}),this.editorDiv.contentEditable=!0;const{style:q}=this.editorDiv;if(q.fontSize=`calc(${t(this,D)}px * var(--scale-factor))`,q.color=t(this,Y),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,P.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Z,ht]=this.parentDimensions;if(this.annotationElementId){const{position:xt}=t(this,B);let[Rt,pt]=this.getInitialTranslation();[Rt,pt]=this.pageTranslationToScreen(Rt,pt);const[Dt,zt]=this.pageDimensions,[re,de]=this.pageTranslation;let pe,ge;switch(this.rotation){case 0:pe=n+(xt[0]-re)/Dt,ge=f+this.height-(xt[1]-de)/zt;break;case 90:pe=n+(xt[0]-re)/Dt,ge=f-(xt[1]-de)/zt,[Rt,pt]=[pt,-Rt];break;case 180:pe=n-this.width+(xt[0]-re)/Dt,ge=f-(xt[1]-de)/zt,[Rt,pt]=[-Rt,-pt];break;case 270:pe=n+(xt[0]-re-this.height*zt)/Dt,ge=f+(xt[1]-de-this.width*Dt)/zt,[Rt,pt]=[-pt,Rt];break}this.setAt(pe*Z,ge*ht,Rt,pt)}else this.setAt(n*Z,f*ht,this.width*Z,this.height*ht);x(this,et,ti).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(n,f,q){let Z=null;if(n instanceof W.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:xt,fontColor:Rt},rect:pt,rotation:Dt,id:zt},textContent:re,textPosition:de,parent:{page:{pageNumber:pe}}}=n;if(!re||re.length===0)return null;Z=n={annotationType:c.AnnotationEditorType.FREETEXT,color:Array.from(Rt),fontSize:xt,value:re.join(`
`),position:de,pageIndex:pe-1,rect:pt,rotation:Dt,id:zt,deleted:!1}}const ht=super.deserialize(n,f,q);return R(ht,D,n.fontSize),R(ht,Y,c.Util.makeHexColor(...n.color)),R(ht,M,n.value),ht.annotationElementId=n.id||null,R(ht,B,Z),ht}serialize(n=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const f=Bt._internalPadding*this.parentScale,q=this.getRect(f,f),Z=it.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,Y)),ht={annotationType:c.AnnotationEditorType.FREETEXT,color:Z,fontSize:t(this,D),value:t(this,M),pageIndex:this.pageIndex,rect:q,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return n?ht:this.annotationElementId&&!x(this,et,Vn).call(this,ht)?null:(ht.id=this.annotationElementId,ht)}};E=new WeakMap,b=new WeakMap,y=new WeakMap,V=new WeakMap,Y=new WeakMap,M=new WeakMap,H=new WeakMap,D=new WeakMap,B=new WeakMap,et=new WeakSet,Hn=function(n){const f=Z=>{this.editorDiv.style.fontSize=`calc(${Z}px * var(--scale-factor))`,this.translate(0,-(Z-t(this,D))*this.parentScale),R(this,D,Z),x(this,et,ds).call(this)},q=t(this,D);this.addCommands({cmd:()=>{f(n)},undo:()=>{f(q)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},zn=function(n){const f=t(this,Y);this.addCommands({cmd:()=>{R(this,Y,this.editorDiv.style.color=n)},undo:()=>{R(this,Y,this.editorDiv.style.color=f)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},jn=function(){const n=this.editorDiv.getElementsByTagName("div");if(n.length===0)return this.editorDiv.innerText;const f=[];for(const q of n)f.push(q.innerText.replace(/\r\n?|\n/,""));return f.join(`
`)},ds=function(){const[n,f]=this.parentDimensions;let q;if(this.isAttachedToDOM)q=this.div.getBoundingClientRect();else{const{currentLayer:Z,div:ht}=this,xt=ht.style.display;ht.style.display="hidden",Z.div.append(this.div),q=ht.getBoundingClientRect(),ht.remove(),ht.style.display=xt}this.rotation%180===this.parentRotation%180?(this.width=q.width/n,this.height=q.height/f):(this.width=q.height/n,this.height=q.width/f),this.fixAndSetPosition()},ti=function(){if(this.editorDiv.replaceChildren(),!!t(this,M))for(const n of t(this,M).split(`
`)){const f=document.createElement("div");f.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(f)}},Vn=function(n){const{value:f,fontSize:q,color:Z,rect:ht,pageIndex:xt}=t(this,B);return n.value!==f||n.fontSize!==q||n.rect.some((Rt,pt)=>Math.abs(Rt-ht[pt])>=1)||n.color.some((Rt,pt)=>Rt!==Z[pt])||n.pageIndex!==xt},ei=function(n=!1){if(!this.annotationElementId)return;if(x(this,et,ds).call(this),!n&&(this.width===0||this.height===0)){setTimeout(()=>x(this,et,ei).call(this,!0),0);return}const f=Bt._internalPadding*this.parentScale;t(this,B).rect=this.getRect(f,f)},he(Bt,"_freeTextDefaultContent",""),he(Bt,"_internalPadding",0),he(Bt,"_defaultColor",null),he(Bt,"_defaultFontSize",10),he(Bt,"_type","freetext"),he(Bt,"_editorType",c.AnnotationEditorType.FREETEXT);let dt=Bt;var X=lt(97),j=lt(405);const i=class i extends it.AnnotationEditor{constructor(n){var f;super({...n,name:"highlightEditor"});F(this,Jt);F(this,Ut);F(this,jt,null);F(this,ee,null);F(this,$t,null);F(this,te,null);F(this,le,null);F(this,Wt,null);F(this,Qt,null);F(this,me);F(this,kt,null);i._defaultColor||(i._defaultColor=((f=this._uiManager.highlightColors)==null?void 0:f.values().next().value)||"#fff066"),this.color=n.color||i._defaultColor,R(this,me,n.opacity||i._defaultOpacity),R(this,Ut,n.boxes||null),this._isDraggable=!1,x(this,Jt,si).call(this),x(this,Jt,Ps).call(this),this.rotate(this.rotation)}static initialize(n){it.AnnotationEditor.initialize(n)}static updateDefaultParams(n,f){switch(n){case c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:i._defaultColor=f;break}}get toolbarPosition(){return t(this,Qt)}updateParams(n,f){switch(n){case c.AnnotationEditorParamsType.HIGHLIGHT_COLOR:x(this,Jt,$n).call(this,f);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,i._defaultColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||i._defaultColor]]}async addEditToolbar(){const n=await super.addEditToolbar();return n?(this._uiManager.highlightColors&&(R(this,ee,new X.ColorPicker({editor:this})),n.addColorPicker(t(this,ee))),n):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(0)}getRect(n,f){return super.getRect(n,f,0)}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){super.remove(),x(this,Jt,ii).call(this)}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,Jt,Ps).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(n){var q;let f=!1;this.parent&&!n?x(this,Jt,ii).call(this):n&&(x(this,Jt,Ps).call(this,n),f=!this.parent&&((q=this.div)==null?void 0:q.classList.contains("selectedEditor"))),super.setParent(n),f&&this.select()}rotate(n){var q,Z;const{drawLayer:f}=this.parent;f.rotate(t(this,Wt),n),f.rotate(t(this,kt),n),f.updateBox(t(this,Wt),x(q=i,ue,ni).call(q,this,n)),f.updateBox(t(this,kt),x(Z=i,ue,ni).call(Z,t(this,$t).box,n))}render(){if(this.div)return this.div;const n=super.render(),f=R(this,te,document.createElement("div"));n.append(f),f.className="internal",f.style.clipPath=t(this,jt);const[q,Z]=this.parentDimensions;return this.setDims(this.width*q,this.height*Z),(0,P.bindEvents)(this,t(this,te),["pointerover","pointerleave"]),this.enableEditing(),n}pointerover(){this.parent.drawLayer.addClass(t(this,kt),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,kt),"hovered")}select(){var n,f;super.select(),(n=this.parent)==null||n.drawLayer.removeClass(t(this,kt),"hovered"),(f=this.parent)==null||f.drawLayer.addClass(t(this,kt),"selected")}unselect(){var n;super.unselect(),(n=this.parent)==null||n.drawLayer.removeClass(t(this,kt),"selected")}static deserialize(n,f,q){var re;const Z=super.deserialize(n,f,q),{rect:ht,color:xt,quadPoints:Rt}=n;Z.color=c.Util.makeHexColor(...xt),R(Z,me,n.opacity);const[pt,Dt]=Z.pageDimensions;Z.width=(ht[2]-ht[0])/pt,Z.height=(ht[3]-ht[1])/Dt;const zt=R(Z,Ut,[]);for(let de=0;de<Rt.length;de+=8)zt.push({x:Rt[4]/pt,y:1-Rt[de+5]/Dt,width:(Rt[de+2]-Rt[de])/pt,height:(Rt[de+5]-Rt[de+1])/Dt});return x(re=Z,Jt,si).call(re),Z}serialize(n=!1){if(this.isEmpty()||n)return null;const f=this.getRect(0,0),q=it.AnnotationEditor._colorManager.convert(this.color);return{annotationType:c.AnnotationEditorType.HIGHLIGHT,color:q,opacity:t(this,me),quadPoints:x(this,Jt,Un).call(this),outlines:x(this,Jt,Gn).call(this),pageIndex:this.pageIndex,rect:f,rotation:0,structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};Ut=new WeakMap,jt=new WeakMap,ee=new WeakMap,$t=new WeakMap,te=new WeakMap,le=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,me=new WeakMap,kt=new WeakMap,Jt=new WeakSet,si=function(){const n=new j.Outliner(t(this,Ut),.001);R(this,le,n.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,le).box;const f=new j.Outliner(t(this,Ut),.0025,.001,this._uiManager.direction==="ltr");R(this,$t,f.getOutlines());const{lastPoint:q}=t(this,$t).box;R(this,Qt,[(q[0]-this.x)/this.width,(q[1]-this.y)/this.height])},$n=function(n){const f=this.color;this.addCommands({cmd:()=>{var q;this.color=n,this.parent.drawLayer.changeColor(t(this,Wt),n),(q=t(this,ee))==null||q.updateColor(n)},undo:()=>{var q;this.color=f,this.parent.drawLayer.changeColor(t(this,Wt),f),(q=t(this,ee))==null||q.updateColor(f)},mustExec:!0,type:c.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ii=function(){t(this,Wt)===null||!this.parent||(this.parent.drawLayer.remove(t(this,Wt)),R(this,Wt,null),this.parent.drawLayer.remove(t(this,kt)),R(this,kt,null))},Ps=function(n=this.parent){t(this,Wt)===null&&({id:Be(this,Wt)._,clipPathId:Be(this,jt)._}=n.drawLayer.highlight(t(this,le),this.color,t(this,me)),t(this,te)&&(t(this,te).style.clipPath=t(this,jt)),R(this,kt,n.drawLayer.highlightOutline(t(this,$t))))},ue=new WeakSet,ni=function({x:n,y:f,width:q,height:Z},ht){switch(ht){case 90:return{x:1-f-Z,y:n,width:Z,height:q};case 180:return{x:1-n-q,y:1-f-Z,width:q,height:Z};case 270:return{x:f,y:1-n-q,width:Z,height:q}}return{x:n,y:f,width:q,height:Z}},Un=function(){const[n,f]=this.pageDimensions,q=t(this,Ut),Z=new Array(q.length*8);let ht=0;for(const{x:xt,y:Rt,width:pt,height:Dt}of q){const zt=xt*n,re=(1-Rt-Dt)*f;Z[ht]=Z[ht+4]=zt,Z[ht+1]=Z[ht+3]=re,Z[ht+2]=Z[ht+6]=zt+pt*n,Z[ht+5]=Z[ht+7]=re+Dt*f,ht+=8}return Z},Gn=function(){const[n,f]=this.pageDimensions,q=this.width*n,Z=this.height*f,ht=this.x*n,xt=(1-this.y-this.height)*f,Rt=[];for(const pt of t(this,le).outlines){const Dt=new Array(pt.length);for(let zt=0;zt<pt.length;zt+=2)Dt[zt]=ht+pt[zt]*q,Dt[zt+1]=xt+(1-pt[zt+1])*Z;Rt.push(Dt)}return Rt},F(i,ue),he(i,"_defaultColor",null),he(i,"_defaultOpacity",1),he(i,"_l10nPromise"),he(i,"_type","highlight"),he(i,"_editorType",c.AnnotationEditorType.HIGHLIGHT);let v=i;var $=lt(473);const _t=class _t extends it.AnnotationEditor{constructor(n){super({...n,name:"inkEditor"});F(this,a);F(this,o,0);F(this,l,0);F(this,g,this.canvasPointermove.bind(this));F(this,_,this.canvasPointerleave.bind(this));F(this,G,this.canvasPointerup.bind(this));F(this,w,this.canvasPointerdown.bind(this));F(this,r,null);F(this,u,new Path2D);F(this,I,!1);F(this,at,!1);F(this,nt,!1);F(this,st,null);F(this,gt,0);F(this,mt,0);F(this,Ft,null);this.color=n.color||null,this.thickness=n.thickness||null,this.opacity=n.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(n){it.AnnotationEditor.initialize(n)}static updateDefaultParams(n,f){switch(n){case c.AnnotationEditorParamsType.INK_THICKNESS:_t._defaultThickness=f;break;case c.AnnotationEditorParamsType.INK_COLOR:_t._defaultColor=f;break;case c.AnnotationEditorParamsType.INK_OPACITY:_t._defaultOpacity=f/100;break}}updateParams(n,f){switch(n){case c.AnnotationEditorParamsType.INK_THICKNESS:x(this,a,qn).call(this,f);break;case c.AnnotationEditorParamsType.INK_COLOR:x(this,a,Wn).call(this,f);break;case c.AnnotationEditorParamsType.INK_OPACITY:x(this,a,Xn).call(this,f);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,_t._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,_t._defaultColor||it.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(_t._defaultOpacity*100)]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||_t._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,this.color||_t._defaultColor||it.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??_t._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(x(this,a,ks).call(this),x(this,a,Ms).call(this)),this.isAttachedToDOM||(this.parent.add(this),x(this,a,Ze).call(this)),x(this,a,ts).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,r)&&(clearTimeout(t(this,r)),R(this,r,null)),t(this,st).disconnect(),R(this,st,null),super.remove())}setParent(n){!this.parent&&n?this._uiManager.removeShouldRescale(this):this.parent&&n===null&&this._uiManager.addShouldRescale(this),super.setParent(n)}onScaleChanging(){const[n,f]=this.parentDimensions,q=this.width*n,Z=this.height*f;this.setDimensions(q,Z)}enableEditMode(){t(this,I)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,w)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,w)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,I)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),R(this,I,!0),this.div.classList.add("disabled"),x(this,a,ts).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(n){this._focusEventsAllowed&&(super.focusin(n),this.enableEditMode())}canvasPointerdown(n){n.button!==0||!this.isInEditMode()||t(this,I)||(this.setInForeground(),n.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),x(this,a,Yn).call(this,n.offsetX,n.offsetY))}canvasPointermove(n){n.preventDefault(),x(this,a,ri).call(this,n.offsetX,n.offsetY)}canvasPointerup(n){n.preventDefault(),x(this,a,oi).call(this,n)}canvasPointerleave(n){x(this,a,oi).call(this,n)}get isResizable(){return!this.isEmpty()&&t(this,I)}render(){if(this.div)return this.div;let n,f;this.width&&(n=this.x,f=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[q,Z,ht,xt]=x(this,a,Kn).call(this);if(this.setAt(q,Z,0,0),this.setDims(ht,xt),x(this,a,ks).call(this),this.width){const[Rt,pt]=this.parentDimensions;this.setAspectRatio(this.width*Rt,this.height*pt),this.setAt(n*Rt,f*pt,this.width*Rt,this.height*pt),R(this,nt,!0),x(this,a,Ze).call(this),this.setDims(this.width*Rt,this.height*pt),x(this,a,Ne).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return x(this,a,Ms).call(this),this.div}setDimensions(n,f){const q=Math.round(n),Z=Math.round(f);if(t(this,gt)===q&&t(this,mt)===Z)return;R(this,gt,q),R(this,mt,Z),this.canvas.style.visibility="hidden";const[ht,xt]=this.parentDimensions;this.width=n/ht,this.height=f/xt,this.fixAndSetPosition(),t(this,I)&&x(this,a,hi).call(this,n,f),x(this,a,Ze).call(this),x(this,a,Ne).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(n,f,q){var Ue,Fe,Ie;if(n instanceof W.InkAnnotationElement)return null;const Z=super.deserialize(n,f,q);Z.thickness=n.thickness,Z.color=c.Util.makeHexColor(...n.color),Z.opacity=n.opacity;const[ht,xt]=Z.pageDimensions,Rt=Z.width*ht,pt=Z.height*xt,Dt=Z.parentScale,zt=n.thickness/2;R(Z,I,!0),R(Z,gt,Math.round(Rt)),R(Z,mt,Math.round(pt));const{paths:re,rect:de,rotation:pe}=n;for(let{bezier:Te}of re){Te=x(Ue=_t,U,ia).call(Ue,Te,de,pe);const je=[];Z.paths.push(je);let os=Dt*(Te[0]-zt),hs=Dt*(Te[1]-zt);for(let Me=2,zs=Te.length;Me<zs;Me+=6){const js=Dt*(Te[Me]-zt),ys=Dt*(Te[Me+1]-zt),_s=Dt*(Te[Me+2]-zt),Ia=Dt*(Te[Me+3]-zt),Ni=Dt*(Te[Me+4]-zt),Hi=Dt*(Te[Me+5]-zt);je.push([[os,hs],[js,ys],[_s,Ia],[Ni,Hi]]),os=Ni,hs=Hi}const vs=x(this,U,sa).call(this,je);Z.bezierPath2D.push(vs)}const ge=x(Fe=Z,a,ci).call(Fe);return R(Z,l,Math.max(it.AnnotationEditor.MIN_SIZE,ge[2]-ge[0])),R(Z,o,Math.max(it.AnnotationEditor.MIN_SIZE,ge[3]-ge[1])),x(Ie=Z,a,hi).call(Ie,Rt,pt),Z}serialize(){if(this.isEmpty())return null;const n=this.getRect(0,0),f=it.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:c.AnnotationEditorType.INK,color:f,thickness:this.thickness,opacity:this.opacity,paths:x(this,a,na).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,n),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};o=new WeakMap,l=new WeakMap,g=new WeakMap,_=new WeakMap,G=new WeakMap,w=new WeakMap,r=new WeakMap,u=new WeakMap,I=new WeakMap,at=new WeakMap,nt=new WeakMap,st=new WeakMap,gt=new WeakMap,mt=new WeakMap,Ft=new WeakMap,a=new WeakSet,qn=function(n){const f=this.thickness;this.addCommands({cmd:()=>{this.thickness=n,x(this,a,ts).call(this)},undo:()=>{this.thickness=f,x(this,a,ts).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Wn=function(n){const f=this.color;this.addCommands({cmd:()=>{this.color=n,x(this,a,Ne).call(this)},undo:()=>{this.color=f,x(this,a,Ne).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Xn=function(n){n/=100;const f=this.opacity;this.addCommands({cmd:()=>{this.opacity=n,x(this,a,Ne).call(this)},undo:()=>{this.opacity=f,x(this,a,Ne).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Kn=function(){const{parentRotation:n,parentDimensions:[f,q]}=this;switch(n){case 90:return[0,q,q,f];case 180:return[f,q,f,q];case 270:return[f,0,q,f];default:return[0,0,f,q]}},ai=function(){const{ctx:n,color:f,opacity:q,thickness:Z,parentScale:ht,scaleFactor:xt}=this;n.lineWidth=Z*ht/xt,n.lineCap="round",n.lineJoin="round",n.miterLimit=10,n.strokeStyle=`${f}${(0,P.opacityToHex)(q)}`},Yn=function(n,f){this.canvas.addEventListener("contextmenu",$.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,_)),this.canvas.addEventListener("pointermove",t(this,g)),this.canvas.addEventListener("pointerup",t(this,G)),this.canvas.removeEventListener("pointerdown",t(this,w)),this.isEditing=!0,t(this,nt)||(R(this,nt,!0),x(this,a,Ze).call(this),this.thickness||(this.thickness=_t._defaultThickness),this.color||(this.color=_t._defaultColor||it.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=_t._defaultOpacity)),this.currentPath.push([n,f]),R(this,at,!1),x(this,a,ai).call(this),R(this,Ft,()=>{x(this,a,Zn).call(this),t(this,Ft)&&window.requestAnimationFrame(t(this,Ft))}),window.requestAnimationFrame(t(this,Ft))},ri=function(n,f){const[q,Z]=this.currentPath.at(-1);if(this.currentPath.length>1&&n===q&&f===Z)return;const ht=this.currentPath;let xt=t(this,u);if(ht.push([n,f]),R(this,at,!0),ht.length<=2){xt.moveTo(...ht[0]),xt.lineTo(n,f);return}ht.length===3&&(R(this,u,xt=new Path2D),xt.moveTo(...ht[0])),x(this,a,ta).call(this,xt,...ht.at(-3),...ht.at(-2),n,f)},Qn=function(){if(this.currentPath.length===0)return;const n=this.currentPath.at(-1);t(this,u).lineTo(...n)},Jn=function(n,f){R(this,Ft,null),n=Math.min(Math.max(n,0),this.canvas.width),f=Math.min(Math.max(f,0),this.canvas.height),x(this,a,ri).call(this,n,f),x(this,a,Qn).call(this);let q;if(this.currentPath.length!==1)q=x(this,a,ea).call(this);else{const pt=[n,f];q=[[pt,pt.slice(),pt.slice(),pt]]}const Z=t(this,u),ht=this.currentPath;this.currentPath=[],R(this,u,new Path2D);const xt=()=>{this.allRawPaths.push(ht),this.paths.push(q),this.bezierPath2D.push(Z),this.rebuild()},Rt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(x(this,a,ks).call(this),x(this,a,Ms).call(this)),x(this,a,ts).call(this))};this.addCommands({cmd:xt,undo:Rt,mustExec:!0})},Zn=function(){if(!t(this,at))return;R(this,at,!1);const n=Math.ceil(this.thickness*this.parentScale),f=this.currentPath.slice(-3),q=f.map(xt=>xt[0]),Z=f.map(xt=>xt[1]);Math.min(...q)-n,Math.max(...q)+n,Math.min(...Z)-n,Math.max(...Z)+n;const{ctx:ht}=this;ht.save(),ht.clearRect(0,0,this.canvas.width,this.canvas.height);for(const xt of this.bezierPath2D)ht.stroke(xt);ht.stroke(t(this,u)),ht.restore()},ta=function(n,f,q,Z,ht,xt,Rt){const pt=(f+Z)/2,Dt=(q+ht)/2,zt=(Z+xt)/2,re=(ht+Rt)/2;n.bezierCurveTo(pt+2*(Z-pt)/3,Dt+2*(ht-Dt)/3,zt+2*(Z-zt)/3,re+2*(ht-re)/3,zt,re)},ea=function(){const n=this.currentPath;if(n.length<=2)return[[n[0],n[0],n.at(-1),n.at(-1)]];const f=[];let q,[Z,ht]=n[0];for(q=1;q<n.length-2;q++){const[de,pe]=n[q],[ge,Ue]=n[q+1],Fe=(de+ge)/2,Ie=(pe+Ue)/2,Te=[Z+2*(de-Z)/3,ht+2*(pe-ht)/3],je=[Fe+2*(de-Fe)/3,Ie+2*(pe-Ie)/3];f.push([[Z,ht],Te,je,[Fe,Ie]]),[Z,ht]=[Fe,Ie]}const[xt,Rt]=n[q],[pt,Dt]=n[q+1],zt=[Z+2*(xt-Z)/3,ht+2*(Rt-ht)/3],re=[pt+2*(xt-pt)/3,Dt+2*(Rt-Dt)/3];return f.push([[Z,ht],zt,re,[pt,Dt]]),f},Ne=function(){if(this.isEmpty()){x(this,a,Rs).call(this);return}x(this,a,ai).call(this);const{canvas:n,ctx:f}=this;f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,n.width,n.height),x(this,a,Rs).call(this);for(const q of this.bezierPath2D)f.stroke(q)},oi=function(n){this.canvas.removeEventListener("pointerleave",t(this,_)),this.canvas.removeEventListener("pointermove",t(this,g)),this.canvas.removeEventListener("pointerup",t(this,G)),this.canvas.addEventListener("pointerdown",t(this,w)),t(this,r)&&clearTimeout(t(this,r)),R(this,r,setTimeout(()=>{R(this,r,null),this.canvas.removeEventListener("contextmenu",$.noContextMenu)},10)),x(this,a,Jn).call(this,n.offsetX,n.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ks=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ms=function(){R(this,st,new ResizeObserver(n=>{const f=n[0].contentRect;f.width&&f.height&&this.setDimensions(f.width,f.height)})),t(this,st).observe(this.div)},Ze=function(){if(!t(this,nt))return;const[n,f]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*n),this.canvas.height=Math.ceil(this.height*f),x(this,a,Rs).call(this)},hi=function(n,f){const q=x(this,a,Fs).call(this),Z=(n-q)/t(this,l),ht=(f-q)/t(this,o);this.scaleFactor=Math.min(Z,ht)},Rs=function(){const n=x(this,a,Fs).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+n,this.translationY*this.scaleFactor+n)},U=new WeakSet,sa=function(n){const f=new Path2D;for(let q=0,Z=n.length;q<Z;q++){const[ht,xt,Rt,pt]=n[q];q===0&&f.moveTo(...ht),f.bezierCurveTo(xt[0],xt[1],Rt[0],Rt[1],pt[0],pt[1])}return f},li=function(n,f,q){const[Z,ht,xt,Rt]=f;switch(q){case 0:for(let pt=0,Dt=n.length;pt<Dt;pt+=2)n[pt]+=Z,n[pt+1]=Rt-n[pt+1];break;case 90:for(let pt=0,Dt=n.length;pt<Dt;pt+=2){const zt=n[pt];n[pt]=n[pt+1]+Z,n[pt+1]=zt+ht}break;case 180:for(let pt=0,Dt=n.length;pt<Dt;pt+=2)n[pt]=xt-n[pt],n[pt+1]+=ht;break;case 270:for(let pt=0,Dt=n.length;pt<Dt;pt+=2){const zt=n[pt];n[pt]=xt-n[pt+1],n[pt+1]=Rt-zt}break;default:throw new Error("Invalid rotation")}return n},ia=function(n,f,q){const[Z,ht,xt,Rt]=f;switch(q){case 0:for(let pt=0,Dt=n.length;pt<Dt;pt+=2)n[pt]-=Z,n[pt+1]=Rt-n[pt+1];break;case 90:for(let pt=0,Dt=n.length;pt<Dt;pt+=2){const zt=n[pt];n[pt]=n[pt+1]-ht,n[pt+1]=zt-Z}break;case 180:for(let pt=0,Dt=n.length;pt<Dt;pt+=2)n[pt]=xt-n[pt],n[pt+1]-=ht;break;case 270:for(let pt=0,Dt=n.length;pt<Dt;pt+=2){const zt=n[pt];n[pt]=Rt-n[pt+1],n[pt+1]=xt-zt}break;default:throw new Error("Invalid rotation")}return n},na=function(n,f,q,Z){var Dt,zt;const ht=[],xt=this.thickness/2,Rt=n*f+xt,pt=n*q+xt;for(const re of this.paths){const de=[],pe=[];for(let ge=0,Ue=re.length;ge<Ue;ge++){const[Fe,Ie,Te,je]=re[ge],os=n*Fe[0]+Rt,hs=n*Fe[1]+pt,vs=n*Ie[0]+Rt,Me=n*Ie[1]+pt,zs=n*Te[0]+Rt,js=n*Te[1]+pt,ys=n*je[0]+Rt,_s=n*je[1]+pt;ge===0&&(de.push(os,hs),pe.push(os,hs)),de.push(vs,Me,zs,js,ys,_s),pe.push(vs,Me),ge===Ue-1&&pe.push(ys,_s)}ht.push({bezier:x(Dt=_t,U,li).call(Dt,de,Z,this.rotation),points:x(zt=_t,U,li).call(zt,pe,Z,this.rotation)})}return ht},ci=function(){let n=1/0,f=-1/0,q=1/0,Z=-1/0;for(const ht of this.paths)for(const[xt,Rt,pt,Dt]of ht){const zt=c.Util.bezierBoundingBox(...xt,...Rt,...pt,...Dt);n=Math.min(n,zt[0]),q=Math.min(q,zt[1]),f=Math.max(f,zt[2]),Z=Math.max(Z,zt[3])}return[n,q,f,Z]},Fs=function(){return t(this,I)?Math.ceil(this.thickness*this.parentScale):0},ts=function(n=!1){if(this.isEmpty())return;if(!t(this,I)){x(this,a,Ne).call(this);return}const f=x(this,a,ci).call(this),q=x(this,a,Fs).call(this);R(this,l,Math.max(it.AnnotationEditor.MIN_SIZE,f[2]-f[0])),R(this,o,Math.max(it.AnnotationEditor.MIN_SIZE,f[3]-f[1]));const Z=Math.ceil(q+t(this,l)*this.scaleFactor),ht=Math.ceil(q+t(this,o)*this.scaleFactor),[xt,Rt]=this.parentDimensions;this.width=Z/xt,this.height=ht/Rt,this.setAspectRatio(Z,ht);const pt=this.translationX,Dt=this.translationY;this.translationX=-f[0],this.translationY=-f[1],x(this,a,Ze).call(this),x(this,a,Ne).call(this),R(this,gt,Z),R(this,mt,ht),this.setDims(Z,ht);const zt=n?q/this.scaleFactor/2:0;this.translate(pt-this.translationX-zt,Dt-this.translationY-zt)},F(_t,U),he(_t,"_defaultColor",null),he(_t,"_defaultOpacity",1),he(_t,"_defaultThickness",1),he(_t,"_type","ink"),he(_t,"_editorType",c.AnnotationEditorType.INK);let z=_t;const is=class is extends it.AnnotationEditor{constructor(n){super({...n,name:"stampEditor"});F(this,ce);F(this,wt,null);F(this,Ot,null);F(this,Vt,null);F(this,Mt,null);F(this,Lt,null);F(this,oe,"");F(this,ye,null);F(this,we,null);F(this,Se,null);F(this,Ee,!1);F(this,Re,!1);R(this,Mt,n.bitmapUrl),R(this,Lt,n.bitmapFile)}static initialize(n){it.AnnotationEditor.initialize(n)}static get supportedTypes(){const n=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,c.shadow)(this,"supportedTypes",n.map(f=>`image/${f}`))}static get supportedTypesStr(){return(0,c.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(n){return this.supportedTypes.includes(n)}static paste(n,f){f.pasteEditor(c.AnnotationEditorType.STAMP,{bitmapFile:n.getAsFile()})}remove(){var n,f;t(this,Ot)&&(R(this,wt,null),this._uiManager.imageManager.deleteId(t(this,Ot)),(n=t(this,ye))==null||n.remove(),R(this,ye,null),(f=t(this,we))==null||f.disconnect(),R(this,we,null),t(this,Se)&&(clearTimeout(t(this,Se)),R(this,Se,null))),super.remove()}rebuild(){if(!this.parent){t(this,Ot)&&x(this,ce,Is).call(this);return}super.rebuild(),this.div!==null&&(t(this,Ot)&&x(this,ce,Is).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,Vt)||t(this,wt)||t(this,Mt)||t(this,Lt))}get isResizable(){return!0}render(){if(this.div)return this.div;let n,f;if(this.width&&(n=this.x,f=this.y),super.render(),this.div.hidden=!0,t(this,wt)?x(this,ce,di).call(this):x(this,ce,Is).call(this),this.width){const[q,Z]=this.parentDimensions;this.setAt(n*q,f*Z,this.width*q,this.height*Z)}return this.div}getImageForAltText(){return t(this,ye)}static deserialize(n,f,q){if(n instanceof W.StampAnnotationElement)return null;const Z=super.deserialize(n,f,q),{rect:ht,bitmapUrl:xt,bitmapId:Rt,isSvg:pt,accessibilityData:Dt}=n;Rt&&q.imageManager.isValidId(Rt)?R(Z,Ot,Rt):R(Z,Mt,xt),R(Z,Ee,pt);const[zt,re]=Z.pageDimensions;return Z.width=(ht[2]-ht[0])/zt,Z.height=(ht[3]-ht[1])/re,Dt&&(Z.altTextData=Dt),Z}serialize(n=!1,f=null){if(this.isEmpty())return null;const q={annotationType:c.AnnotationEditorType.STAMP,bitmapId:t(this,Ot),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,Ee),structTreeParentId:this._structTreeParentId};if(n)return q.bitmapUrl=x(this,ce,Ls).call(this,!0),q.accessibilityData=this.altTextData,q;const{decorative:Z,altText:ht}=this.altTextData;if(!Z&&ht&&(q.accessibilityData={type:"Figure",alt:ht}),f===null)return q;f.stamps||(f.stamps=new Map);const xt=t(this,Ee)?(q.rect[2]-q.rect[0])*(q.rect[3]-q.rect[1]):null;if(!f.stamps.has(t(this,Ot)))f.stamps.set(t(this,Ot),{area:xt,serialized:q}),q.bitmap=x(this,ce,Ls).call(this,!1);else if(t(this,Ee)){const Rt=f.stamps.get(t(this,Ot));xt>Rt.area&&(Rt.area=xt,Rt.serialized.bitmap.close(),Rt.serialized.bitmap=x(this,ce,Ls).call(this,!1))}return q}};wt=new WeakMap,Ot=new WeakMap,Vt=new WeakMap,Mt=new WeakMap,Lt=new WeakMap,oe=new WeakMap,ye=new WeakMap,we=new WeakMap,Se=new WeakMap,Ee=new WeakMap,Re=new WeakMap,ce=new WeakSet,us=function(n,f=!1){if(!n){this.remove();return}R(this,wt,n.bitmap),f||(R(this,Ot,n.id),R(this,Ee,n.isSvg)),n.file&&R(this,oe,n.file.name),x(this,ce,di).call(this)},ps=function(){R(this,Vt,null),this._uiManager.enableWaiting(!1),t(this,ye)&&this.div.focus()},Is=function(){if(t(this,Ot)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Ot)).then(f=>x(this,ce,us).call(this,f,!0)).finally(()=>x(this,ce,ps).call(this));return}if(t(this,Mt)){const f=t(this,Mt);R(this,Mt,null),this._uiManager.enableWaiting(!0),R(this,Vt,this._uiManager.imageManager.getFromUrl(f).then(q=>x(this,ce,us).call(this,q)).finally(()=>x(this,ce,ps).call(this)));return}if(t(this,Lt)){const f=t(this,Lt);R(this,Lt,null),this._uiManager.enableWaiting(!0),R(this,Vt,this._uiManager.imageManager.getFromFile(f).then(q=>x(this,ce,us).call(this,q)).finally(()=>x(this,ce,ps).call(this)));return}const n=document.createElement("input");n.type="file",n.accept=is.supportedTypesStr,R(this,Vt,new Promise(f=>{n.addEventListener("change",async()=>{if(!n.files||n.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const q=await this._uiManager.imageManager.getFromFile(n.files[0]);x(this,ce,us).call(this,q)}f()}),n.addEventListener("cancel",()=>{this.remove(),f()})}).finally(()=>x(this,ce,ps).call(this))),n.click()},di=function(){const{div:n}=this;let{width:f,height:q}=t(this,wt);const[Z,ht]=this.pageDimensions,xt=.75;if(this.width)f=this.width*Z,q=this.height*ht;else if(f>xt*Z||q>xt*ht){const zt=Math.min(xt*Z/f,xt*ht/q);f*=zt,q*=zt}const[Rt,pt]=this.parentDimensions;this.setDims(f*Rt/Z,q*pt/ht),this._uiManager.enableWaiting(!1);const Dt=R(this,ye,document.createElement("canvas"));n.append(Dt),n.hidden=!1,x(this,ce,ui).call(this,f,q),x(this,ce,oa).call(this),t(this,Re)||(this.parent.addUndoableEditor(this),R(this,Re,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton(),t(this,oe)&&Dt.setAttribute("aria-label",t(this,oe))},aa=function(n,f){var xt;const[q,Z]=this.parentDimensions;this.width=n/q,this.height=f/Z,this.setDims(n,f),(xt=this._initialOptions)!=null&&xt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,Se)!==null&&clearTimeout(t(this,Se)),R(this,Se,setTimeout(()=>{R(this,Se,null),x(this,ce,ui).call(this,n,f)},200))},ra=function(n,f){const{width:q,height:Z}=t(this,wt);let ht=q,xt=Z,Rt=t(this,wt);for(;ht>2*n||xt>2*f;){const pt=ht,Dt=xt;ht>2*n&&(ht=ht>=16384?Math.floor(ht/2)-1:Math.ceil(ht/2)),xt>2*f&&(xt=xt>=16384?Math.floor(xt/2)-1:Math.ceil(xt/2));const zt=new OffscreenCanvas(ht,xt);zt.getContext("2d").drawImage(Rt,0,0,pt,Dt,0,0,ht,xt),Rt=zt.transferToImageBitmap()}return Rt},ui=function(n,f){n=Math.ceil(n),f=Math.ceil(f);const q=t(this,ye);if(!q||q.width===n&&q.height===f)return;q.width=n,q.height=f;const Z=t(this,Ee)?t(this,wt):x(this,ce,ra).call(this,n,f),ht=q.getContext("2d");ht.filter=this._uiManager.hcmFilter,ht.drawImage(Z,0,0,Z.width,Z.height,0,0,n,f)},Ls=function(n){if(n){if(t(this,Ee)){const q=this._uiManager.imageManager.getSvgUrl(t(this,Ot));if(q)return q}const f=document.createElement("canvas");return{width:f.width,height:f.height}=t(this,wt),f.getContext("2d").drawImage(t(this,wt),0,0),f.toDataURL()}if(t(this,Ee)){const[f,q]=this.pageDimensions,Z=Math.round(this.width*f*$.PixelsPerInch.PDF_TO_CSS_UNITS),ht=Math.round(this.height*q*$.PixelsPerInch.PDF_TO_CSS_UNITS),xt=new OffscreenCanvas(Z,ht);return xt.getContext("2d").drawImage(t(this,wt),0,0,t(this,wt).width,t(this,wt).height,0,0,Z,ht),xt.transferToImageBitmap()}return structuredClone(t(this,wt))},oa=function(){R(this,we,new ResizeObserver(n=>{const f=n[0].contentRect;f.width&&f.height&&x(this,ce,aa).call(this,f.width,f.height)})),t(this,we).observe(this.div)},he(is,"_type","stamp"),he(is,"_editorType",c.AnnotationEditorType.STAMP);let A=is;const ke=class ke{constructor({uiManager:ot,pageIndex:n,div:f,accessibilityManager:q,annotationLayer:Z,drawLayer:ht,textLayer:xt,viewport:Rt,l10n:pt}){F(this,xe);F(this,$e);F(this,We,!1);F(this,Le,null);F(this,ns,this.pointerup.bind(this));F(this,bs,this.pointerUpAfterSelection.bind(this));F(this,as,this.pointerdown.bind(this));F(this,De,null);F(this,rs,this.selectionStart.bind(this));F(this,Ce,new Map);F(this,He,!1);F(this,Xe,!1);F(this,Ke,!1);F(this,Oe,null);F(this,se);const Dt=[...t(ke,ze).values()];if(!ke._initialized){ke._initialized=!0;for(const zt of Dt)zt.initialize(pt)}ot.registerEditorTypes(Dt),R(this,se,ot),this.pageIndex=n,this.div=f,R(this,$e,q),R(this,Le,Z),this.viewport=Rt,R(this,Oe,xt),this.drawLayer=ht,t(this,se).addLayer(this)}get isEmpty(){return t(this,Ce).size===0}updateToolbar(ot){t(this,se).updateToolbar(ot)}updateMode(ot=t(this,se).getMode()){switch(x(this,xe,fi).call(this),ot){case c.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;case c.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case c.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}if(ot!==c.AnnotationEditorType.NONE){const{classList:n}=this.div;for(const f of t(ke,ze).values())n.toggle(`${f._type}Editing`,ot===f._editorType);this.div.hidden=!1}}addInkEditorIfNeeded(ot){if(t(this,se).getMode()===c.AnnotationEditorType.INK){if(!ot){for(const n of t(this,Ce).values())if(n.isEmpty()){n.setInBackground();return}}x(this,xe,gs).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(ot){t(this,se).setEditingState(ot)}addCommands(ot){t(this,se).addCommands(ot)}togglePointerEvents(ot=!1){this.div.classList.toggle("disabled",!ot)}enable(){this.togglePointerEvents(!0);const ot=new Set;for(const f of t(this,Ce).values())f.enableEditing(),f.annotationElementId&&ot.add(f.annotationElementId);if(!t(this,Le))return;const n=t(this,Le).getEditableAnnotations();for(const f of n){if(f.hide(),t(this,se).isDeletedAnnotationElement(f.data.id)||ot.has(f.data.id))continue;const q=this.deserialize(f);q&&(this.addOrRebuild(q),q.enableEditing())}}disable(){var f;R(this,Ke,!0),this.togglePointerEvents(!1);const ot=new Set;for(const q of t(this,Ce).values()){if(q.disableEditing(),!q.annotationElementId||q.serialize()!==null){ot.add(q.annotationElementId);continue}(f=this.getEditableAnnotation(q.annotationElementId))==null||f.show(),q.remove()}if(t(this,Le)){const q=t(this,Le).getEditableAnnotations();for(const Z of q){const{id:ht}=Z.data;ot.has(ht)||t(this,se).isDeletedAnnotationElement(ht)||Z.show()}}x(this,xe,fi).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const q of t(ke,ze).values())n.remove(`${q._type}Editing`);this.disableTextSelection(),R(this,Ke,!1)}getEditableAnnotation(ot){var n;return((n=t(this,Le))==null?void 0:n.getEditableAnnotation(ot))||null}setActiveEditor(ot){t(this,se).getActive()!==ot&&t(this,se).setActiveEditor(ot)}enableTextSelection(){var ot;(ot=t(this,Oe))!=null&&ot.div&&document.addEventListener("selectstart",t(this,rs))}disableTextSelection(){var ot;(ot=t(this,Oe))!=null&&ot.div&&document.removeEventListener("selectstart",t(this,rs))}enableClick(){this.div.addEventListener("pointerdown",t(this,as)),this.div.addEventListener("pointerup",t(this,ns))}disableClick(){this.div.removeEventListener("pointerdown",t(this,as)),this.div.removeEventListener("pointerup",t(this,ns))}attach(ot){t(this,Ce).set(ot.id,ot);const{annotationElementId:n}=ot;n&&t(this,se).isDeletedAnnotationElement(n)&&t(this,se).removeDeletedAnnotationElement(ot)}detach(ot){var n;t(this,Ce).delete(ot.id),(n=t(this,$e))==null||n.removePointerInTextLayer(ot.contentDiv),!t(this,Ke)&&ot.annotationElementId&&t(this,se).addDeletedAnnotationElement(ot)}remove(ot){this.detach(ot),t(this,se).removeEditor(ot),ot.div.remove(),ot.isAttachedToDOM=!1,t(this,Xe)||this.addInkEditorIfNeeded(!1)}changeParent(ot){var n;ot.parent!==this&&(ot.annotationElementId&&(t(this,se).addDeletedAnnotationElement(ot.annotationElementId),it.AnnotationEditor.deleteAnnotationElement(ot),ot.annotationElementId=null),this.attach(ot),(n=ot.parent)==null||n.detach(ot),ot.setParent(this),ot.div&&ot.isAttachedToDOM&&(ot.div.remove(),this.div.append(ot.div)))}add(ot){if(this.changeParent(ot),t(this,se).addEditor(ot),this.attach(ot),!ot.isAttachedToDOM){const n=ot.render();this.div.append(n),ot.isAttachedToDOM=!0}ot.fixAndSetPosition(),ot.onceAdded(),t(this,se).addToAnnotationStorage(ot)}moveEditorInDOM(ot){var f;if(!ot.isAttachedToDOM)return;const{activeElement:n}=document;ot.div.contains(n)&&!t(this,De)&&(ot._focusEventsAllowed=!1,R(this,De,setTimeout(()=>{R(this,De,null),ot.div.contains(document.activeElement)?ot._focusEventsAllowed=!0:(ot.div.addEventListener("focusin",()=>{ot._focusEventsAllowed=!0},{once:!0}),n.focus())},0))),ot._structTreeParentId=(f=t(this,$e))==null?void 0:f.moveElementInDOM(this.div,ot.div,ot.contentDiv,!0)}addOrRebuild(ot){ot.needsToBeRebuilt()?(ot.parent||(ot.parent=this),ot.rebuild()):this.add(ot)}addUndoableEditor(ot){const n=()=>ot._uiManager.rebuild(ot),f=()=>{ot.remove()};this.addCommands({cmd:n,undo:f,mustExec:!1})}getNextId(){return t(this,se).getId()}canCreateNewEmptyEditor(){var ot;return(ot=t(this,xe,pi))==null?void 0:ot.canCreateNewEmptyEditor()}pasteEditor(ot,n){t(this,se).updateToolbar(ot),t(this,se).updateMode(ot);const{offsetX:f,offsetY:q}=x(this,xe,mi).call(this),Z=this.getNextId(),ht=x(this,xe,gi).call(this,{parent:this,id:Z,x:f,y:q,uiManager:t(this,se),isCentered:!0,...n});ht&&this.add(ht)}deserialize(ot){var n;return((n=t(ke,ze).get(ot.annotationType??ot.annotationEditorType))==null?void 0:n.deserialize(ot,this,t(this,se)))||null}addNewEditor(){x(this,xe,gs).call(this,x(this,xe,mi).call(this),!0)}setSelected(ot){t(this,se).setSelected(ot)}toggleSelected(ot){t(this,se).toggleSelected(ot)}isSelected(ot){return t(this,se).isSelected(ot)}unselect(ot){t(this,se).unselect(ot)}selectionStart(ot){var n;(n=t(this,Oe))==null||n.div.addEventListener("pointerup",t(this,bs),{once:!0})}pointerUpAfterSelection(ot){var zt;const n=document.getSelection();if(n.rangeCount===0)return;const f=n.getRangeAt(0);if(f.collapsed||!((zt=t(this,Oe))!=null&&zt.div.contains(f.commonAncestorContainer)))return;const{x:q,y:Z,width:ht,height:xt}=t(this,Oe).div.getBoundingClientRect(),Rt=f.getClientRects();let pt;switch(this.viewport.rotation){case 90:pt=(re,de,pe,ge)=>({x:(de-Z)/xt,y:1-(re+pe-q)/ht,width:ge/xt,height:pe/ht});break;case 180:pt=(re,de,pe,ge)=>({x:1-(re+pe-q)/ht,y:1-(de+ge-Z)/xt,width:pe/ht,height:ge/xt});break;case 270:pt=(re,de,pe,ge)=>({x:1-(de+ge-Z)/xt,y:(re-q)/ht,width:ge/xt,height:pe/ht});break;default:pt=(re,de,pe,ge)=>({x:(re-q)/ht,y:(de-Z)/xt,width:pe/ht,height:ge/xt});break}const Dt=[];for(const{x:re,y:de,width:pe,height:ge}of Rt)pe===0||ge===0||Dt.push(pt(re,de,pe,ge));Dt.length!==0&&x(this,xe,gs).call(this,ot,!1,{boxes:Dt}),n.empty()}pointerup(ot){const{isMac:n}=c.FeatureTest.platform;if(!(ot.button!==0||ot.ctrlKey&&n)&&ot.target===this.div&&t(this,He)){if(R(this,He,!1),!t(this,We)){R(this,We,!0);return}if(t(this,se).getMode()===c.AnnotationEditorType.STAMP){t(this,se).unselectAll();return}x(this,xe,gs).call(this,ot,!1)}}pointerdown(ot){if(t(this,se).getMode()===c.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,He)){R(this,He,!1);return}const{isMac:n}=c.FeatureTest.platform;if(ot.button!==0||ot.ctrlKey&&n||ot.target!==this.div)return;R(this,He,!0);const f=t(this,se).getActive();R(this,We,!f||f.isEmpty())}findNewParent(ot,n,f){const q=t(this,se).findParent(n,f);return q===null||q===this?!1:(q.changeParent(ot),!0)}destroy(){var ot,n;((ot=t(this,se).getActive())==null?void 0:ot.parent)===this&&(t(this,se).commitOrRemove(),t(this,se).setActiveEditor(null)),t(this,De)&&(clearTimeout(t(this,De)),R(this,De,null));for(const f of t(this,Ce).values())(n=t(this,$e))==null||n.removePointerInTextLayer(f.contentDiv),f.setParent(null),f.isAttachedToDOM=!1,f.div.remove();this.div=null,t(this,Ce).clear(),t(this,se).removeLayer(this)}render({viewport:ot}){this.viewport=ot,(0,$.setLayerDimensions)(this.div,ot);for(const n of t(this,se).getEditors(this.pageIndex))this.add(n);this.updateMode()}update({viewport:ot}){t(this,se).commitOrRemove();const n=this.viewport.rotation,f=ot.rotation;if(this.viewport=ot,(0,$.setLayerDimensions)(this.div,{rotation:f}),n!==f)for(const q of t(this,Ce).values())q.rotate(f);this.updateMode()}get pageDimensions(){const{pageWidth:ot,pageHeight:n}=this.viewport.rawDims;return[ot,n]}};$e=new WeakMap,We=new WeakMap,Le=new WeakMap,ns=new WeakMap,bs=new WeakMap,as=new WeakMap,De=new WeakMap,rs=new WeakMap,Ce=new WeakMap,He=new WeakMap,Xe=new WeakMap,Ke=new WeakMap,Oe=new WeakMap,se=new WeakMap,ze=new WeakMap,xe=new WeakSet,pi=function(){return t(ke,ze).get(t(this,se).getMode())},gi=function(ot){const n=t(this,xe,pi);return n?new n.prototype.constructor(ot):null},gs=function(ot,n,f={}){const q=this.getNextId(),Z=x(this,xe,gi).call(this,{parent:this,id:q,x:ot.offsetX,y:ot.offsetY,uiManager:t(this,se),isCentered:n,...f});return Z&&this.add(Z),Z},mi=function(){const{x:ot,y:n,width:f,height:q}=this.div.getBoundingClientRect(),Z=Math.max(0,ot),ht=Math.max(0,n),xt=Math.min(window.innerWidth,ot+f),Rt=Math.min(window.innerHeight,n+q),pt=(Z+xt)/2-ot,Dt=(ht+Rt)/2-n,[zt,re]=this.viewport.rotation%180===0?[pt,Dt]:[Dt,pt];return{offsetX:zt,offsetY:re}},fi=function(){R(this,Xe,!0);for(const ot of t(this,Ce).values())ot.isEmpty()&&ot.remove();R(this,Xe,!1)},he(ke,"_initialized",!1),F(ke,ze,new Map([dt,z,A,v].map(ot=>[ot._editorType,ot])));let L=ke},97:(Zt,Nt,lt)=>{var dt,X,j,v,$,z,A,L,E,b,Ai,bi,ha,la;lt.d(Nt,{ColorPicker:()=>W});var c=lt(266),it=lt(812),P=lt(473);const H=class H{constructor({editor:B=null,uiManager:et=null}){F(this,b);F(this,dt,x(this,b,ha).bind(this));F(this,X,null);F(this,j,null);F(this,v);F(this,$,null);F(this,z,!1);F(this,A,!1);F(this,L);F(this,E,null);var At;R(this,A,!B),R(this,E,(B==null?void 0:B._uiManager)||et),R(this,L,t(this,E)._eventBus),R(this,v,(B==null?void 0:B.color)||((At=t(this,E))==null?void 0:At.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,c.shadow)(this,"_keyboardManager",new it.KeyboardManager([[["Escape","mac+Escape"],H.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],H.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],H.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],H.prototype._moveToPrevious],[["Home","mac+Home"],H.prototype._moveToBeginning],[["End","mac+End"],H.prototype._moveToEnd]]))}renderButton(){const B=R(this,X,document.createElement("button"));B.className="colorPicker",B.tabIndex="0",B.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),B.setAttribute("aria-haspopup",!0),B.addEventListener("click",x(this,b,la).bind(this));const et=R(this,j,document.createElement("span"));return et.className="swatch",et.style.backgroundColor=t(this,v),B.append(et),B}renderMainDropdown(){const B=R(this,$,x(this,b,Ai).call(this,c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR));return B.setAttribute("aria-orientation","horizontal"),B.setAttribute("aria-labelledby","highlightColorPickerLabel"),B}_colorSelectFromKeyboard(B){const et=B.target.getAttribute("data-color");et&&x(this,b,bi).call(this,et,B)}_moveToNext(B){var et,At;if(B.target===t(this,X)){(et=t(this,$).firstChild)==null||et.focus();return}(At=B.target.nextSibling)==null||At.focus()}_moveToPrevious(B){var et;(et=B.target.previousSibling)==null||et.focus()}_moveToBeginning(){var B;(B=t(this,$).firstChild)==null||B.focus()}_moveToEnd(){var B;(B=t(this,$).lastChild)==null||B.focus()}hideDropdown(){var B;(B=t(this,$))==null||B.classList.add("hidden")}_hideDropdownFromKeyboard(){t(this,A)||!t(this,$)||t(this,$).classList.contains("hidden")||(this.hideDropdown(),t(this,X).removeEventListener("keydown",t(this,dt)),t(this,X).focus({preventScroll:!0,focusVisible:t(this,z)}))}updateColor(B){if(t(this,j)&&(t(this,j).style.backgroundColor=B),!t(this,$))return;const et=t(this,E).highlightColors.values();for(const At of t(this,$).children)At.setAttribute("aria-selected",et.next().value===B)}destroy(){var B,et;(B=t(this,X))==null||B.remove(),R(this,X,null),R(this,j,null),(et=t(this,$))==null||et.remove(),R(this,$,null)}};dt=new WeakMap,X=new WeakMap,j=new WeakMap,v=new WeakMap,$=new WeakMap,z=new WeakMap,A=new WeakMap,L=new WeakMap,E=new WeakMap,b=new WeakSet,Ai=function(B){const et=document.createElement("div");et.addEventListener("contextmenu",P.noContextMenu),et.className="dropdown",et.role="listbox",et.setAttribute("aria-multiselectable",!1),et.setAttribute("aria-orientation","vertical"),et.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[At,St]of t(this,E).highlightColors){const Ct=document.createElement("button");Ct.tabIndex="0",Ct.role="option",Ct.setAttribute("data-color",St),Ct.title=At,Ct.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${At}`);const qt=document.createElement("span");Ct.append(qt),qt.className="swatch",qt.style.backgroundColor=St,Ct.setAttribute("aria-selected",St===t(this,v)),Ct.addEventListener("click",x(this,b,bi).bind(this,B,St)),et.append(Ct)}return et.addEventListener("keydown",t(this,dt)),et},bi=function(B,et,At){At.stopPropagation(),t(this,L).dispatch("switchannotationeditorparams",{source:this,type:B,value:et})},ha=function(B){H._keyboardManager.exec(this,B)},la=function(B){if(t(this,$)&&!t(this,$).classList.contains("hidden")){this.hideDropdown();return}if(t(this,X).addEventListener("keydown",t(this,dt)),R(this,z,B.detail===0),t(this,$)){t(this,$).classList.remove("hidden");return}const et=R(this,$,x(this,b,Ai).call(this,c.AnnotationEditorParamsType.HIGHLIGHT_COLOR));t(this,X).append(et)};let W=H},115:(Zt,Nt,lt)=>{var v,$,z,A,L,E,b,y,vi,M,H,D,B,et,ca,St,da,ua,Ds,pa,yi,Ut,jt,ee,$t,te,le,Wt,Qt,me,kt,Jt,ne,be,_e,ae,ue,O,_i,Ei,i,xi,wi,ga,ma,Si,Ti,Ci,fa,Aa,ba,va,Pi,ms;lt.d(Nt,{AnnotationEditor:()=>X});var c=lt(812),it=lt(266),P=lt(473);const Y=class Y{constructor(a){F(this,y);F(this,v,"");F(this,$,!1);F(this,z,null);F(this,A,null);F(this,L,null);F(this,E,!1);F(this,b,null);R(this,b,a)}static initialize(a){Y._l10nPromise||(Y._l10nPromise=a)}async render(){const a=R(this,z,document.createElement("button"));a.className="altText";const N=await Y._l10nPromise.get("pdfjs-editor-alt-text-button-label");a.textContent=N,a.setAttribute("aria-label",N),a.tabIndex="0",a.addEventListener("contextmenu",P.noContextMenu),a.addEventListener("pointerdown",C=>C.stopPropagation());const J=C=>{C.preventDefault(),t(this,b)._uiManager.editAltText(t(this,b))};return a.addEventListener("click",J,{capture:!0}),a.addEventListener("keydown",C=>{C.target===a&&C.key==="Enter"&&(R(this,E,!0),J(C))}),await x(this,y,vi).call(this),a}finish(){t(this,z)&&(t(this,z).focus({focusVisible:t(this,E)}),R(this,E,!1))}get data(){return{altText:t(this,v),decorative:t(this,$)}}set data({altText:a,decorative:N}){t(this,v)===a&&t(this,$)===N||(R(this,v,a),R(this,$,N),x(this,y,vi).call(this))}toggle(a=!1){t(this,z)&&(!a&&t(this,L)&&(clearTimeout(t(this,L)),R(this,L,null)),t(this,z).disabled=!a)}destroy(){var a;(a=t(this,z))==null||a.remove(),R(this,z,null),R(this,A,null)}};v=new WeakMap,$=new WeakMap,z=new WeakMap,A=new WeakMap,L=new WeakMap,E=new WeakMap,b=new WeakMap,y=new WeakSet,vi=async function(){var J,C;const a=t(this,z);if(!a)return;if(!t(this,v)&&!t(this,$)){a.classList.remove("done"),(J=t(this,A))==null||J.remove();return}a.classList.add("done"),Y._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(d=>{a.setAttribute("aria-label",d)});let N=t(this,A);if(!N){R(this,A,N=document.createElement("span")),N.className="tooltip",N.setAttribute("role","tooltip");const d=N.id=`alt-text-tooltip-${t(this,b).id}`;a.setAttribute("aria-describedby",d);const T=100;a.addEventListener("mouseenter",()=>{R(this,L,setTimeout(()=>{R(this,L,null),t(this,A).classList.add("show"),t(this,b)._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:t(this,b).editorType,data:{action:"alt_text_tooltip"}}})},T))}),a.addEventListener("mouseleave",()=>{var k;t(this,L)&&(clearTimeout(t(this,L)),R(this,L,null)),(k=t(this,A))==null||k.classList.remove("show")})}N.innerText=t(this,$)?await Y._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,v),N.parentNode||a.append(N),(C=t(this,b).getImageForAltText())==null||C.setAttribute("aria-describedby",N.id)},he(Y,"_l10nPromise",null);let W=Y;const Bt=class Bt{constructor(a){F(this,St);F(this,M,null);F(this,H,null);F(this,D);F(this,B,null);R(this,D,a)}render(){const a=R(this,M,document.createElement("div"));a.className="editToolbar",a.addEventListener("contextmenu",P.noContextMenu),a.addEventListener("pointerdown",x(Bt,et,ca));const N=R(this,B,document.createElement("div"));N.className="buttons",a.append(N);const J=t(this,D).toolbarPosition;if(J){const{style:C}=a,d=t(this,D)._uiManager.direction==="ltr"?1-J[0]:J[0];C.insetInlineEnd=`${100*d}%`,C.top=`calc(${100*J[1]}% + var(--editor-toolbar-vert-offset))`}return x(this,St,pa).call(this),a}hide(){var a;t(this,M).classList.add("hidden"),(a=t(this,H))==null||a.hideDropdown()}show(){t(this,M).classList.remove("hidden")}addAltTextButton(a){x(this,St,Ds).call(this,a),t(this,B).prepend(a,t(this,St,yi))}addColorPicker(a){R(this,H,a);const N=a.renderButton();x(this,St,Ds).call(this,N),t(this,B).prepend(N,t(this,St,yi))}remove(){var a;t(this,M).remove(),(a=t(this,H))==null||a.destroy(),R(this,H,null)}};M=new WeakMap,H=new WeakMap,D=new WeakMap,B=new WeakMap,et=new WeakSet,ca=function(a){a.stopPropagation()},St=new WeakSet,da=function(a){t(this,D)._focusEventsAllowed=!1,a.preventDefault(),a.stopPropagation()},ua=function(a){t(this,D)._focusEventsAllowed=!0,a.preventDefault(),a.stopPropagation()},Ds=function(a){a.addEventListener("focusin",x(this,St,da).bind(this),{capture:!0}),a.addEventListener("focusout",x(this,St,ua).bind(this),{capture:!0}),a.addEventListener("contextmenu",P.noContextMenu)},pa=function(){const a=document.createElement("button");a.className="delete",a.tabIndex=0,a.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,D).editorType}-button`),x(this,St,Ds).call(this,a),a.addEventListener("click",N=>{t(this,D)._uiManager.delete()}),t(this,B).append(a)},yi=function(){const a=document.createElement("div");return a.className="divider",a},F(Bt,et);let dt=Bt;const mt=class mt{constructor(a){F(this,O);F(this,Ut,null);F(this,jt,null);F(this,ee,!1);F(this,$t,null);F(this,te,null);F(this,le,this.focusin.bind(this));F(this,Wt,this.focusout.bind(this));F(this,Qt,null);F(this,me,"");F(this,kt,!1);F(this,Jt,!1);F(this,ne,!1);F(this,be,!1);F(this,_e,null);he(this,"_initialOptions",Object.create(null));he(this,"_uiManager",null);he(this,"_focusEventsAllowed",!0);he(this,"_l10nPromise",null);F(this,ae,!1);F(this,ue,mt._zIndex++);this.constructor===mt&&(0,it.unreachable)("Cannot initialize AnnotationEditor."),this.parent=a.parent,this.id=a.id,this.width=this.height=null,this.pageIndex=a.parent.pageIndex,this.name=a.name,this.div=null,this._uiManager=a.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=a.isCentered,this._structTreeParentId=null;const{rotation:N,rawDims:{pageWidth:J,pageHeight:C,pageX:d,pageY:T}}=this.parent.viewport;this.rotation=N,this.pageRotation=(360+N-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[J,C],this.pageTranslation=[d,T];const[k,K]=this.parentDimensions;this.x=a.x/k,this.y=a.y/K,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const a=mt.prototype._resizeWithKeyboard,N=c.AnnotationEditorUIManager.TRANSLATE_SMALL,J=c.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,it.shadow)(this,"_resizerKeyboardManager",new c.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],a,{args:[-N,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],a,{args:[-J,0]}],[["ArrowRight","mac+ArrowRight"],a,{args:[N,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],a,{args:[J,0]}],[["ArrowUp","mac+ArrowUp"],a,{args:[0,-N]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],a,{args:[0,-J]}],[["ArrowDown","mac+ArrowDown"],a,{args:[0,N]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],a,{args:[0,J]}],[["Escape","mac+Escape"],mt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,it.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(a){const N=new j({id:a.parent.getNextId(),parent:a.parent,uiManager:a._uiManager});N.annotationElementId=a.annotationElementId,N.deleted=!0,N._uiManager.addToAnnotationStorage(N)}static initialize(a,N=null){if(mt._l10nPromise||(mt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(C=>[C,a.get(C.replaceAll(/([A-Z])/g,d=>`-${d.toLowerCase()}`))]))),N==null?void 0:N.strings)for(const C of N.strings)mt._l10nPromise.set(C,a.get(C));if(mt._borderLineWidth!==-1)return;const J=getComputedStyle(document.documentElement);mt._borderLineWidth=parseFloat(J.getPropertyValue("--outline-width"))||0}static updateDefaultParams(a,N){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(a){return!1}static paste(a,N){(0,it.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,ae)}set _isDraggable(a){var N;R(this,ae,a),(N=this.div)==null||N.classList.toggle("draggable",a)}get isEnterHandled(){return!0}center(){const[a,N]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*N/(a*2),this.y+=this.width*a/(N*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*N/(a*2),this.y-=this.width*a/(N*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(a){this._uiManager.addCommands(a)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,ue)}setParent(a){a!==null?(this.pageIndex=a.pageIndex,this.pageDimensions=a.pageDimensions):x(this,O,ms).call(this),this.parent=a}focusin(a){this._focusEventsAllowed&&(t(this,kt)?R(this,kt,!1):this.parent.setSelected(this))}focusout(a){var N,J;!this._focusEventsAllowed||!this.isAttachedToDOM||(N=a.relatedTarget)!=null&&N.closest(`#${this.id}`)||(a.preventDefault(),(J=this.parent)!=null&&J.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(a,N,J,C){const[d,T]=this.parentDimensions;[J,C]=this.screenToPageTranslation(J,C),this.x=(a+J)/d,this.y=(N+C)/T,this.fixAndSetPosition()}translate(a,N){x(this,O,_i).call(this,this.parentDimensions,a,N)}translateInPage(a,N){x(this,O,_i).call(this,this.pageDimensions,a,N),this.div.scrollIntoView({block:"nearest"})}drag(a,N){const[J,C]=this.parentDimensions;if(this.x+=a/J,this.y+=N/C,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:rt,y:vt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,rt,vt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:T}=this;const[k,K]=x(this,O,Ei).call(this);d+=k,T+=K,this.div.style.left=`${(100*d).toFixed(2)}%`,this.div.style.top=`${(100*T).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(a=this.rotation){const[N,J]=this.pageDimensions;let{x:C,y:d,width:T,height:k}=this;switch(T*=N,k*=J,C*=N,d*=J,a){case 0:C=Math.max(0,Math.min(N-T,C)),d=Math.max(0,Math.min(J-k,d));break;case 90:C=Math.max(0,Math.min(N-k,C)),d=Math.min(J,Math.max(T,d));break;case 180:C=Math.min(N,Math.max(T,C)),d=Math.min(J,Math.max(k,d));break;case 270:C=Math.min(N,Math.max(k,C)),d=Math.max(0,Math.min(J-T,d));break}this.x=C/=N,this.y=d/=J;const[K,rt]=x(this,O,Ei).call(this);C+=K,d+=rt;const{style:vt}=this.div;vt.left=`${(100*C).toFixed(2)}%`,vt.top=`${(100*d).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(a,N){var J;return x(J=mt,i,xi).call(J,a,N,this.parentRotation)}pageTranslationToScreen(a,N){var J;return x(J=mt,i,xi).call(J,a,N,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:a,pageDimensions:[N,J]}=this,C=N*a,d=J*a;return it.FeatureTest.isCSSRoundSupported?[Math.round(C),Math.round(d)]:[C,d]}setDims(a,N){const[J,C]=this.parentDimensions;this.div.style.width=`${(100*a/J).toFixed(2)}%`,t(this,ee)||(this.div.style.height=`${(100*N/C).toFixed(2)}%`)}fixDims(){const{style:a}=this.div,{height:N,width:J}=a,C=J.endsWith("%"),d=!t(this,ee)&&N.endsWith("%");if(C&&d)return;const[T,k]=this.parentDimensions;C||(a.width=`${(100*parseFloat(J)/T).toFixed(2)}%`),!t(this,ee)&&!d&&(a.height=`${(100*parseFloat(N)/k).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var a;(a=t(this,jt))==null||a.finish()}async addEditToolbar(){return t(this,Qt)||t(this,ne)?t(this,Qt):(R(this,Qt,new dt(this)),this.div.append(t(this,Qt).render()),t(this,jt)&&t(this,Qt).addAltTextButton(await t(this,jt).render()),t(this,Qt))}removeEditToolbar(){var a;t(this,Qt)&&(t(this,Qt).remove(),R(this,Qt,null),(a=t(this,jt))==null||a.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,jt)||(W.initialize(mt._l10nPromise),R(this,jt,new W(this)),await this.addEditToolbar())}get altTextData(){var a;return(a=t(this,jt))==null?void 0:a.data}set altTextData(a){t(this,jt)&&(t(this,jt).data=a)}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,le)),this.div.addEventListener("focusout",t(this,Wt));const[a,N]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*N/a).toFixed(2)}%`,this.div.style.maxHeight=`${(100*a/N).toFixed(2)}%`);const[J,C]=this.getInitialTranslation();return this.translate(J,C),(0,c.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(a){const{isMac:N}=it.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&N){a.preventDefault();return}if(R(this,kt,!0),this._isDraggable){x(this,O,fa).call(this,a);return}x(this,O,Ci).call(this,a)}moveInDOM(){t(this,_e)&&clearTimeout(t(this,_e)),R(this,_e,setTimeout(()=>{var a;R(this,_e,null),(a=this.parent)==null||a.moveEditorInDOM(this)},0))}_setParentAndPosition(a,N,J){a.changeParent(this),this.x=N,this.y=J,this.fixAndSetPosition()}getRect(a,N,J=this.rotation){const C=this.parentScale,[d,T]=this.pageDimensions,[k,K]=this.pageTranslation,rt=a/C,vt=N/C,ft=this.x*d,It=this.y*T,m=this.width*d,Q=this.height*T;switch(J){case 0:return[ft+rt+k,T-It-vt-Q+K,ft+rt+m+k,T-It-vt+K];case 90:return[ft+vt+k,T-It+rt+K,ft+vt+Q+k,T-It+rt+m+K];case 180:return[ft-rt-m+k,T-It+vt+K,ft-rt+k,T-It+vt+Q+K];case 270:return[ft-vt-Q+k,T-It-rt-m+K,ft-vt+k,T-It-rt+K];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(a,N){const[J,C,d,T]=a,k=d-J,K=T-C;switch(this.rotation){case 0:return[J,N-T,k,K];case 90:return[J,N-C,K,k];case 180:return[d,N-C,k,K];case 270:return[d,N-T,K,k];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){R(this,ne,!0)}disableEditMode(){R(this,ne,!1)}isInEditMode(){return t(this,ne)}shouldGetKeyboardEvents(){return t(this,be)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var a,N;(a=this.div)==null||a.addEventListener("focusin",t(this,le)),(N=this.div)==null||N.addEventListener("focusout",t(this,Wt))}rotate(a){}serialize(a=!1,N=null){(0,it.unreachable)("An editor must be serializable")}static deserialize(a,N,J){const C=new this.prototype.constructor({parent:N,id:N.getNextId(),uiManager:J});C.rotation=a.rotation;const[d,T]=C.pageDimensions,[k,K,rt,vt]=C.getRectInCurrentCoords(a.rect,T);return C.x=k/d,C.y=K/T,C.width=rt/d,C.height=vt/T,C}remove(){this.div.removeEventListener("focusin",t(this,le)),this.div.removeEventListener("focusout",t(this,Wt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,_e)&&(clearTimeout(t(this,_e)),R(this,_e,null)),x(this,O,ms).call(this),this.removeEditToolbar()}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,O,ga).call(this),t(this,$t).classList.remove("hidden"),(0,c.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(a){if(!this.isResizable||a.target!==this.div||a.key!=="Enter")return;this._uiManager.setSelected(this),R(this,te,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const N=t(this,$t).children;if(!t(this,Ut)){R(this,Ut,Array.from(N));const T=x(this,O,Aa).bind(this),k=x(this,O,ba).bind(this);for(const K of t(this,Ut)){const rt=K.getAttribute("data-resizer-name");K.setAttribute("role","spinbutton"),K.addEventListener("keydown",T),K.addEventListener("blur",k),K.addEventListener("focus",x(this,O,va).bind(this,rt)),mt._l10nPromise.get(`pdfjs-editor-resizer-label-${rt}`).then(vt=>K.setAttribute("aria-label",vt))}}const J=t(this,Ut)[0];let C=0;for(const T of N){if(T===J)break;C++}const d=(360-this.rotation+this.parentRotation)%360/90*(t(this,Ut).length/4);if(d!==C){if(d<C)for(let k=0;k<C-d;k++)t(this,$t).append(t(this,$t).firstChild);else if(d>C)for(let k=0;k<d-C;k++)t(this,$t).firstChild.before(t(this,$t).lastChild);let T=0;for(const k of N){const K=t(this,Ut)[T++].getAttribute("data-resizer-name");mt._l10nPromise.get(`pdfjs-editor-resizer-label-${K}`).then(rt=>k.setAttribute("aria-label",rt))}}x(this,O,Pi).call(this,0),R(this,be,!0),t(this,$t).firstChild.focus({focusVisible:!0}),a.preventDefault(),a.stopImmediatePropagation()}_resizeWithKeyboard(a,N){t(this,be)&&x(this,O,Ti).call(this,t(this,me),{movementX:a,movementY:N})}_stopResizingWithKeyboard(){x(this,O,ms).call(this),this.div.focus()}select(){var a,N;if(this.makeResizable(),(a=this.div)==null||a.classList.add("selectedEditor"),!t(this,Qt)){this.addEditToolbar().then(()=>{var J,C;(J=this.div)!=null&&J.classList.contains("selectedEditor")&&((C=t(this,Qt))==null||C.show())});return}(N=t(this,Qt))==null||N.show()}unselect(){var a,N,J,C;(a=t(this,$t))==null||a.classList.add("hidden"),(N=this.div)==null||N.classList.remove("selectedEditor"),(J=this.div)!=null&&J.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus(),(C=t(this,Qt))==null||C.hide()}updateParams(a,N){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Jt)}set isEditing(a){R(this,Jt,a),this.parent&&(a?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(a,N){R(this,ee,!0);const J=a/N,{style:C}=this.div;C.aspectRatio=J,C.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}};Ut=new WeakMap,jt=new WeakMap,ee=new WeakMap,$t=new WeakMap,te=new WeakMap,le=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,me=new WeakMap,kt=new WeakMap,Jt=new WeakMap,ne=new WeakMap,be=new WeakMap,_e=new WeakMap,ae=new WeakMap,ue=new WeakMap,O=new WeakSet,_i=function([a,N],J,C){[J,C]=this.screenToPageTranslation(J,C),this.x+=J/a,this.y+=C/N,this.fixAndSetPosition()},Ei=function(){const[a,N]=this.parentDimensions,{_borderLineWidth:J}=mt,C=J/a,d=J/N;switch(this.rotation){case 90:return[-C,d];case 180:return[C,d];case 270:return[C,-d];default:return[-C,-d]}},i=new WeakSet,xi=function(a,N,J){switch(J){case 90:return[N,-a];case 180:return[-a,-N];case 270:return[-N,a];default:return[a,N]}},wi=function(a){switch(a){case 90:{const[N,J]=this.pageDimensions;return[0,-N/J,J/N,0]}case 180:return[-1,0,0,-1];case 270:{const[N,J]=this.pageDimensions;return[0,N/J,-J/N,0]}default:return[1,0,0,1]}},ga=function(){if(t(this,$t))return;R(this,$t,document.createElement("div")),t(this,$t).classList.add("resizers");const a=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const N of a){const J=document.createElement("div");t(this,$t).append(J),J.classList.add("resizer",N),J.setAttribute("data-resizer-name",N),J.addEventListener("pointerdown",x(this,O,ma).bind(this,N)),J.addEventListener("contextmenu",P.noContextMenu),J.tabIndex=-1}this.div.prepend(t(this,$t))},ma=function(a,N){var Q;N.preventDefault();const{isMac:J}=it.FeatureTest.platform;if(N.button!==0||N.ctrlKey&&J)return;(Q=t(this,jt))==null||Q.toggle(!1);const C=x(this,O,Ti).bind(this,a),d=this._isDraggable;this._isDraggable=!1;const T={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C,T);const k=this.x,K=this.y,rt=this.width,vt=this.height,ft=this.parent.div.style.cursor,It=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(N.target).cursor;const m=()=>{var Et;this.parent.togglePointerEvents(!0),(Et=t(this,jt))==null||Et.toggle(!0),this._isDraggable=d,window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),window.removeEventListener("pointermove",C,T),this.parent.div.style.cursor=ft,this.div.style.cursor=It,x(this,O,Si).call(this,k,K,rt,vt)};window.addEventListener("pointerup",m),window.addEventListener("blur",m)},Si=function(a,N,J,C){const d=this.x,T=this.y,k=this.width,K=this.height;d===a&&T===N&&k===J&&K===C||this.addCommands({cmd:()=>{this.width=k,this.height=K,this.x=d,this.y=T;const[rt,vt]=this.parentDimensions;this.setDims(rt*k,vt*K),this.fixAndSetPosition()},undo:()=>{this.width=J,this.height=C,this.x=a,this.y=N;const[rt,vt]=this.parentDimensions;this.setDims(rt*J,vt*C),this.fixAndSetPosition()},mustExec:!0})},Ti=function(a,N){const[J,C]=this.parentDimensions,d=this.x,T=this.y,k=this.width,K=this.height,rt=mt.MIN_SIZE/J,vt=mt.MIN_SIZE/C,ft=Mt=>Math.round(Mt*1e4)/1e4,It=x(this,O,wi).call(this,this.rotation),m=(Mt,Lt)=>[It[0]*Mt+It[2]*Lt,It[1]*Mt+It[3]*Lt],Q=x(this,O,wi).call(this,360-this.rotation),Et=(Mt,Lt)=>[Q[0]*Mt+Q[2]*Lt,Q[1]*Mt+Q[3]*Lt];let yt,bt,p=!1,h=!1;switch(a){case"topLeft":p=!0,yt=(Mt,Lt)=>[0,0],bt=(Mt,Lt)=>[Mt,Lt];break;case"topMiddle":yt=(Mt,Lt)=>[Mt/2,0],bt=(Mt,Lt)=>[Mt/2,Lt];break;case"topRight":p=!0,yt=(Mt,Lt)=>[Mt,0],bt=(Mt,Lt)=>[0,Lt];break;case"middleRight":h=!0,yt=(Mt,Lt)=>[Mt,Lt/2],bt=(Mt,Lt)=>[0,Lt/2];break;case"bottomRight":p=!0,yt=(Mt,Lt)=>[Mt,Lt],bt=(Mt,Lt)=>[0,0];break;case"bottomMiddle":yt=(Mt,Lt)=>[Mt/2,Lt],bt=(Mt,Lt)=>[Mt/2,0];break;case"bottomLeft":p=!0,yt=(Mt,Lt)=>[0,Lt],bt=(Mt,Lt)=>[Mt,0];break;case"middleLeft":h=!0,yt=(Mt,Lt)=>[0,Lt/2],bt=(Mt,Lt)=>[Mt,Lt/2];break}const S=yt(k,K),U=bt(k,K);let tt=m(...U);const ct=ft(d+tt[0]),ut=ft(T+tt[1]);let Tt=1,Ht=1,[Pt,Gt]=this.screenToPageTranslation(N.movementX,N.movementY);if([Pt,Gt]=Et(Pt/J,Gt/C),p){const Mt=Math.hypot(k,K);Tt=Ht=Math.max(Math.min(Math.hypot(U[0]-S[0]-Pt,U[1]-S[1]-Gt)/Mt,1/k,1/K),rt/k,vt/K)}else h?Tt=Math.max(rt,Math.min(1,Math.abs(U[0]-S[0]-Pt)))/k:Ht=Math.max(vt,Math.min(1,Math.abs(U[1]-S[1]-Gt)))/K;const _t=ft(k*Tt),wt=ft(K*Ht);tt=m(...bt(_t,wt));const Ot=ct-tt[0],Vt=ut-tt[1];this.width=_t,this.height=wt,this.x=Ot,this.y=Vt,this.setDims(J*_t,C*wt),this.fixAndSetPosition()},Ci=function(a){const{isMac:N}=it.FeatureTest.platform;a.ctrlKey&&!N||a.shiftKey||a.metaKey&&N?this.parent.toggleSelected(this):this.parent.setSelected(this)},fa=function(a){const N=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let J,C;N&&(J={passive:!0,capture:!0},C=T=>{const[k,K]=this.screenToPageTranslation(T.movementX,T.movementY);this._uiManager.dragSelectedEditors(k,K)},window.addEventListener("pointermove",C,J));const d=()=>{window.removeEventListener("pointerup",d),window.removeEventListener("blur",d),N&&window.removeEventListener("pointermove",C,J),R(this,kt,!1),this._uiManager.endDragSession()||x(this,O,Ci).call(this,a)};window.addEventListener("pointerup",d),window.addEventListener("blur",d)},Aa=function(a){mt._resizerKeyboardManager.exec(this,a)},ba=function(a){var N;t(this,be)&&((N=a.relatedTarget)==null?void 0:N.parentNode)!==t(this,$t)&&x(this,O,ms).call(this)},va=function(a){R(this,me,t(this,be)?a:"")},Pi=function(a){if(t(this,Ut))for(const N of t(this,Ut))N.tabIndex=a},ms=function(){if(R(this,be,!1),x(this,O,Pi).call(this,-1),t(this,te)){const{savedX:a,savedY:N,savedWidth:J,savedHeight:C}=t(this,te);x(this,O,Si).call(this,a,N,J,C),R(this,te,null)}},F(mt,i),he(mt,"_borderLineWidth",-1),he(mt,"_colorManager",new c.ColorManager),he(mt,"_zIndex",1);let X=mt;class j extends X{constructor(a){super(a),this.annotationElementId=a.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},405:(Zt,Nt,lt)=>{var it,P,W,dt,ya,Os,_a,Ea,ki;lt.d(Nt,{Outliner:()=>c});class c{constructor(L,E=0,b=0,y=!0){F(this,dt);F(this,it);F(this,P,[]);F(this,W,[]);let V=1/0,Y=-1/0,M=1/0,H=-1/0;const D=10**-4;for(const{x:Yt,y:ie,width:Kt,height:Bt}of L){const Ut=Math.floor((Yt-E)/D)*D,jt=Math.ceil((Yt+Kt+E)/D)*D,ee=Math.floor((ie-E)/D)*D,$t=Math.ceil((ie+Bt+E)/D)*D,te=[Ut,ee,$t,!0],le=[jt,ee,$t,!1];t(this,P).push(te,le),V=Math.min(V,Ut),Y=Math.max(Y,jt),M=Math.min(M,ee),H=Math.max(H,$t)}const B=Y-V+2*b,et=H-M+2*b,At=V-b,St=M-b,Ct=t(this,P).at(y?-1:-2),qt=[Ct[0],Ct[2]];for(const Yt of t(this,P)){const[ie,Kt,Bt]=Yt;Yt[0]=(ie-At)/B,Yt[1]=(Kt-St)/et,Yt[2]=(Bt-St)/et}R(this,it,{x:At,y:St,width:B,height:et,lastPoint:qt})}getOutlines(){t(this,P).sort((E,b)=>E[0]-b[0]||E[1]-b[1]||E[2]-b[2]);const L=[];for(const E of t(this,P))E[3]?(L.push(...x(this,dt,ki).call(this,E)),x(this,dt,_a).call(this,E)):(x(this,dt,Ea).call(this,E),L.push(...x(this,dt,ki).call(this,E)));return x(this,dt,ya).call(this,L)}}it=new WeakMap,P=new WeakMap,W=new WeakMap,dt=new WeakSet,ya=function(L){const E=[],b=new Set;for(const Y of L){const[M,H,D]=Y;E.push([M,H,Y],[M,D,Y])}E.sort((Y,M)=>Y[1]-M[1]||Y[0]-M[0]);for(let Y=0,M=E.length;Y<M;Y+=2){const H=E[Y][2],D=E[Y+1][2];H.push(D),D.push(H),b.add(H),b.add(D)}const y=[];let V;for(;b.size>0;){const Y=b.values().next().value;let[M,H,D,B,et]=Y;b.delete(Y);let At=M,St=H;for(V=[M,D],y.push(V);;){let Ct;if(b.has(B))Ct=B;else if(b.has(et))Ct=et;else break;b.delete(Ct),[M,H,D,B,et]=Ct,At!==M&&(V.push(At,St,M,St===H?H:D),At=M),St=St===H?D:H}V.push(At,St)}return{outlines:y,box:t(this,it)}},Os=function(L){const E=t(this,W);let b=0,y=E.length-1;for(;b<=y;){const V=b+y>>1,Y=E[V][0];if(Y===L)return V;Y<L?b=V+1:y=V-1}return y+1},_a=function([,L,E]){const b=x(this,dt,Os).call(this,L);t(this,W).splice(b,0,[L,E])},Ea=function([,L,E]){const b=x(this,dt,Os).call(this,L);for(let y=b;y<t(this,W).length;y++){const[V,Y]=t(this,W)[y];if(V!==L)break;if(V===L&&Y===E){t(this,W).splice(y,1);return}}for(let y=b-1;y>=0;y--){const[V,Y]=t(this,W)[y];if(V!==L)break;if(V===L&&Y===E){t(this,W).splice(y,1);return}}},ki=function(L){const[E,b,y]=L,V=[[E,b,y]],Y=x(this,dt,Os).call(this,y);for(let M=0;M<Y;M++){const[H,D]=t(this,W)[M];for(let B=0,et=V.length;B<et;B++){const[,At,St]=V[B];if(!(D<=At||St<=H)){if(At>=H){if(St>D)V[B][1]=D;else{if(et===1)return[];V.splice(B,1),B--,et--}continue}V[B][2]=H,St>D&&V.push([E,D,St])}}}return V}},812:(Zt,Nt,lt)=>{var A,L,E,b,y,Mi,M,H,D,B,et,xa,Ct,qt,Yt,ie,Kt,Bt,Ut,jt,ee,$t,te,le,Wt,Qt,me,kt,Jt,ne,be,_e,ae,ue,O,s,e,i,o,l,g,_,G,w,r,u,I,at,nt,st,wa,Ri,Fi,Bs,Ii,Li,Pe,fs,Sa,Ta,Di,As,Oi;lt.d(Nt,{AnnotationEditorUIManager:()=>z,ColorManager:()=>$,KeyboardManager:()=>v,bindEvents:()=>P,opacityToHex:()=>W});var c=lt(266),it=lt(473);function P(It,m,Q){for(const Et of Q)m.addEventListener(Et,It[Et].bind(It))}function W(It){return Math.round(Math.min(255,Math.max(1,255*It))).toString(16).padStart(2,"0")}class dt{constructor(){F(this,A,0)}getId(){return`${c.AnnotationEditorPrefix}${Be(this,A)._++}`}}A=new WeakMap;const Y=class Y{constructor(){F(this,y);F(this,L,(0,c.getUuid)());F(this,E,0);F(this,b,null)}static get _isSVGFittingCanvas(){const m='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Q=new OffscreenCanvas(1,3).getContext("2d"),Et=new Image;Et.src=m;const yt=Et.decode().then(()=>(Q.drawImage(Et,0,0,1,1,0,0,1,3),new Uint32Array(Q.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,c.shadow)(this,"_isSVGFittingCanvas",yt)}async getFromFile(m){const{lastModified:Q,name:Et,size:yt,type:bt}=m;return x(this,y,Mi).call(this,`${Q}_${Et}_${yt}_${bt}`,m)}async getFromUrl(m){return x(this,y,Mi).call(this,m,m)}async getFromId(m){t(this,b)||R(this,b,new Map);const Q=t(this,b).get(m);return Q?Q.bitmap?(Q.refCounter+=1,Q):Q.file?this.getFromFile(Q.file):this.getFromUrl(Q.url):null}getSvgUrl(m){const Q=t(this,b).get(m);return Q!=null&&Q.isSvg?Q.svgUrl:null}deleteId(m){t(this,b)||R(this,b,new Map);const Q=t(this,b).get(m);Q&&(Q.refCounter-=1,Q.refCounter===0&&(Q.bitmap=null))}isValidId(m){return m.startsWith(`image_${t(this,L)}_`)}};L=new WeakMap,E=new WeakMap,b=new WeakMap,y=new WeakSet,Mi=async function(m,Q){t(this,b)||R(this,b,new Map);let Et=t(this,b).get(m);if(Et===null)return null;if(Et!=null&&Et.bitmap)return Et.refCounter+=1,Et;try{Et||(Et={bitmap:null,id:`image_${t(this,L)}_${Be(this,E)._++}`,refCounter:0,isSvg:!1});let yt;if(typeof Q=="string"?(Et.url=Q,yt=await(0,it.fetchData)(Q,"blob")):yt=Et.file=Q,yt.type==="image/svg+xml"){const bt=Y._isSVGFittingCanvas,p=new FileReader,h=new Image,S=new Promise((U,tt)=>{h.onload=()=>{Et.bitmap=h,Et.isSvg=!0,U()},p.onload=async()=>{const ct=Et.svgUrl=p.result;h.src=await bt?`${ct}#svgView(preserveAspectRatio(none))`:ct},h.onerror=p.onerror=tt});p.readAsDataURL(yt),await S}else Et.bitmap=await createImageBitmap(yt);Et.refCounter=1}catch(yt){console.error(yt),Et=null}return t(this,b).set(m,Et),Et&&t(this,b).set(Et.id,Et),Et};let X=Y;class j{constructor(m=128){F(this,M,[]);F(this,H,!1);F(this,D);F(this,B,-1);R(this,D,m)}add({cmd:m,undo:Q,mustExec:Et,type:yt=NaN,overwriteIfSameType:bt=!1,keepUndo:p=!1}){if(Et&&m(),t(this,H))return;const h={cmd:m,undo:Q,type:yt};if(t(this,B)===-1){t(this,M).length>0&&(t(this,M).length=0),R(this,B,0),t(this,M).push(h);return}if(bt&&t(this,M)[t(this,B)].type===yt){p&&(h.undo=t(this,M)[t(this,B)].undo),t(this,M)[t(this,B)]=h;return}const S=t(this,B)+1;S===t(this,D)?t(this,M).splice(0,1):(R(this,B,S),S<t(this,M).length&&t(this,M).splice(S)),t(this,M).push(h)}undo(){t(this,B)!==-1&&(R(this,H,!0),t(this,M)[t(this,B)].undo(),R(this,H,!1),R(this,B,t(this,B)-1))}redo(){t(this,B)<t(this,M).length-1&&(R(this,B,t(this,B)+1),R(this,H,!0),t(this,M)[t(this,B)].cmd(),R(this,H,!1))}hasSomethingToUndo(){return t(this,B)!==-1}hasSomethingToRedo(){return t(this,B)<t(this,M).length-1}destroy(){R(this,M,null)}}M=new WeakMap,H=new WeakMap,D=new WeakMap,B=new WeakMap;class v{constructor(m){F(this,et);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Q}=c.FeatureTest.platform;for(const[Et,yt,bt={}]of m)for(const p of Et){const h=p.startsWith("mac+");Q&&h?(this.callbacks.set(p.slice(4),{callback:yt,options:bt}),this.allKeys.add(p.split("+").at(-1))):!Q&&!h&&(this.callbacks.set(p,{callback:yt,options:bt}),this.allKeys.add(p.split("+").at(-1)))}}exec(m,Q){if(!this.allKeys.has(Q.key))return;const Et=this.callbacks.get(x(this,et,xa).call(this,Q));if(!Et)return;const{callback:yt,options:{bubbles:bt=!1,args:p=[],checker:h=null}}=Et;h&&!h(m,Q)||(yt.bind(m,...p,Q)(),bt||(Q.stopPropagation(),Q.preventDefault()))}}et=new WeakSet,xa=function(m){m.altKey&&this.buffer.push("alt"),m.ctrlKey&&this.buffer.push("ctrl"),m.metaKey&&this.buffer.push("meta"),m.shiftKey&&this.buffer.push("shift"),this.buffer.push(m.key);const Q=this.buffer.join("+");return this.buffer.length=0,Q};const St=class St{get _colors(){const m=new Map([["CanvasText",null],["Canvas",null]]);return(0,it.getColorValues)(m),(0,c.shadow)(this,"_colors",m)}convert(m){const Q=(0,it.getRGB)(m);if(!window.matchMedia("(forced-colors: active)").matches)return Q;for(const[Et,yt]of this._colors)if(yt.every((bt,p)=>bt===Q[p]))return St._colorsMapping.get(Et);return Q}getHexCode(m){const Q=this._colors.get(m);return Q?c.Util.makeHexColor(...Q):m}};he(St,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let $=St;const ft=class ft{constructor(m,Q,Et,yt,bt,p,h){F(this,st);F(this,Ct,null);F(this,qt,new Map);F(this,Yt,new Map);F(this,ie,null);F(this,Kt,null);F(this,Bt,new j);F(this,Ut,0);F(this,jt,new Set);F(this,ee,null);F(this,$t,null);F(this,te,new Set);F(this,le,null);F(this,Wt,null);F(this,Qt,null);F(this,me,new dt);F(this,kt,!1);F(this,Jt,!1);F(this,ne,null);F(this,be,null);F(this,_e,c.AnnotationEditorType.NONE);F(this,ae,new Set);F(this,ue,null);F(this,O,this.blur.bind(this));F(this,s,this.focus.bind(this));F(this,e,this.copy.bind(this));F(this,i,this.cut.bind(this));F(this,o,this.paste.bind(this));F(this,l,this.keydown.bind(this));F(this,g,this.onEditingAction.bind(this));F(this,_,this.onPageChanging.bind(this));F(this,G,this.onScaleChanging.bind(this));F(this,w,this.onRotationChanging.bind(this));F(this,r,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});F(this,u,[0,0]);F(this,I,null);F(this,at,null);F(this,nt,null);R(this,at,m),R(this,nt,Q),R(this,ie,Et),this._eventBus=yt,this._eventBus._on("editingaction",t(this,g)),this._eventBus._on("pagechanging",t(this,_)),this._eventBus._on("scalechanging",t(this,G)),this._eventBus._on("rotationchanging",t(this,w)),R(this,Kt,bt.annotationStorage),R(this,le,bt.filterFactory),R(this,ue,p),R(this,Qt,h||null),this.viewParameters={realScale:it.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const m=ft.prototype,Q=p=>t(p,at).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&p.hasSomethingToControl(),Et=(p,{target:h})=>{if(h instanceof HTMLInputElement){const{type:S}=h;return S!=="text"&&S!=="number"}return!0},yt=this.TRANSLATE_SMALL,bt=this.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new v([[["ctrl+a","mac+meta+a"],m.selectAll,{checker:Et}],[["ctrl+z","mac+meta+z"],m.undo,{checker:Et}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],m.redo,{checker:Et}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],m.delete,{checker:Et}],[["Enter","mac+Enter"],m.addNewEditorFromKeyboard,{checker:(p,{target:h})=>!(h instanceof HTMLButtonElement)&&t(p,at).contains(h)&&!p.isEnterHandled}],[[" ","mac+ "],m.addNewEditorFromKeyboard,{checker:p=>t(p,at).contains(document.activeElement)}],[["Escape","mac+Escape"],m.unselectAll],[["ArrowLeft","mac+ArrowLeft"],m.translateSelectedEditors,{args:[-yt,0],checker:Q}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],m.translateSelectedEditors,{args:[-bt,0],checker:Q}],[["ArrowRight","mac+ArrowRight"],m.translateSelectedEditors,{args:[yt,0],checker:Q}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],m.translateSelectedEditors,{args:[bt,0],checker:Q}],[["ArrowUp","mac+ArrowUp"],m.translateSelectedEditors,{args:[0,-yt],checker:Q}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],m.translateSelectedEditors,{args:[0,-bt],checker:Q}],[["ArrowDown","mac+ArrowDown"],m.translateSelectedEditors,{args:[0,yt],checker:Q}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],m.translateSelectedEditors,{args:[0,bt],checker:Q}]]))}destroy(){var m;x(this,st,Bs).call(this),x(this,st,Ri).call(this),this._eventBus._off("editingaction",t(this,g)),this._eventBus._off("pagechanging",t(this,_)),this._eventBus._off("scalechanging",t(this,G)),this._eventBus._off("rotationchanging",t(this,w));for(const Q of t(this,Yt).values())Q.destroy();t(this,Yt).clear(),t(this,qt).clear(),t(this,te).clear(),R(this,Ct,null),t(this,ae).clear(),t(this,Bt).destroy(),(m=t(this,ie))==null||m.destroy(),t(this,Wt)&&(clearTimeout(t(this,Wt)),R(this,Wt,null)),t(this,I)&&(clearTimeout(t(this,I)),R(this,I,null))}get hcmFilter(){return(0,c.shadow)(this,"hcmFilter",t(this,ue)?t(this,le).addHCMFilter(t(this,ue).foreground,t(this,ue).background):"none")}get direction(){return(0,c.shadow)(this,"direction",getComputedStyle(t(this,at)).direction)}get highlightColors(){return(0,c.shadow)(this,"highlightColors",t(this,Qt)?new Map(t(this,Qt).split(",").map(m=>m.split("=").map(Q=>Q.trim()))):null)}setMainHighlightColorPicker(m){R(this,be,m)}editAltText(m){var Q;(Q=t(this,ie))==null||Q.editAltText(this,m)}onPageChanging({pageNumber:m}){R(this,Ut,m-1)}focusMainContainer(){t(this,at).focus()}findParent(m,Q){for(const Et of t(this,Yt).values()){const{x:yt,y:bt,width:p,height:h}=Et.div.getBoundingClientRect();if(m>=yt&&m<=yt+p&&Q>=bt&&Q<=bt+h)return Et}return null}disableUserSelect(m=!1){t(this,nt).classList.toggle("noUserSelect",m)}addShouldRescale(m){t(this,te).add(m)}removeShouldRescale(m){t(this,te).delete(m)}onScaleChanging({scale:m}){this.commitOrRemove(),this.viewParameters.realScale=m*it.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Q of t(this,te))Q.onScaleChanging()}onRotationChanging({pagesRotation:m}){this.commitOrRemove(),this.viewParameters.rotation=m}addToAnnotationStorage(m){!m.isEmpty()&&t(this,Kt)&&!t(this,Kt).has(m.id)&&t(this,Kt).setValue(m.id,m)}blur(){if(!this.hasSelection)return;const{activeElement:m}=document;for(const Q of t(this,ae))if(Q.div.contains(m)){R(this,ne,[Q,m]),Q._focusEventsAllowed=!1;break}}focus(){if(!t(this,ne))return;const[m,Q]=t(this,ne);R(this,ne,null),Q.addEventListener("focusin",()=>{m._focusEventsAllowed=!0},{once:!0}),Q.focus()}addEditListeners(){x(this,st,Fi).call(this),x(this,st,Ii).call(this)}removeEditListeners(){x(this,st,Bs).call(this),x(this,st,Li).call(this)}copy(m){var Et;if(m.preventDefault(),(Et=t(this,Ct))==null||Et.commitOrRemove(),!this.hasSelection)return;const Q=[];for(const yt of t(this,ae)){const bt=yt.serialize(!0);bt&&Q.push(bt)}Q.length!==0&&m.clipboardData.setData("application/pdfjs",JSON.stringify(Q))}cut(m){this.copy(m),this.delete()}paste(m){m.preventDefault();const{clipboardData:Q}=m;for(const bt of Q.items)for(const p of t(this,$t))if(p.isHandlingMimeForPasting(bt.type)){p.paste(bt,this.currentLayer);return}let Et=Q.getData("application/pdfjs");if(!Et)return;try{Et=JSON.parse(Et)}catch(bt){(0,c.warn)(`paste: "${bt.message}".`);return}if(!Array.isArray(Et))return;this.unselectAll();const yt=this.currentLayer;try{const bt=[];for(const S of Et){const U=yt.deserialize(S);if(!U)return;bt.push(U)}const p=()=>{for(const S of bt)x(this,st,Di).call(this,S);x(this,st,Oi).call(this,bt)},h=()=>{for(const S of bt)S.remove()};this.addCommands({cmd:p,undo:h,mustExec:!0})}catch(bt){(0,c.warn)(`paste: "${bt.message}".`)}}keydown(m){this.isEditorHandlingKeyboard||ft._keyboardManager.exec(this,m)}onEditingAction(m){["undo","redo","delete","selectAll"].includes(m.name)&&this[m.name]()}setEditingState(m){m?(x(this,st,wa).call(this),x(this,st,Fi).call(this),x(this,st,Ii).call(this),x(this,st,Pe).call(this,{isEditing:t(this,_e)!==c.AnnotationEditorType.NONE,isEmpty:x(this,st,As).call(this),hasSomethingToUndo:t(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:t(this,Bt).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,st,Ri).call(this),x(this,st,Bs).call(this),x(this,st,Li).call(this),x(this,st,Pe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(m){if(!t(this,$t)){R(this,$t,m);for(const Q of t(this,$t))x(this,st,fs).call(this,Q.defaultPropertiesToUpdate)}}getId(){return t(this,me).getId()}get currentLayer(){return t(this,Yt).get(t(this,Ut))}getLayer(m){return t(this,Yt).get(m)}get currentPageIndex(){return t(this,Ut)}addLayer(m){t(this,Yt).set(m.pageIndex,m),t(this,kt)?m.enable():m.disable()}removeLayer(m){t(this,Yt).delete(m.pageIndex)}updateMode(m,Q=null,Et=!1){if(t(this,_e)!==m){if(R(this,_e,m),m===c.AnnotationEditorType.NONE){this.setEditingState(!1),x(this,st,Ta).call(this);return}this.setEditingState(!0),x(this,st,Sa).call(this),this.unselectAll();for(const yt of t(this,Yt).values())yt.updateMode(m);if(!Q&&Et){this.addNewEditorFromKeyboard();return}if(Q){for(const yt of t(this,qt).values())if(yt.annotationElementId===Q){this.setSelected(yt),yt.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(m){m!==t(this,_e)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:m})}updateParams(m,Q){var Et;if(t(this,$t)){switch(m){case c.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Et=t(this,be))==null||Et.updateColor(Q);break}for(const yt of t(this,ae))yt.updateParams(m,Q);for(const yt of t(this,$t))yt.updateDefaultParams(m,Q)}}enableWaiting(m=!1){if(t(this,Jt)!==m){R(this,Jt,m);for(const Q of t(this,Yt).values())m?Q.disableClick():Q.enableClick(),Q.div.classList.toggle("waiting",m)}}getEditors(m){const Q=[];for(const Et of t(this,qt).values())Et.pageIndex===m&&Q.push(Et);return Q}getEditor(m){return t(this,qt).get(m)}addEditor(m){t(this,qt).set(m.id,m)}removeEditor(m){var Q;m.div.contains(document.activeElement)&&(t(this,Wt)&&clearTimeout(t(this,Wt)),R(this,Wt,setTimeout(()=>{this.focusMainContainer(),R(this,Wt,null)},0))),t(this,qt).delete(m.id),this.unselect(m),(!m.annotationElementId||!t(this,jt).has(m.annotationElementId))&&((Q=t(this,Kt))==null||Q.remove(m.id))}addDeletedAnnotationElement(m){t(this,jt).add(m.annotationElementId),m.deleted=!0}isDeletedAnnotationElement(m){return t(this,jt).has(m)}removeDeletedAnnotationElement(m){t(this,jt).delete(m.annotationElementId),m.deleted=!1}setActiveEditor(m){t(this,Ct)!==m&&(R(this,Ct,m),m&&x(this,st,fs).call(this,m.propertiesToUpdate))}toggleSelected(m){if(t(this,ae).has(m)){t(this,ae).delete(m),m.unselect(),x(this,st,Pe).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,ae).add(m),m.select(),x(this,st,fs).call(this,m.propertiesToUpdate),x(this,st,Pe).call(this,{hasSelectedEditor:!0})}setSelected(m){for(const Q of t(this,ae))Q!==m&&Q.unselect();t(this,ae).clear(),t(this,ae).add(m),m.select(),x(this,st,fs).call(this,m.propertiesToUpdate),x(this,st,Pe).call(this,{hasSelectedEditor:!0})}isSelected(m){return t(this,ae).has(m)}get firstSelectedEditor(){return t(this,ae).values().next().value}unselect(m){m.unselect(),t(this,ae).delete(m),x(this,st,Pe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,ae).size!==0}get isEnterHandled(){return t(this,ae).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Bt).undo(),x(this,st,Pe).call(this,{hasSomethingToUndo:t(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,st,As).call(this)})}redo(){t(this,Bt).redo(),x(this,st,Pe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Bt).hasSomethingToRedo(),isEmpty:x(this,st,As).call(this)})}addCommands(m){t(this,Bt).add(m),x(this,st,Pe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,st,As).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const m=[...t(this,ae)],Q=()=>{for(const yt of m)yt.remove()},Et=()=>{for(const yt of m)x(this,st,Di).call(this,yt)};this.addCommands({cmd:Q,undo:Et,mustExec:!0})}commitOrRemove(){var m;(m=t(this,Ct))==null||m.commitOrRemove()}hasSomethingToControl(){return t(this,Ct)||this.hasSelection}selectAll(){for(const m of t(this,ae))m.commit();x(this,st,Oi).call(this,t(this,qt).values())}unselectAll(){if(!(t(this,Ct)&&(t(this,Ct).commitOrRemove(),t(this,_e)!==c.AnnotationEditorType.NONE))&&this.hasSelection){for(const m of t(this,ae))m.unselect();t(this,ae).clear(),x(this,st,Pe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(m,Q,Et=!1){if(Et||this.commitOrRemove(),!this.hasSelection)return;t(this,u)[0]+=m,t(this,u)[1]+=Q;const[yt,bt]=t(this,u),p=[...t(this,ae)];t(this,I)&&clearTimeout(t(this,I)),R(this,I,setTimeout(()=>{R(this,I,null),t(this,u)[0]=t(this,u)[1]=0,this.addCommands({cmd:()=>{for(const S of p)t(this,qt).has(S.id)&&S.translateInPage(yt,bt)},undo:()=>{for(const S of p)t(this,qt).has(S.id)&&S.translateInPage(-yt,-bt)},mustExec:!1})},1e3));for(const S of p)S.translateInPage(m,Q)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),R(this,ee,new Map);for(const m of t(this,ae))t(this,ee).set(m,{savedX:m.x,savedY:m.y,savedPageIndex:m.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ee))return!1;this.disableUserSelect(!1);const m=t(this,ee);R(this,ee,null);let Q=!1;for(const[{x:yt,y:bt,pageIndex:p},h]of m)h.newX=yt,h.newY=bt,h.newPageIndex=p,Q||(Q=yt!==h.savedX||bt!==h.savedY||p!==h.savedPageIndex);if(!Q)return!1;const Et=(yt,bt,p,h)=>{if(t(this,qt).has(yt.id)){const S=t(this,Yt).get(h);S?yt._setParentAndPosition(S,bt,p):(yt.pageIndex=h,yt.x=bt,yt.y=p)}};return this.addCommands({cmd:()=>{for(const[yt,{newX:bt,newY:p,newPageIndex:h}]of m)Et(yt,bt,p,h)},undo:()=>{for(const[yt,{savedX:bt,savedY:p,savedPageIndex:h}]of m)Et(yt,bt,p,h)},mustExec:!0}),!0}dragSelectedEditors(m,Q){if(t(this,ee))for(const Et of t(this,ee).keys())Et.drag(m,Q)}rebuild(m){if(m.parent===null){const Q=this.getLayer(m.pageIndex);Q?(Q.changeParent(m),Q.addOrRebuild(m)):(this.addEditor(m),this.addToAnnotationStorage(m),m.rebuild())}else m.parent.addOrRebuild(m)}get isEditorHandlingKeyboard(){var m;return((m=this.getActive())==null?void 0:m.shouldGetKeyboardEvents())||t(this,ae).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(m){return t(this,Ct)===m}getActive(){return t(this,Ct)}getMode(){return t(this,_e)}get imageManager(){return(0,c.shadow)(this,"imageManager",new X)}};Ct=new WeakMap,qt=new WeakMap,Yt=new WeakMap,ie=new WeakMap,Kt=new WeakMap,Bt=new WeakMap,Ut=new WeakMap,jt=new WeakMap,ee=new WeakMap,$t=new WeakMap,te=new WeakMap,le=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,me=new WeakMap,kt=new WeakMap,Jt=new WeakMap,ne=new WeakMap,be=new WeakMap,_e=new WeakMap,ae=new WeakMap,ue=new WeakMap,O=new WeakMap,s=new WeakMap,e=new WeakMap,i=new WeakMap,o=new WeakMap,l=new WeakMap,g=new WeakMap,_=new WeakMap,G=new WeakMap,w=new WeakMap,r=new WeakMap,u=new WeakMap,I=new WeakMap,at=new WeakMap,nt=new WeakMap,st=new WeakSet,wa=function(){window.addEventListener("focus",t(this,s)),window.addEventListener("blur",t(this,O))},Ri=function(){window.removeEventListener("focus",t(this,s)),window.removeEventListener("blur",t(this,O))},Fi=function(){window.addEventListener("keydown",t(this,l))},Bs=function(){window.removeEventListener("keydown",t(this,l))},Ii=function(){document.addEventListener("copy",t(this,e)),document.addEventListener("cut",t(this,i)),document.addEventListener("paste",t(this,o))},Li=function(){document.removeEventListener("copy",t(this,e)),document.removeEventListener("cut",t(this,i)),document.removeEventListener("paste",t(this,o))},Pe=function(m){Object.entries(m).some(([Q,Et])=>t(this,r)[Q]!==Et)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,r),m)})},fs=function(m){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:m})},Sa=function(){if(!t(this,kt)){R(this,kt,!0);for(const m of t(this,Yt).values())m.enable()}},Ta=function(){if(this.unselectAll(),t(this,kt)){R(this,kt,!1);for(const m of t(this,Yt).values())m.disable()}},Di=function(m){const Q=t(this,Yt).get(m.pageIndex);Q?Q.addOrRebuild(m):this.addEditor(m)},As=function(){if(t(this,qt).size===0)return!0;if(t(this,qt).size===1)for(const m of t(this,qt).values())return m.isEmpty();return!1},Oi=function(m){t(this,ae).clear();for(const Q of m)Q.isEmpty()||(t(this,ae).add(Q),Q.select());x(this,st,Pe).call(this,{hasSelectedEditor:!0})},he(ft,"TRANSLATE_SMALL",1),he(ft,"TRANSLATE_BIG",10);let z=ft},171:(Zt,Nt,lt)=>{lt.d(Nt,{PDFFetchStream:()=>X});var c=lt(266),it=lt(253);function P($,z,A){return{method:"GET",headers:$,signal:A.signal,mode:"cors",credentials:z?"include":"same-origin",redirect:"follow"}}function W($){const z=new Headers;for(const A in $){const L=$[A];L!==void 0&&z.append(A,L)}return z}function dt($){return $ instanceof Uint8Array?$.buffer:$ instanceof ArrayBuffer?$:((0,c.warn)(`getArrayBuffer - unexpected data format: ${$}`),new Uint8Array($).buffer)}class X{constructor(z){this.source=z,this.isHttp=/^https?:/i.test(z.url),this.httpHeaders=this.isHttp&&z.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var z;return((z=this._fullRequestReader)==null?void 0:z._loaded)??0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new j(this),this._fullRequestReader}getRangeReader(z,A){if(A<=this._progressiveDataLength)return null;const L=new v(this,z,A);return this._rangeRequestReaders.push(L),L}cancelAllRequests(z){var A;(A=this._fullRequestReader)==null||A.cancel(z);for(const L of this._rangeRequestReaders.slice(0))L.cancel(z)}}class j{constructor(z){this._stream=z,this._reader=null,this._loaded=0,this._filename=null;const A=z.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=new c.PromiseCapability,this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=W(this._stream.httpHeaders);const L=A.url;fetch(L,P(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,it.validateResponseStatus)(E.status))throw(0,it.createResponseStatusError)(E.status,L);this._reader=E.body.getReader(),this._headersCapability.resolve();const b=Y=>E.headers.get(Y),{allowRangeRequests:y,suggestedLength:V}=(0,it.validateRangeRequestCapabilities)({getResponseHeader:b,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=V||this._contentLength,this._filename=(0,it.extractFilenameFromHeader)(b),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var L;await this._headersCapability.promise;const{value:z,done:A}=await this._reader.read();return A?{value:z,done:A}:(this._loaded+=z.byteLength,(L=this.onProgress)==null||L.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dt(z),done:!1})}cancel(z){var A;(A=this._reader)==null||A.cancel(z),this._abortController.abort()}}class v{constructor(z,A,L){this._stream=z,this._reader=null,this._loaded=0;const E=z.source;this._withCredentials=E.withCredentials||!1,this._readCapability=new c.PromiseCapability,this._isStreamingSupported=!E.disableStream,this._abortController=new AbortController,this._headers=W(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${L-1}`);const b=E.url;fetch(b,P(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,it.validateResponseStatus)(y.status))throw(0,it.createResponseStatusError)(y.status,b);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var L;await this._readCapability.promise;const{value:z,done:A}=await this._reader.read();return A?{value:z,done:A}:(this._loaded+=z.byteLength,(L=this.onProgress)==null||L.call(this,{loaded:this._loaded}),{value:dt(z),done:!1})}cancel(z){var A;(A=this._reader)==null||A.cancel(z),this._abortController.abort()}}},742:(Zt,Nt,lt)=>{var W;lt.d(Nt,{FontFaceObject:()=>P,FontLoader:()=>it});var c=lt(266);class it{constructor({ownerDocument:X=globalThis.document,styleElement:j=null}){F(this,W,new Set);this._document=X,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(X){this.nativeFontFaces.add(X),this._document.fonts.add(X)}removeNativeFontFace(X){this.nativeFontFaces.delete(X),this._document.fonts.delete(X)}insertRule(X){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const j=this.styleElement.sheet;j.insertRule(X,j.cssRules.length)}clear(){for(const X of this.nativeFontFaces)this._document.fonts.delete(X);this.nativeFontFaces.clear(),t(this,W).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:X,_inspectFont:j}){if(!(!X||t(this,W).has(X.loadedName))){if((0,c.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:v,src:$,style:z}=X,A=new FontFace(v,$,z);this.addNativeFontFace(A);try{await A.load(),t(this,W).add(v),j==null||j(X)}catch{(0,c.warn)(`Cannot load system font: ${X.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(A)}return}(0,c.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(X){if(X.attached||X.missingFile&&!X.systemFontInfo)return;if(X.attached=!0,X.systemFontInfo){await this.loadSystemFont(X);return}if(this.isFontLoadingAPISupported){const v=X.createNativeFontFace();if(v){this.addNativeFontFace(v);try{await v.loaded}catch($){throw(0,c.warn)(`Failed to load font '${v.family}': '${$}'.`),X.disableFontFace=!0,$}}return}const j=X.createFontFaceRule();if(j){if(this.insertRule(j),this.isSyncFontLoadingSupported)return;await new Promise(v=>{const $=this._queueLoadingCallback(v);this._prepareFontLoadEvent(X,$)})}}get isFontLoadingAPISupported(){var j;const X=!!((j=this._document)!=null&&j.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",X)}get isSyncFontLoadingSupported(){let X=!1;return(c.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(X=!0),(0,c.shadow)(this,"isSyncFontLoadingSupported",X)}_queueLoadingCallback(X){function j(){for((0,c.assert)(!$.done,"completeRequest() cannot be called twice."),$.done=!0;v.length>0&&v[0].done;){const z=v.shift();setTimeout(z.callback,0)}}const{loadingRequests:v}=this,$={done:!1,complete:j,callback:X};return v.push($),$}get _loadTestFont(){const X=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,c.shadow)(this,"_loadTestFont",X)}_prepareFontLoadEvent(X,j){function v(St,Ct){return St.charCodeAt(Ct)<<24|St.charCodeAt(Ct+1)<<16|St.charCodeAt(Ct+2)<<8|St.charCodeAt(Ct+3)&255}function $(St,Ct,qt,Yt){const ie=St.substring(0,Ct),Kt=St.substring(Ct+qt);return ie+Yt+Kt}let z,A;const L=this._document.createElement("canvas");L.width=1,L.height=1;const E=L.getContext("2d");let b=0;function y(St,Ct){if(++b>30){(0,c.warn)("Load test font never loaded."),Ct();return}if(E.font="30px "+St,E.fillText(".",0,20),E.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(y.bind(null,St,Ct))}const V=`lt${Date.now()}${this.loadTestFontId++}`;let Y=this._loadTestFont;Y=$(Y,976,V.length,V);const M=16,H=1482184792;let D=v(Y,M);for(z=0,A=V.length-3;z<A;z+=4)D=D-H+v(V,z)|0;z<V.length&&(D=D-H+v(V+"XXX",z)|0),Y=$(Y,M,4,(0,c.string32)(D));const B=`url(data:font/opentype;base64,${btoa(Y)});`,et=`@font-face {font-family:"${V}";src:${B}}`;this.insertRule(et);const At=this._document.createElement("div");At.style.visibility="hidden",At.style.width=At.style.height="10px",At.style.position="absolute",At.style.top=At.style.left="0px";for(const St of[X.loadedName,V]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=St,At.append(Ct)}this._document.body.append(At),y(V,()=>{At.remove(),j.complete()})}}W=new WeakMap;class P{constructor(X,{isEvalSupported:j=!0,disableFontFace:v=!1,ignoreErrors:$=!1,inspectFont:z=null}){this.compiledGlyphs=Object.create(null);for(const A in X)this[A]=X[A];this.isEvalSupported=j!==!1,this.disableFontFace=v===!0,this.ignoreErrors=$===!0,this._inspectFont=z}createNativeFontFace(){var j;if(!this.data||this.disableFontFace)return null;let X;if(!this.cssFontInfo)X=new FontFace(this.loadedName,this.data,{});else{const v={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(v.style=`oblique ${this.cssFontInfo.italicAngle}deg`),X=new FontFace(this.cssFontInfo.fontFamily,this.data,v)}return(j=this._inspectFont)==null||j.call(this,this),X}createFontFaceRule(){var $;if(!this.data||this.disableFontFace)return null;const X=(0,c.bytesToString)(this.data),j=`url(data:${this.mimetype};base64,${btoa(X)});`;let v;if(!this.cssFontInfo)v=`@font-face {font-family:"${this.loadedName}";src:${j}}`;else{let z=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(z+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),v=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${z}src:${j}}`}return($=this._inspectFont)==null||$.call(this,this,j),v}getPathGenerator(X,j){if(this.compiledGlyphs[j]!==void 0)return this.compiledGlyphs[j];let v;try{v=X.get(this.loadedName+"_path_"+j)}catch($){if(!this.ignoreErrors)throw $;return(0,c.warn)(`getPathGenerator - ignoring character: "${$}".`),this.compiledGlyphs[j]=function(z,A){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const $=[];for(const z of v){const A=z.args!==void 0?z.args.join(","):"";$.push("c.",z.cmd,"(",A,`);
`)}return this.compiledGlyphs[j]=new Function("c","size",$.join(""))}return this.compiledGlyphs[j]=function($,z){for(const A of v)A.cmd==="scale"&&(A.args=[z,-z]),$[A.cmd].apply($,A.args)}}}},472:(Zt,Nt,lt)=>{var P,W;lt.d(Nt,{Metadata:()=>it});var c=lt(266);class it{constructor({parsedData:X,rawData:j}){F(this,P);F(this,W);R(this,P,X),R(this,W,j)}getRaw(){return t(this,W)}get(X){return t(this,P).get(X)??null}getAll(){return(0,c.objectFromMap)(t(this,P))}has(X){return t(this,P).has(X)}}P=new WeakMap,W=new WeakMap},474:(Zt,Nt,lt)=>{lt.d(Nt,{PDFNetworkStream:()=>j});var c=lt(266),it=lt(253);const P=200,W=206;function dt(z){const A=z.response;return typeof A!="string"?A:(0,c.stringToBytes)(A).buffer}class X{constructor(A,L={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&L.httpHeaders||Object.create(null),this.withCredentials=L.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,L,E){const b={begin:A,end:L};for(const y in E)b[y]=E[y];return this.request(b)}requestFull(A){return this.request(A)}request(A){const L=new XMLHttpRequest,E=this.currXhrId++,b=this.pendingRequests[E]={xhr:L};L.open("GET",this.url),L.withCredentials=this.withCredentials;for(const y in this.httpHeaders){const V=this.httpHeaders[y];V!==void 0&&L.setRequestHeader(y,V)}return this.isHttp&&"begin"in A&&"end"in A?(L.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),b.expectedStatus=W):b.expectedStatus=P,L.responseType="arraybuffer",A.onError&&(L.onerror=function(y){A.onError(L.status)}),L.onreadystatechange=this.onStateChange.bind(this,E),L.onprogress=this.onProgress.bind(this,E),b.onHeadersReceived=A.onHeadersReceived,b.onDone=A.onDone,b.onError=A.onError,b.onProgress=A.onProgress,L.send(null),E}onProgress(A,L){var b;const E=this.pendingRequests[A];E&&((b=E.onProgress)==null||b.call(E,L))}onStateChange(A,L){var Y,M,H;const E=this.pendingRequests[A];if(!E)return;const b=E.xhr;if(b.readyState>=2&&E.onHeadersReceived&&(E.onHeadersReceived(),delete E.onHeadersReceived),b.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],b.status===0&&this.isHttp){(Y=E.onError)==null||Y.call(E,b.status);return}const y=b.status||P;if(!(y===P&&E.expectedStatus===W)&&y!==E.expectedStatus){(M=E.onError)==null||M.call(E,b.status);return}const V=dt(b);if(y===W){const D=b.getResponseHeader("Content-Range"),B=/bytes (\d+)-(\d+)\/(\d+)/.exec(D);E.onDone({begin:parseInt(B[1],10),chunk:V})}else V?E.onDone({begin:0,chunk:V}):(H=E.onError)==null||H.call(E,b.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const L=this.pendingRequests[A].xhr;delete this.pendingRequests[A],L.abort()}}class j{constructor(A){this._source=A,this._manager=new X(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const L=this._rangeRequestReaders.indexOf(A);L>=0&&this._rangeRequestReaders.splice(L,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v(this._manager,this._source),this._fullRequestReader}getRangeReader(A,L){const E=new $(this._manager,A,L);return E.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(E),E}cancelAllRequests(A){var L;(L=this._fullRequestReader)==null||L.cancel(A);for(const E of this._rangeRequestReaders.slice(0))E.cancel(A)}}class v{constructor(A,L){this._manager=A;const E={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=L.url,this._fullRequestId=A.requestFull(E),this._headersReceivedCapability=new c.PromiseCapability,this._disableRange=L.disableRange||!1,this._contentLength=L.length,this._rangeChunkSize=L.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,L=this._manager.getRequestXhr(A),E=V=>L.getResponseHeader(V),{allowRangeRequests:b,suggestedLength:y}=(0,it.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=y||this._contentLength,this._filename=(0,it.extractFilenameFromHeader)(E),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,it.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const L of this._requests)L.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var L;(L=this.onProgress)==null||L.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=new c.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ${constructor(A,L,E){this._manager=A;const b={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(L,E,b),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const L=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:L,done:!1}):this._queuedChunk=L,this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,it.createResponseStatusError)(A,this._url);for(const L of this._requests)L.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var L;this.isStreamingSupported||((L=this.onProgress)==null||L.call(this,{loaded:A.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const L=this._queuedChunk;return this._queuedChunk=null,{value:L,done:!1}}if(this._done)return{value:void 0,done:!0};const A=new c.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},253:(Zt,Nt,lt)=>{lt.d(Nt,{createResponseStatusError:()=>X,extractFilenameFromHeader:()=>dt,validateRangeRequestCapabilities:()=>W,validateResponseStatus:()=>j});var c=lt(266);function it(v){let $=!0,z=A("filename\\*","i").exec(v);if(z){z=z[1];let M=y(z);return M=unescape(M),M=V(M),M=Y(M),E(M)}if(z=b(v),z){const M=Y(z);return E(M)}if(z=A("filename","i").exec(v),z){z=z[1];let M=y(z);return M=Y(M),E(M)}function A(M,H){return new RegExp("(?:^|;)\\s*"+M+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',H)}function L(M,H){if(M){if(!/^[\x00-\xFF]+$/.test(H))return H;try{const D=new TextDecoder(M,{fatal:!0}),B=(0,c.stringToBytes)(H);H=D.decode(B),$=!1}catch{}}return H}function E(M){return $&&/[\x80-\xff]/.test(M)&&(M=L("utf-8",M),$&&(M=L("iso-8859-1",M))),M}function b(M){const H=[];let D;const B=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(D=B.exec(M))!==null;){let[,At,St,Ct]=D;if(At=parseInt(At,10),At in H){if(At===0)break;continue}H[At]=[St,Ct]}const et=[];for(let At=0;At<H.length&&At in H;++At){let[St,Ct]=H[At];Ct=y(Ct),St&&(Ct=unescape(Ct),At===0&&(Ct=V(Ct))),et.push(Ct)}return et.join("")}function y(M){if(M.startsWith('"')){const H=M.slice(1).split('\\"');for(let D=0;D<H.length;++D){const B=H[D].indexOf('"');B!==-1&&(H[D]=H[D].slice(0,B),H.length=D+1),H[D]=H[D].replaceAll(/\\(.)/g,"$1")}M=H.join('"')}return M}function V(M){const H=M.indexOf("'");if(H===-1)return M;const D=M.slice(0,H),B=M.slice(H+1).replace(/^[^']*'/,"");return L(D,B)}function Y(M){return!M.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(M)?M:M.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(H,D,B,et){if(B==="q"||B==="Q")return et=et.replaceAll("_"," "),et=et.replaceAll(/=([0-9a-fA-F]{2})/g,function(At,St){return String.fromCharCode(parseInt(St,16))}),L(D,et);try{et=atob(et)}catch{}return L(D,et)})}return""}var P=lt(473);function W({getResponseHeader:v,isHttp:$,rangeChunkSize:z,disableRange:A}){const L={allowRangeRequests:!1,suggestedLength:void 0},E=parseInt(v("Content-Length"),10);return!Number.isInteger(E)||(L.suggestedLength=E,E<=2*z)||A||!$||v("Accept-Ranges")!=="bytes"||(v("Content-Encoding")||"identity")!=="identity"||(L.allowRangeRequests=!0),L}function dt(v){const $=v("Content-Disposition");if($){let z=it($);if(z.includes("%"))try{z=decodeURIComponent(z)}catch{}if((0,P.isPdfFile)(z))return z}return null}function X(v,$){return v===404||v===0&&$.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+$+'".'):new c.UnexpectedResponseException(`Unexpected server response (${v}) while retrieving PDF "${$}".`,v)}function j(v){return v===200||v===206}},498:(Zt,Nt,lt)=>{lt.a(Zt,async(c,it)=>{try{let dt=function(H){const D=z.parse(H);return D.protocol==="file:"||D.host?D:/^[a-z]:[/\\]/i.test(H)?z.parse(`file:///${H}`):(D.host||(D.protocol="file:"),D)},X=function(H,D){return{protocol:H.protocol,auth:H.auth,host:H.hostname,port:H.port,path:H.path,method:"GET",headers:D}};lt.d(Nt,{PDFNodeStream:()=>L});var P=lt(266),W=lt(253);let j,v,$,z;P.isNodeJS&&(j=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),v=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),$=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),z=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]));const A=/^file:\/\/\/[a-zA-Z]:\//;class L{constructor(D){this.source=D,this.url=dt(D.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&D.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var D;return((D=this._fullRequestReader)==null?void 0:D._loaded)??0}getFullReader(){return(0,P.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Y(this):new y(this),this._fullRequestReader}getRangeReader(D,B){if(B<=this._progressiveDataLength)return null;const et=this.isFsUrl?new M(this,D,B):new V(this,D,B);return this._rangeRequestReaders.push(et),et}cancelAllRequests(D){var B;(B=this._fullRequestReader)==null||B.cancel(D);for(const et of this._rangeRequestReaders.slice(0))et.cancel(D)}}class E{constructor(D){this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null;const B=D.source;this._contentLength=B.length,this._loaded=0,this._filename=null,this._disableRange=B.disableRange||!1,this._rangeChunkSize=B.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!B.disableStream,this._isRangeSupported=!B.disableRange,this._readableStream=null,this._readCapability=new P.PromiseCapability,this._headersCapability=new P.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const D=this._readableStream.read();return D===null?(this._readCapability=new P.PromiseCapability,this.read()):(this._loaded+=D.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(D).buffer,done:!1})}cancel(D){if(!this._readableStream){this._error(D);return}this._readableStream.destroy(D)}_error(D){this._storedError=D,this._readCapability.resolve()}_setReadableStream(D){this._readableStream=D,D.on("readable",()=>{this._readCapability.resolve()}),D.on("end",()=>{D.destroy(),this._done=!0,this._readCapability.resolve()}),D.on("error",B=>{this._error(B)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new P.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b{constructor(D){this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new P.PromiseCapability;const B=D.source;this._isStreamingSupported=!B.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const D=this._readableStream.read();return D===null?(this._readCapability=new P.PromiseCapability,this.read()):(this._loaded+=D.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded}),{value:new Uint8Array(D).buffer,done:!1})}cancel(D){if(!this._readableStream){this._error(D);return}this._readableStream.destroy(D)}_error(D){this._storedError=D,this._readCapability.resolve()}_setReadableStream(D){this._readableStream=D,D.on("readable",()=>{this._readCapability.resolve()}),D.on("end",()=>{D.destroy(),this._done=!0,this._readCapability.resolve()}),D.on("error",B=>{this._error(B)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class y extends E{constructor(D){super(D);const B=et=>{if(et.statusCode===404){const qt=new P.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=qt,this._headersCapability.reject(qt);return}this._headersCapability.resolve(),this._setReadableStream(et);const At=qt=>this._readableStream.headers[qt.toLowerCase()],{allowRangeRequests:St,suggestedLength:Ct}=(0,W.validateRangeRequestCapabilities)({getResponseHeader:At,isHttp:D.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=St,this._contentLength=Ct||this._contentLength,this._filename=(0,W.extractFilenameFromHeader)(At)};this._request=null,this._url.protocol==="http:"?this._request=v.request(X(this._url,D.httpHeaders),B):this._request=$.request(X(this._url,D.httpHeaders),B),this._request.on("error",et=>{this._storedError=et,this._headersCapability.reject(et)}),this._request.end()}}class V extends b{constructor(D,B,et){super(D),this._httpHeaders={};for(const St in D.httpHeaders){const Ct=D.httpHeaders[St];Ct!==void 0&&(this._httpHeaders[St]=Ct)}this._httpHeaders.Range=`bytes=${B}-${et-1}`;const At=St=>{if(St.statusCode===404){const Ct=new P.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ct;return}this._setReadableStream(St)};this._request=null,this._url.protocol==="http:"?this._request=v.request(X(this._url,this._httpHeaders),At):this._request=$.request(X(this._url,this._httpHeaders),At),this._request.on("error",St=>{this._storedError=St}),this._request.end()}}class Y extends E{constructor(D){super(D);let B=decodeURIComponent(this._url.path);A.test(this._url.href)&&(B=B.replace(/^\//,"")),j.lstat(B,(et,At)=>{if(et){et.code==="ENOENT"&&(et=new P.MissingPDFException(`Missing PDF "${B}".`)),this._storedError=et,this._headersCapability.reject(et);return}this._contentLength=At.size,this._setReadableStream(j.createReadStream(B)),this._headersCapability.resolve()})}}class M extends b{constructor(D,B,et){super(D);let At=decodeURIComponent(this._url.path);A.test(this._url.href)&&(At=At.replace(/^\//,"")),this._setReadableStream(j.createReadStream(At,{start:B,end:et-1}))}}it()}catch(dt){it(dt)}},1)},738:(Zt,Nt,lt)=>{lt.a(Zt,async(c,it)=>{try{lt.d(Nt,{NodeCMapReaderFactory:()=>A,NodeCanvasFactory:()=>z,NodeFilterFactory:()=>$,NodeStandardFontDataFactory:()=>L});var P=lt(822),W=lt(266);let dt,X,j;if(W.isNodeJS){dt=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);try{X=await Ge(()=>import("./__vite-browser-external-BIHI7g3E.js"),[])}catch{}try{j=await Ge(()=>import("./path2d-polyfill.esm-Bqvoz_29.js"),[])}catch{}}const v=function(E){return new Promise((b,y)=>{dt.readFile(E,(V,Y)=>{if(V||!Y){y(new Error(V));return}b(new Uint8Array(Y))})})};class $ extends P.BaseFilterFactory{}class z extends P.BaseCanvasFactory{_createCanvas(b,y){return X.createCanvas(b,y)}}class A extends P.BaseCMapReaderFactory{_fetchData(b,y){return v(b).then(V=>({cMapData:V,compressionType:y}))}}class L extends P.BaseStandardFontDataFactory{_fetchData(b){return v(b)}}it()}catch(dt){it(dt)}},1)},890:(Zt,Nt,lt)=>{var X,j,v,$,z,A,Bi;lt.d(Nt,{OptionalContentConfig:()=>dt});var c=lt(266),it=lt(825);const P=Symbol("INTERNAL");class W{constructor(b,y){F(this,X,!0);this.name=b,this.intent=y}get visible(){return t(this,X)}_setVisible(b,y){b!==P&&(0,c.unreachable)("Internal method `_setVisible` called."),R(this,X,y)}}X=new WeakMap;class dt{constructor(b){F(this,A);F(this,j,null);F(this,v,new Map);F(this,$,null);F(this,z,null);if(this.name=null,this.creator=null,b!==null){this.name=b.name,this.creator=b.creator,R(this,z,b.order);for(const y of b.groups)t(this,v).set(y.id,new W(y.name,y.intent));if(b.baseState==="OFF")for(const y of t(this,v).values())y._setVisible(P,!1);for(const y of b.on)t(this,v).get(y)._setVisible(P,!0);for(const y of b.off)t(this,v).get(y)._setVisible(P,!1);R(this,$,this.getHash())}}isVisible(b){if(t(this,v).size===0)return!0;if(!b)return(0,c.warn)("Optional content group not defined."),!0;if(b.type==="OCG")return t(this,v).has(b.id)?t(this,v).get(b.id).visible:((0,c.warn)(`Optional content group not found: ${b.id}`),!0);if(b.type==="OCMD"){if(b.expression)return x(this,A,Bi).call(this,b.expression);if(!b.policy||b.policy==="AnyOn"){for(const y of b.ids){if(!t(this,v).has(y))return(0,c.warn)(`Optional content group not found: ${y}`),!0;if(t(this,v).get(y).visible)return!0}return!1}else if(b.policy==="AllOn"){for(const y of b.ids){if(!t(this,v).has(y))return(0,c.warn)(`Optional content group not found: ${y}`),!0;if(!t(this,v).get(y).visible)return!1}return!0}else if(b.policy==="AnyOff"){for(const y of b.ids){if(!t(this,v).has(y))return(0,c.warn)(`Optional content group not found: ${y}`),!0;if(!t(this,v).get(y).visible)return!0}return!1}else if(b.policy==="AllOff"){for(const y of b.ids){if(!t(this,v).has(y))return(0,c.warn)(`Optional content group not found: ${y}`),!0;if(t(this,v).get(y).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${b.policy}.`),!0}return(0,c.warn)(`Unknown group type ${b.type}.`),!0}setVisibility(b,y=!0){if(!t(this,v).has(b)){(0,c.warn)(`Optional content group not found: ${b}`);return}t(this,v).get(b)._setVisible(P,!!y),R(this,j,null)}get hasInitialVisibility(){return t(this,$)===null||this.getHash()===t(this,$)}getOrder(){return t(this,v).size?t(this,z)?t(this,z).slice():[...t(this,v).keys()]:null}getGroups(){return t(this,v).size>0?(0,c.objectFromMap)(t(this,v)):null}getGroup(b){return t(this,v).get(b)||null}getHash(){if(t(this,j)!==null)return t(this,j);const b=new it.MurmurHash3_64;for(const[y,V]of t(this,v))b.update(`${y}:${V.visible}`);return R(this,j,b.hexdigest())}}j=new WeakMap,v=new WeakMap,$=new WeakMap,z=new WeakMap,A=new WeakSet,Bi=function(b){const y=b.length;if(y<2)return!0;const V=b[0];for(let Y=1;Y<y;Y++){const M=b[Y];let H;if(Array.isArray(M))H=x(this,A,Bi).call(this,M);else if(t(this,v).has(M))H=t(this,v).get(M).visible;else return(0,c.warn)(`Optional content group not found: ${M}`),!0;switch(V){case"And":if(!H)return!1;break;case"Or":if(H)return!0;break;case"Not":return!H;default:return!0}}return V==="And"}},739:(Zt,Nt,lt)=>{lt.d(Nt,{renderTextLayer:()=>E,updateTextLayer:()=>b});var c=lt(266),it=lt(473);const P=1e5,W=30,dt=.8,X=new Map;function j(y,V){let Y;if(V&&c.FeatureTest.isOffscreenCanvasSupported)Y=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{const M=document.createElement("canvas");M.width=M.height=y,Y=M.getContext("2d",{alpha:!1})}return Y}function v(y,V){const Y=X.get(y);if(Y)return Y;const M=j(W,V);M.font=`${W}px ${y}`;const H=M.measureText("");let D=H.fontBoundingBoxAscent,B=Math.abs(H.fontBoundingBoxDescent);if(D){const At=D/(D+B);return X.set(y,At),M.canvas.width=M.canvas.height=0,At}M.strokeStyle="red",M.clearRect(0,0,W,W),M.strokeText("g",0,0);let et=M.getImageData(0,0,W,W).data;B=0;for(let At=et.length-1-3;At>=0;At-=4)if(et[At]>0){B=Math.ceil(At/4/W);break}M.clearRect(0,0,W,W),M.strokeText("A",0,W),et=M.getImageData(0,0,W,W).data,D=0;for(let At=0,St=et.length;At<St;At+=4)if(et[At]>0){D=W-Math.floor(At/4/W);break}if(M.canvas.width=M.canvas.height=0,D){const At=D/(D+B);return X.set(y,At),At}return X.set(y,dt),dt}function $(y,V,Y){const M=document.createElement("span"),H={angle:0,canvasWidth:0,hasText:V.str!=="",hasEOL:V.hasEOL,fontSize:0};y._textDivs.push(M);const D=c.Util.transform(y._transform,V.transform);let B=Math.atan2(D[1],D[0]);const et=Y[V.fontName];et.vertical&&(B+=Math.PI/2);const At=y._fontInspectorEnabled&&et.fontSubstitution||et.fontFamily,St=Math.hypot(D[2],D[3]),Ct=St*v(At,y._isOffscreenCanvasSupported);let qt,Yt;B===0?(qt=D[4],Yt=D[5]-Ct):(qt=D[4]+Ct*Math.sin(B),Yt=D[5]-Ct*Math.cos(B));const ie="calc(var(--scale-factor)*",Kt=M.style;y._container===y._rootContainer?(Kt.left=`${(100*qt/y._pageWidth).toFixed(2)}%`,Kt.top=`${(100*Yt/y._pageHeight).toFixed(2)}%`):(Kt.left=`${ie}${qt.toFixed(2)}px)`,Kt.top=`${ie}${Yt.toFixed(2)}px)`),Kt.fontSize=`${ie}${St.toFixed(2)}px)`,Kt.fontFamily=At,H.fontSize=St,M.setAttribute("role","presentation"),M.textContent=V.str,M.dir=V.dir,y._fontInspectorEnabled&&(M.dataset.fontName=et.fontSubstitutionLoadedName||V.fontName),B!==0&&(H.angle=B*(180/Math.PI));let Bt=!1;if(V.str.length>1)Bt=!0;else if(V.str!==" "&&V.transform[0]!==V.transform[3]){const Ut=Math.abs(V.transform[0]),jt=Math.abs(V.transform[3]);Ut!==jt&&Math.max(Ut,jt)/Math.min(Ut,jt)>1.5&&(Bt=!0)}Bt&&(H.canvasWidth=et.vertical?V.height:V.width),y._textDivProperties.set(M,H),y._isReadableStream&&y._layoutText(M)}function z(y){const{div:V,scale:Y,properties:M,ctx:H,prevFontSize:D,prevFontFamily:B}=y,{style:et}=V;let At="";if(M.canvasWidth!==0&&M.hasText){const{fontFamily:St}=et,{canvasWidth:Ct,fontSize:qt}=M;(D!==qt||B!==St)&&(H.font=`${qt*Y}px ${St}`,y.prevFontSize=qt,y.prevFontFamily=St);const{width:Yt}=H.measureText(V.textContent);Yt>0&&(At=`scaleX(${Ct*Y/Yt})`)}M.angle!==0&&(At=`rotate(${M.angle}deg) ${At}`),At.length>0&&(et.transform=At)}function A(y){if(y._canceled)return;const V=y._textDivs,Y=y._capability;if(V.length>P){Y.resolve();return}if(!y._isReadableStream)for(const M of V)y._layoutText(M);Y.resolve()}class L{constructor({textContentSource:V,container:Y,viewport:M,textDivs:H,textDivProperties:D,textContentItemsStr:B,isOffscreenCanvasSupported:et}){var Yt;this._textContentSource=V,this._isReadableStream=V instanceof ReadableStream,this._container=this._rootContainer=Y,this._textDivs=H||[],this._textContentItemsStr=B||[],this._isOffscreenCanvasSupported=et,this._fontInspectorEnabled=!!((Yt=globalThis.FontInspector)!=null&&Yt.enabled),this._reader=null,this._textDivProperties=D||new WeakMap,this._canceled=!1,this._capability=new c.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:j(0,et)};const{pageWidth:At,pageHeight:St,pageX:Ct,pageY:qt}=M.rawDims;this._transform=[1,0,0,-1,-Ct,qt+St],this._pageWidth=At,this._pageHeight=St,(0,it.setLayerDimensions)(Y,M),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new c.AbortException("TextLayer task cancelled."))}_processItems(V,Y){for(const M of V){if(M.str===void 0){if(M.type==="beginMarkedContentProps"||M.type==="beginMarkedContent"){const H=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),M.id!==null&&this._container.setAttribute("id",`${M.id}`),H.append(this._container)}else M.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(M.str),$(this,M,Y)}}_layoutText(V){const Y=this._layoutTextParams.properties=this._textDivProperties.get(V);if(this._layoutTextParams.div=V,z(this._layoutTextParams),Y.hasText&&this._container.append(V),Y.hasEOL){const M=document.createElement("br");M.setAttribute("role","presentation"),this._container.append(M)}}_render(){const V=new c.PromiseCapability;let Y=Object.create(null);if(this._isReadableStream){const M=()=>{this._reader.read().then(({value:H,done:D})=>{if(D){V.resolve();return}Object.assign(Y,H.styles),this._processItems(H.items,Y),M()},V.reject)};this._reader=this._textContentSource.getReader(),M()}else if(this._textContentSource){const{items:M,styles:H}=this._textContentSource;this._processItems(M,H),V.resolve()}else throw new Error('No "textContentSource" parameter specified.');V.promise.then(()=>{Y=null,A(this)},this._capability.reject)}}function E(y){const V=new L(y);return V._render(),V}function b({container:y,viewport:V,textDivs:Y,textDivProperties:M,isOffscreenCanvasSupported:H,mustRotate:D=!0,mustRescale:B=!0}){if(D&&(0,it.setLayerDimensions)(y,{rotation:V.rotation}),B){const et=j(0,H),At={prevFontSize:null,prevFontFamily:null,div:null,scale:V.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:et};for(const St of Y)At.properties=M.get(St),At.div=St,z(At)}}},92:(Zt,Nt,lt)=>{lt.d(Nt,{PDFDataTransportStream:()=>P});var c=lt(266),it=lt(473);class P{constructor({length:j,initialData:v,progressiveDone:$=!1,contentDispositionFilename:z=null,disableRange:A=!1,disableStream:L=!1},E){if((0,c.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=$,this._contentDispositionFilename=z,(v==null?void 0:v.length)>0){const b=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(b)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!L,this._isRangeSupported=!A,this._contentLength=j,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((b,y)=>{this._onReceiveData({begin:b,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((b,y)=>{this._onProgress({loaded:b,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(b=>{this._onReceiveData({chunk:b})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:j,chunk:v}){const $=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;if(j===void 0)this._fullRequestReader?this._fullRequestReader._enqueue($):this._queuedChunks.push($);else{const z=this._rangeReaders.some(function(A){return A._begin!==j?!1:(A._enqueue($),!0)});(0,c.assert)(z,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var j;return((j=this._fullRequestReader)==null?void 0:j._loaded)??0}_onProgress(j){var v,$,z,A;j.total===void 0?($=(v=this._rangeReaders[0])==null?void 0:v.onProgress)==null||$.call(v,{loaded:j.loaded}):(A=(z=this._fullRequestReader)==null?void 0:z.onProgress)==null||A.call(z,{loaded:j.loaded,total:j.total})}_onProgressiveDone(){var j;(j=this._fullRequestReader)==null||j.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(j){const v=this._rangeReaders.indexOf(j);v>=0&&this._rangeReaders.splice(v,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const j=this._queuedChunks;return this._queuedChunks=null,new W(this,j,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(j,v){if(v<=this._progressiveDataLength)return null;const $=new dt(this,j,v);return this._pdfDataRangeTransport.requestDataRange(j,v),this._rangeReaders.push($),$}cancelAllRequests(j){var v;(v=this._fullRequestReader)==null||v.cancel(j);for(const $ of this._rangeReaders.slice(0))$.cancel(j);this._pdfDataRangeTransport.abort()}}class W{constructor(j,v,$=!1,z=null){this._stream=j,this._done=$||!1,this._filename=(0,it.isPdfFile)(z)?z:null,this._queuedChunks=v||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),j._fullRequestReader=this,this.onProgress=null}_enqueue(j){this._done||(this._requests.length>0?this._requests.shift().resolve({value:j,done:!1}):this._queuedChunks.push(j),this._loaded+=j.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const j=new c.PromiseCapability;return this._requests.push(j),j.promise}cancel(j){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dt{constructor(j,v,$){this._stream=j,this._begin=v,this._end=$,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(j){if(!this._done){if(this._requests.length===0)this._queuedChunk=j;else{this._requests.shift().resolve({value:j,done:!1});for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const j=new c.PromiseCapability;return this._requests.push(j),j.promise}cancel(j){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},368:(Zt,Nt,lt)=>{lt.d(Nt,{GlobalWorkerOptions:()=>c});const c=Object.create(null);c.workerPort=null,c.workerSrc=""},160:(Zt,Nt,lt)=>{lt.d(Nt,{XfaLayer:()=>it});var c=lt(521);class it{static setupStorage(W,dt,X,j,v){const $=j.getValue(dt,{value:null});switch(X.name){case"textarea":if($.value!==null&&(W.textContent=$.value),v==="print")break;W.addEventListener("input",z=>{j.setValue(dt,{value:z.target.value})});break;case"input":if(X.attributes.type==="radio"||X.attributes.type==="checkbox"){if($.value===X.attributes.xfaOn?W.setAttribute("checked",!0):$.value===X.attributes.xfaOff&&W.removeAttribute("checked"),v==="print")break;W.addEventListener("change",z=>{j.setValue(dt,{value:z.target.checked?z.target.getAttribute("xfaOn"):z.target.getAttribute("xfaOff")})})}else{if($.value!==null&&W.setAttribute("value",$.value),v==="print")break;W.addEventListener("input",z=>{j.setValue(dt,{value:z.target.value})})}break;case"select":if($.value!==null){W.setAttribute("value",$.value);for(const z of X.children)z.attributes.value===$.value?z.attributes.selected=!0:z.attributes.hasOwnProperty("selected")&&delete z.attributes.selected}W.addEventListener("input",z=>{const A=z.target.options,L=A.selectedIndex===-1?"":A[A.selectedIndex].value;j.setValue(dt,{value:L})});break}}static setAttributes({html:W,element:dt,storage:X=null,intent:j,linkService:v}){const{attributes:$}=dt,z=W instanceof HTMLAnchorElement;$.type==="radio"&&($.name=`${$.name}-${j}`);for(const[A,L]of Object.entries($))if(L!=null)switch(A){case"class":L.length&&W.setAttribute(A,L.join(" "));break;case"dataId":break;case"id":W.setAttribute("data-element-id",L);break;case"style":Object.assign(W.style,L);break;case"textContent":W.textContent=L;break;default:(!z||A!=="href"&&A!=="newWindow")&&W.setAttribute(A,L)}z&&v.addLinkAttributes(W,$.href,$.newWindow),X&&$.dataId&&this.setupStorage(W,$.dataId,dt,X)}static render(W){var b,y;const dt=W.annotationStorage,X=W.linkService,j=W.xfaHtml,v=W.intent||"display",$=document.createElement(j.name);j.attributes&&this.setAttributes({html:$,element:j,intent:v,linkService:X});const z=v!=="richText",A=W.div;if(A.append($),W.viewport){const V=`matrix(${W.viewport.transform.join(",")})`;A.style.transform=V}z&&A.setAttribute("class","xfaLayer xfaFont");const L=[];if(j.children.length===0){if(j.value){const V=document.createTextNode(j.value);$.append(V),z&&c.XfaText.shouldBuildText(j.name)&&L.push(V)}return{textDivs:L}}const E=[[j,-1,$]];for(;E.length>0;){const[V,Y,M]=E.at(-1);if(Y+1===V.children.length){E.pop();continue}const H=V.children[++E.at(-1)[1]];if(H===null)continue;const{name:D}=H;if(D==="#text"){const et=document.createTextNode(H.value);L.push(et),M.append(et);continue}const B=(b=H==null?void 0:H.attributes)!=null&&b.xmlns?document.createElementNS(H.attributes.xmlns,D):document.createElement(D);if(M.append(B),H.attributes&&this.setAttributes({html:B,element:H,storage:dt,intent:v,linkService:X}),((y=H.children)==null?void 0:y.length)>0)E.push([H,-1,B]);else if(H.value){const et=document.createTextNode(H.value);z&&c.XfaText.shouldBuildText(D)&&L.push(et),B.append(et)}}for(const V of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))V.setAttribute("readOnly",!0);return{textDivs:L}}static update(W){const dt=`matrix(${W.viewport.transform.join(",")})`;W.div.style.transform=dt,W.div.hidden=!1}}},521:(Zt,Nt,lt)=>{lt.d(Nt,{XfaText:()=>c});class c{static textContent(P){const W=[],dt={items:W,styles:Object.create(null)};function X(j){var z;if(!j)return;let v=null;const $=j.name;if($==="#text")v=j.value;else if(c.shouldBuildText($))(z=j==null?void 0:j.attributes)!=null&&z.textContent?v=j.attributes.textContent:j.value&&(v=j.value);else return;if(v!==null&&W.push({str:v}),!!j.children)for(const A of j.children)X(A)}return X(P),dt}static shouldBuildText(P){return!(P==="textarea"||P==="input"||P==="option"||P==="select")}}},907:(Zt,Nt,lt)=>{lt.a(Zt,async(c,it)=>{try{lt.d(Nt,{AbortException:()=>P.AbortException,AnnotationEditorLayer:()=>j.AnnotationEditorLayer,AnnotationEditorParamsType:()=>P.AnnotationEditorParamsType,AnnotationEditorType:()=>P.AnnotationEditorType,AnnotationEditorUIManager:()=>v.AnnotationEditorUIManager,AnnotationLayer:()=>$.AnnotationLayer,AnnotationMode:()=>P.AnnotationMode,CMapCompressionType:()=>P.CMapCompressionType,ColorPicker:()=>z.ColorPicker,DOMSVGFactory:()=>dt.DOMSVGFactory,DrawLayer:()=>A.DrawLayer,FeatureTest:()=>P.FeatureTest,GlobalWorkerOptions:()=>L.GlobalWorkerOptions,ImageKind:()=>P.ImageKind,InvalidPDFException:()=>P.InvalidPDFException,MissingPDFException:()=>P.MissingPDFException,OPS:()=>P.OPS,Outliner:()=>E.Outliner,PDFDataRangeTransport:()=>W.PDFDataRangeTransport,PDFDateString:()=>dt.PDFDateString,PDFWorker:()=>W.PDFWorker,PasswordResponses:()=>P.PasswordResponses,PermissionFlag:()=>P.PermissionFlag,PixelsPerInch:()=>dt.PixelsPerInch,PromiseCapability:()=>P.PromiseCapability,RenderingCancelledException:()=>dt.RenderingCancelledException,UnexpectedResponseException:()=>P.UnexpectedResponseException,Util:()=>P.Util,VerbosityLevel:()=>P.VerbosityLevel,XfaLayer:()=>b.XfaLayer,build:()=>W.build,createValidAbsoluteUrl:()=>P.createValidAbsoluteUrl,fetchData:()=>dt.fetchData,getDocument:()=>W.getDocument,getFilenameFromUrl:()=>dt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>dt.getPdfFilenameFromUrl,getXfaPageViewport:()=>dt.getXfaPageViewport,isDataScheme:()=>dt.isDataScheme,isPdfFile:()=>dt.isPdfFile,noContextMenu:()=>dt.noContextMenu,normalizeUnicode:()=>P.normalizeUnicode,renderTextLayer:()=>X.renderTextLayer,setLayerDimensions:()=>dt.setLayerDimensions,shadow:()=>P.shadow,updateTextLayer:()=>X.updateTextLayer,version:()=>W.version});var P=lt(266),W=lt(406),dt=lt(473),X=lt(739),j=lt(629),v=lt(812),$=lt(640),z=lt(97),A=lt(423),L=lt(368),E=lt(405),b=lt(160),y=c([W]);W=(y.then?(await y)():y)[0];const V="4.0.379",Y="9e14d04fd";it()}catch(V){it(V)}})},694:(Zt,Nt,lt)=>{var X,Ca,Pa,Ns;lt.d(Nt,{MessageHandler:()=>dt});var c=lt(266);const it={UNKNOWN:0,DATA:1,ERROR:2},P={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function W(z){switch(z instanceof Error||typeof z=="object"&&z!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),z.name){case"AbortException":return new c.AbortException(z.message);case"MissingPDFException":return new c.MissingPDFException(z.message);case"PasswordException":return new c.PasswordException(z.message,z.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(z.message,z.status);case"UnknownErrorException":return new c.UnknownErrorException(z.message,z.details);default:return new c.UnknownErrorException(z.message,z.toString())}}class dt{constructor(A,L,E){F(this,X);this.sourceName=A,this.targetName=L,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=b=>{const y=b.data;if(y.targetName!==this.sourceName)return;if(y.stream){x(this,X,Pa).call(this,y);return}if(y.callback){const Y=y.callbackId,M=this.callbackCapabilities[Y];if(!M)throw new Error(`Cannot resolve callback ${Y}`);if(delete this.callbackCapabilities[Y],y.callback===it.DATA)M.resolve(y.data);else if(y.callback===it.ERROR)M.reject(W(y.reason));else throw new Error("Unexpected callback case");return}const V=this.actionHandler[y.action];if(!V)throw new Error(`Unknown action from worker: ${y.action}`);if(y.callbackId){const Y=this.sourceName,M=y.sourceName;new Promise(function(H){H(V(y.data))}).then(function(H){E.postMessage({sourceName:Y,targetName:M,callback:it.DATA,callbackId:y.callbackId,data:H})},function(H){E.postMessage({sourceName:Y,targetName:M,callback:it.ERROR,callbackId:y.callbackId,reason:W(H)})});return}if(y.streamId){x(this,X,Ca).call(this,y);return}V(y.data)},E.addEventListener("message",this._onComObjOnMessage)}on(A,L){const E=this.actionHandler;if(E[A])throw new Error(`There is already an actionName called "${A}"`);E[A]=L}send(A,L,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:L},E)}sendWithPromise(A,L,E){const b=this.callbackId++,y=new c.PromiseCapability;this.callbackCapabilities[b]=y;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:b,data:L},E)}catch(V){y.reject(V)}return y.promise}sendWithStream(A,L,E,b){const y=this.streamId++,V=this.sourceName,Y=this.targetName,M=this.comObj;return new ReadableStream({start:H=>{const D=new c.PromiseCapability;return this.streamControllers[y]={controller:H,startCall:D,pullCall:null,cancelCall:null,isClosed:!1},M.postMessage({sourceName:V,targetName:Y,action:A,streamId:y,data:L,desiredSize:H.desiredSize},b),D.promise},pull:H=>{const D=new c.PromiseCapability;return this.streamControllers[y].pullCall=D,M.postMessage({sourceName:V,targetName:Y,stream:P.PULL,streamId:y,desiredSize:H.desiredSize}),D.promise},cancel:H=>{(0,c.assert)(H instanceof Error,"cancel must have a valid reason");const D=new c.PromiseCapability;return this.streamControllers[y].cancelCall=D,this.streamControllers[y].isClosed=!0,M.postMessage({sourceName:V,targetName:Y,stream:P.CANCEL,streamId:y,reason:W(H)}),D.promise}},E)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}X=new WeakSet,Ca=function(A){const L=A.streamId,E=this.sourceName,b=A.sourceName,y=this.comObj,V=this,Y=this.actionHandler[A.action],M={enqueue(H,D=1,B){if(this.isCancelled)return;const et=this.desiredSize;this.desiredSize-=D,et>0&&this.desiredSize<=0&&(this.sinkCapability=new c.PromiseCapability,this.ready=this.sinkCapability.promise),y.postMessage({sourceName:E,targetName:b,stream:P.ENQUEUE,streamId:L,chunk:H},B)},close(){this.isCancelled||(this.isCancelled=!0,y.postMessage({sourceName:E,targetName:b,stream:P.CLOSE,streamId:L}),delete V.streamSinks[L])},error(H){(0,c.assert)(H instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,y.postMessage({sourceName:E,targetName:b,stream:P.ERROR,streamId:L,reason:W(H)}))},sinkCapability:new c.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};M.sinkCapability.resolve(),M.ready=M.sinkCapability.promise,this.streamSinks[L]=M,new Promise(function(H){H(Y(A.data,M))}).then(function(){y.postMessage({sourceName:E,targetName:b,stream:P.START_COMPLETE,streamId:L,success:!0})},function(H){y.postMessage({sourceName:E,targetName:b,stream:P.START_COMPLETE,streamId:L,reason:W(H)})})},Pa=function(A){const L=A.streamId,E=this.sourceName,b=A.sourceName,y=this.comObj,V=this.streamControllers[L],Y=this.streamSinks[L];switch(A.stream){case P.START_COMPLETE:A.success?V.startCall.resolve():V.startCall.reject(W(A.reason));break;case P.PULL_COMPLETE:A.success?V.pullCall.resolve():V.pullCall.reject(W(A.reason));break;case P.PULL:if(!Y){y.postMessage({sourceName:E,targetName:b,stream:P.PULL_COMPLETE,streamId:L,success:!0});break}Y.desiredSize<=0&&A.desiredSize>0&&Y.sinkCapability.resolve(),Y.desiredSize=A.desiredSize,new Promise(function(M){var H;M((H=Y.onPull)==null?void 0:H.call(Y))}).then(function(){y.postMessage({sourceName:E,targetName:b,stream:P.PULL_COMPLETE,streamId:L,success:!0})},function(M){y.postMessage({sourceName:E,targetName:b,stream:P.PULL_COMPLETE,streamId:L,reason:W(M)})});break;case P.ENQUEUE:if((0,c.assert)(V,"enqueue should have stream controller"),V.isClosed)break;V.controller.enqueue(A.chunk);break;case P.CLOSE:if((0,c.assert)(V,"close should have stream controller"),V.isClosed)break;V.isClosed=!0,V.controller.close(),x(this,X,Ns).call(this,V,L);break;case P.ERROR:(0,c.assert)(V,"error should have stream controller"),V.controller.error(W(A.reason)),x(this,X,Ns).call(this,V,L);break;case P.CANCEL_COMPLETE:A.success?V.cancelCall.resolve():V.cancelCall.reject(W(A.reason)),x(this,X,Ns).call(this,V,L);break;case P.CANCEL:if(!Y)break;new Promise(function(M){var H;M((H=Y.onCancel)==null?void 0:H.call(Y,W(A.reason)))}).then(function(){y.postMessage({sourceName:E,targetName:b,stream:P.CANCEL_COMPLETE,streamId:L,success:!0})},function(M){y.postMessage({sourceName:E,targetName:b,stream:P.CANCEL_COMPLETE,streamId:L,reason:W(M)})}),Y.sinkCapability.reject(W(A.reason)),Y.isCancelled=!0,delete this.streamSinks[L];break;default:throw new Error("Unexpected stream case")}},Ns=async function(A,L){var E,b,y;await Promise.allSettled([(E=A.startCall)==null?void 0:E.promise,(b=A.pullCall)==null?void 0:b.promise,(y=A.cancelCall)==null?void 0:y.promise]),delete this.streamControllers[L]}},825:(Zt,Nt,lt)=>{lt.d(Nt,{MurmurHash3_64:()=>dt});var c=lt(266);const it=3285377520,P=4294901760,W=65535;class dt{constructor(j){this.h1=j?j&4294967295:it,this.h2=j?j&4294967295:it}update(j){let v,$;if(typeof j=="string"){v=new Uint8Array(j.length*2),$=0;for(let B=0,et=j.length;B<et;B++){const At=j.charCodeAt(B);At<=255?v[$++]=At:(v[$++]=At>>>8,v[$++]=At&255)}}else if((0,c.isArrayBuffer)(j))v=j.slice(),$=v.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const z=$>>2,A=$-z*4,L=new Uint32Array(v.buffer,0,z);let E=0,b=0,y=this.h1,V=this.h2;const Y=3432918353,M=461845907,H=Y&W,D=M&W;for(let B=0;B<z;B++)B&1?(E=L[B],E=E*Y&P|E*H&W,E=E<<15|E>>>17,E=E*M&P|E*D&W,y^=E,y=y<<13|y>>>19,y=y*5+3864292196):(b=L[B],b=b*Y&P|b*H&W,b=b<<15|b>>>17,b=b*M&P|b*D&W,V^=b,V=V<<13|V>>>19,V=V*5+3864292196);switch(E=0,A){case 3:E^=v[z*4+2]<<16;case 2:E^=v[z*4+1]<<8;case 1:E^=v[z*4],E=E*Y&P|E*H&W,E=E<<15|E>>>17,E=E*M&P|E*D&W,z&1?y^=E:V^=E}this.h1=y,this.h2=V}hexdigest(){let j=this.h1,v=this.h2;return j^=v>>>1,j=j*3981806797&P|j*36045&W,v=v*4283543511&P|((v<<16|j>>>16)*2950163797&P)>>>16,j^=v>>>1,j=j*444984403&P|j*60499&W,v=v*3301882366&P|((v<<16|j>>>16)*3120437893&P)>>>16,j^=v>>>1,(j>>>0).toString(16).padStart(8,"0")+(v>>>0).toString(16).padStart(8,"0")}}},266:(Zt,Nt,lt)=>{var G;lt.d(Nt,{AbortException:()=>Wt,AnnotationBorderStyleType:()=>y,AnnotationEditorParamsType:()=>z,AnnotationEditorPrefix:()=>v,AnnotationEditorType:()=>$,AnnotationMode:()=>j,AnnotationPrefix:()=>_,AnnotationType:()=>b,BaseException:()=>Bt,CMapCompressionType:()=>Y,FONT_IDENTITY_MATRIX:()=>P,FeatureTest:()=>_e,FormatError:()=>le,IDENTITY_MATRIX:()=>it,ImageKind:()=>E,InvalidPDFException:()=>ee,LINE_FACTOR:()=>dt,MAX_IMAGE_SIZE_TO_CACHE:()=>W,MissingPDFException:()=>$t,OPS:()=>M,PasswordException:()=>Ut,PasswordResponses:()=>H,PermissionFlag:()=>A,PromiseCapability:()=>e,RenderingIntentFlag:()=>X,TextRenderingMode:()=>L,UnexpectedResponseException:()=>te,UnknownErrorException:()=>jt,Util:()=>ue,VerbosityLevel:()=>V,assert:()=>qt,bytesToString:()=>Qt,createValidAbsoluteUrl:()=>ie,getUuid:()=>g,getVerbosityLevel:()=>et,info:()=>At,isArrayBuffer:()=>s,isNodeJS:()=>c,normalizeUnicode:()=>l,objectFromMap:()=>Jt,setVerbosityLevel:()=>B,shadow:()=>Kt,string32:()=>kt,stringToBytes:()=>me,unreachable:()=>Ct,warn:()=>St});const c=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),it=[1,0,0,1,0,0],P=[.001,0,0,.001,0,0],W=1e7,dt=1.35,X={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},j={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},v="pdfjs_internal_editor_",$={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},z={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32},A={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},L={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},E={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},b={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},y={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},V={ERRORS:0,WARNINGS:1,INFOS:5},Y={NONE:0,BINARY:1},M={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},H={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let D=V.WARNINGS;function B(w){Number.isInteger(w)&&(D=w)}function et(){return D}function At(w){D>=V.INFOS&&console.log(`Info: ${w}`)}function St(w){D>=V.WARNINGS&&console.log(`Warning: ${w}`)}function Ct(w){throw new Error(w)}function qt(w,r){w||Ct(r)}function Yt(w){switch(w==null?void 0:w.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ie(w,r=null,u=null){var I;if(!w)return null;try{if(u&&typeof w=="string"&&(u.addDefaultProtocol&&w.startsWith("www.")&&((I=w.match(/\./g))==null?void 0:I.length)>=2&&(w=`http://${w}`),u.tryConvertEncoding))try{w=O(w)}catch{}const at=r?new URL(w,r):new URL(w);if(Yt(at))return at}catch{}return null}function Kt(w,r,u,I=!1){return Object.defineProperty(w,r,{value:u,enumerable:!I,configurable:!0,writable:!1}),u}const Bt=function(){function w(r,u){this.constructor===w&&Ct("Cannot initialize BaseException."),this.message=r,this.name=u}return w.prototype=new Error,w.constructor=w,w}();class Ut extends Bt{constructor(r,u){super(r,"PasswordException"),this.code=u}}class jt extends Bt{constructor(r,u){super(r,"UnknownErrorException"),this.details=u}}class ee extends Bt{constructor(r){super(r,"InvalidPDFException")}}class $t extends Bt{constructor(r){super(r,"MissingPDFException")}}class te extends Bt{constructor(r,u){super(r,"UnexpectedResponseException"),this.status=u}}class le extends Bt{constructor(r){super(r,"FormatError")}}class Wt extends Bt{constructor(r){super(r,"AbortException")}}function Qt(w){(typeof w!="object"||(w==null?void 0:w.length)===void 0)&&Ct("Invalid argument for bytesToString");const r=w.length,u=8192;if(r<u)return String.fromCharCode.apply(null,w);const I=[];for(let at=0;at<r;at+=u){const nt=Math.min(at+u,r),st=w.subarray(at,nt);I.push(String.fromCharCode.apply(null,st))}return I.join("")}function me(w){typeof w!="string"&&Ct("Invalid argument for stringToBytes");const r=w.length,u=new Uint8Array(r);for(let I=0;I<r;++I)u[I]=w.charCodeAt(I)&255;return u}function kt(w){return String.fromCharCode(w>>24&255,w>>16&255,w>>8&255,w&255)}function Jt(w){const r=Object.create(null);for(const[u,I]of w)r[u]=I;return r}function ne(){const w=new Uint8Array(4);return w[0]=1,new Uint32Array(w.buffer,0,1)[0]===1}function be(){try{return new Function(""),!0}catch{return!1}}class _e{static get isLittleEndian(){return Kt(this,"isLittleEndian",ne())}static get isEvalSupported(){return Kt(this,"isEvalSupported",be())}static get isOffscreenCanvasSupported(){return Kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Kt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Kt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var r,u;return Kt(this,"isCSSRoundSupported",(u=(r=globalThis.CSS)==null?void 0:r.supports)==null?void 0:u.call(r,"width: round(1.5px, 1px)"))}}const ae=[...Array(256).keys()].map(w=>w.toString(16).padStart(2,"0"));class ue{static makeHexColor(r,u,I){return`#${ae[r]}${ae[u]}${ae[I]}`}static scaleMinMax(r,u){let I;r[0]?(r[0]<0&&(I=u[0],u[0]=u[1],u[1]=I),u[0]*=r[0],u[1]*=r[0],r[3]<0&&(I=u[2],u[2]=u[3],u[3]=I),u[2]*=r[3],u[3]*=r[3]):(I=u[0],u[0]=u[2],u[2]=I,I=u[1],u[1]=u[3],u[3]=I,r[1]<0&&(I=u[2],u[2]=u[3],u[3]=I),u[2]*=r[1],u[3]*=r[1],r[2]<0&&(I=u[0],u[0]=u[1],u[1]=I),u[0]*=r[2],u[1]*=r[2]),u[0]+=r[4],u[1]+=r[4],u[2]+=r[5],u[3]+=r[5]}static transform(r,u){return[r[0]*u[0]+r[2]*u[1],r[1]*u[0]+r[3]*u[1],r[0]*u[2]+r[2]*u[3],r[1]*u[2]+r[3]*u[3],r[0]*u[4]+r[2]*u[5]+r[4],r[1]*u[4]+r[3]*u[5]+r[5]]}static applyTransform(r,u){const I=r[0]*u[0]+r[1]*u[2]+u[4],at=r[0]*u[1]+r[1]*u[3]+u[5];return[I,at]}static applyInverseTransform(r,u){const I=u[0]*u[3]-u[1]*u[2],at=(r[0]*u[3]-r[1]*u[2]+u[2]*u[5]-u[4]*u[3])/I,nt=(-r[0]*u[1]+r[1]*u[0]+u[4]*u[1]-u[5]*u[0])/I;return[at,nt]}static getAxialAlignedBoundingBox(r,u){const I=this.applyTransform(r,u),at=this.applyTransform(r.slice(2,4),u),nt=this.applyTransform([r[0],r[3]],u),st=this.applyTransform([r[2],r[1]],u);return[Math.min(I[0],at[0],nt[0],st[0]),Math.min(I[1],at[1],nt[1],st[1]),Math.max(I[0],at[0],nt[0],st[0]),Math.max(I[1],at[1],nt[1],st[1])]}static inverseTransform(r){const u=r[0]*r[3]-r[1]*r[2];return[r[3]/u,-r[1]/u,-r[2]/u,r[0]/u,(r[2]*r[5]-r[4]*r[3])/u,(r[4]*r[1]-r[5]*r[0])/u]}static singularValueDecompose2dScale(r){const u=[r[0],r[2],r[1],r[3]],I=r[0]*u[0]+r[1]*u[2],at=r[0]*u[1]+r[1]*u[3],nt=r[2]*u[0]+r[3]*u[2],st=r[2]*u[1]+r[3]*u[3],gt=(I+st)/2,mt=Math.sqrt((I+st)**2-4*(I*st-nt*at))/2,Ft=gt+mt||1,a=gt-mt||1;return[Math.sqrt(Ft),Math.sqrt(a)]}static normalizeRect(r){const u=r.slice(0);return r[0]>r[2]&&(u[0]=r[2],u[2]=r[0]),r[1]>r[3]&&(u[1]=r[3],u[3]=r[1]),u}static intersect(r,u){const I=Math.max(Math.min(r[0],r[2]),Math.min(u[0],u[2])),at=Math.min(Math.max(r[0],r[2]),Math.max(u[0],u[2]));if(I>at)return null;const nt=Math.max(Math.min(r[1],r[3]),Math.min(u[1],u[3])),st=Math.min(Math.max(r[1],r[3]),Math.max(u[1],u[3]));return nt>st?null:[I,nt,at,st]}static bezierBoundingBox(r,u,I,at,nt,st,gt,mt){const Ft=[],a=[[],[]];let N,J,C,d,T,k,K,rt;for(let m=0;m<2;++m){if(m===0?(J=6*r-12*I+6*nt,N=-3*r+9*I-9*nt+3*gt,C=3*I-3*r):(J=6*u-12*at+6*st,N=-3*u+9*at-9*st+3*mt,C=3*at-3*u),Math.abs(N)<1e-12){if(Math.abs(J)<1e-12)continue;d=-C/J,0<d&&d<1&&Ft.push(d);continue}K=J*J-4*C*N,rt=Math.sqrt(K),!(K<0)&&(T=(-J+rt)/(2*N),0<T&&T<1&&Ft.push(T),k=(-J-rt)/(2*N),0<k&&k<1&&Ft.push(k))}let vt=Ft.length,ft;const It=vt;for(;vt--;)d=Ft[vt],ft=1-d,a[0][vt]=ft*ft*ft*r+3*ft*ft*d*I+3*ft*d*d*nt+d*d*d*gt,a[1][vt]=ft*ft*ft*u+3*ft*ft*d*at+3*ft*d*d*st+d*d*d*mt;return a[0][It]=r,a[1][It]=u,a[0][It+1]=gt,a[1][It+1]=mt,a[0].length=a[1].length=It+2,[Math.min(...a[0]),Math.min(...a[1]),Math.max(...a[0]),Math.max(...a[1])]}}function O(w){return decodeURIComponent(escape(w))}function s(w){return typeof w=="object"&&(w==null?void 0:w.byteLength)!==void 0}class e{constructor(){F(this,G,!1);this.promise=new Promise((r,u)=>{this.resolve=I=>{R(this,G,!0),r(I)},this.reject=I=>{R(this,G,!0),u(I)}})}get settled(){return t(this,G)}}G=new WeakMap;let i=null,o=null;function l(w){return i||(i=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,o=new Map([["\uFB05","\u017Ft"]])),w.replaceAll(i,(r,u,I)=>u?u.normalize("NFKC"):o.get(I))}function g(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const w=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(w);else for(let r=0;r<32;r++)w[r]=Math.floor(Math.random()*255);return Qt(w)}const _="pdfjs_internal_id_"}},Ae={};function ve(Zt){var Nt=Ae[Zt];if(Nt!==void 0)return Nt.exports;var lt=Ae[Zt]={exports:{}};return fe[Zt](lt,lt.exports,ve),lt.exports}(()=>{var Zt=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",Nt=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",lt=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=P=>{P&&P.d<1&&(P.d=1,P.forEach(W=>W.r--),P.forEach(W=>W.r--?W.r++:W()))},it=P=>P.map(W=>{if(W!==null&&typeof W=="object"){if(W[Zt])return W;if(W.then){var dt=[];dt.d=0,W.then(v=>{X[Nt]=v,c(dt)},v=>{X[lt]=v,c(dt)});var X={};return X[Zt]=v=>v(dt),X}}var j={};return j[Zt]=v=>{},j[Nt]=W,j});ve.a=(P,W,dt)=>{var X;dt&&((X=[]).d=-1);var j=new Set,v=P.exports,$,z,A,L=new Promise((E,b)=>{A=b,z=E});L[Nt]=v,L[Zt]=E=>(X&&E(X),j.forEach(E),L.catch(b=>{})),P.exports=L,W(E=>{$=it(E);var b,y=()=>$.map(Y=>{if(Y[lt])throw Y[lt];return Y[Nt]}),V=new Promise(Y=>{b=()=>Y(y),b.r=0;var M=H=>H!==X&&!j.has(H)&&(j.add(H),H&&!H.d&&(b.r++,H.push(b)));$.map(H=>H[Zt](M))});return b.r?V:y()},E=>(E?A(L[lt]=E):z(v),c(X))),X&&X.d<0&&(X.d=0)}})(),ve.d=(Zt,Nt)=>{for(var lt in Nt)ve.o(Nt,lt)&&!ve.o(Zt,lt)&&Object.defineProperty(Zt,lt,{enumerable:!0,get:Nt[lt]})},ve.o=(Zt,Nt)=>Object.prototype.hasOwnProperty.call(Zt,Nt);var Xt=ve(907);Xt=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=Xt),ji=Xt.AbortException,Vi=Xt.AnnotationEditorLayer,$i=Xt.AnnotationEditorParamsType,Ui=Xt.AnnotationEditorType,Gi=Xt.AnnotationEditorUIManager,qi=Xt.AnnotationLayer,Wi=Xt.AnnotationMode,Xi=Xt.CMapCompressionType,Ki=Xt.ColorPicker,Yi=Xt.DOMSVGFactory,Qi=Xt.DrawLayer,Ji=Xt.FeatureTest,Zi=Xt.GlobalWorkerOptions,tn=Xt.ImageKind,en=Xt.InvalidPDFException,sn=Xt.MissingPDFException,nn=Xt.OPS,an=Xt.Outliner,rn=Xt.PDFDataRangeTransport,on=Xt.PDFDateString,hn=Xt.PDFWorker,ln=Xt.PasswordResponses,cn=Xt.PermissionFlag,dn=Xt.PixelsPerInch,un=Xt.PromiseCapability,pn=Xt.RenderingCancelledException,gn=Xt.UnexpectedResponseException,mn=Xt.Util,fn=Xt.VerbosityLevel,An=Xt.XfaLayer,bn=Xt.build,vn=Xt.createValidAbsoluteUrl,yn=Xt.fetchData,_n=Xt.getDocument,En=Xt.getFilenameFromUrl,xn=Xt.getPdfFilenameFromUrl,wn=Xt.getXfaPageViewport,Sn=Xt.isDataScheme,Tn=Xt.isPdfFile,Cn=Xt.noContextMenu,Pn=Xt.normalizeUnicode,kn=Xt.renderTextLayer,Mn=Xt.setLayerDimensions,Rn=Xt.shadow,Fn=Xt.updateTextLayer,In=Xt.version});export{ji as AbortException,Vi as AnnotationEditorLayer,$i as AnnotationEditorParamsType,Ui as AnnotationEditorType,Gi as AnnotationEditorUIManager,qi as AnnotationLayer,Wi as AnnotationMode,Xi as CMapCompressionType,Ki as ColorPicker,Yi as DOMSVGFactory,Qi as DrawLayer,Ji as FeatureTest,Zi as GlobalWorkerOptions,tn as ImageKind,en as InvalidPDFException,sn as MissingPDFException,nn as OPS,an as Outliner,rn as PDFDataRangeTransport,on as PDFDateString,hn as PDFWorker,ln as PasswordResponses,cn as PermissionFlag,dn as PixelsPerInch,un as PromiseCapability,pn as RenderingCancelledException,gn as UnexpectedResponseException,mn as Util,fn as VerbosityLevel,An as XfaLayer,Ba as __tla,bn as build,vn as createValidAbsoluteUrl,yn as fetchData,_n as getDocument,En as getFilenameFromUrl,xn as getPdfFilenameFromUrl,wn as getXfaPageViewport,Sn as isDataScheme,Tn as isPdfFile,Cn as noContextMenu,Pn as normalizeUnicode,kn as renderTextLayer,Mn as setLayerDimensions,Rn as shadow,Fn as updateTextLayer,In as version};
