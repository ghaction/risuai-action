function h(){}h.prototype={diff:function(t,e){var n,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=r.callback;typeof r=="function"&&(u=r,r={});var o=this;function a(s){return s=o.postProcess(s,r),u?(setTimeout(function(){u(s)},0),!0):s}t=this.castInput(t,r),e=this.castInput(e,r),t=this.removeEmpty(this.tokenize(t,r)),e=this.removeEmpty(this.tokenize(e,r));var i=e.length,l=t.length,c=1,f=i+l;r.maxEditLength!=null&&(f=Math.min(f,r.maxEditLength));var p=(n=r.timeout)!==null&&n!==void 0?n:1/0,d=Date.now()+p,v=[{oldPos:-1,lastComponent:void 0}],m=this.extractCommon(v[0],e,t,0,r);if(v[0].oldPos+1>=l&&m+1>=i)return a(F(o,v[0].lastComponent,e,t,o.useLongestToken));var y=-1/0,C=1/0;function T(){for(var s=Math.max(y,-c);s<=Math.min(C,c);s+=2){var g=void 0,w=v[s-1],P=v[s+1];w&&(v[s-1]=void 0);var L=!1;if(P){var D=P.oldPos-s;L=P&&0<=D&&D<i}var J=w&&w.oldPos+1<l;if(!L&&!J){v[s]=void 0;continue}if(!J||L&&w.oldPos<P.oldPos?g=o.addToPath(P,!0,!1,0,r):g=o.addToPath(w,!1,!0,1,r),m=o.extractCommon(g,e,t,s,r),g.oldPos+1>=l&&m+1>=i)return a(F(o,g.lastComponent,e,t,o.useLongestToken));v[s]=g,g.oldPos+1>=l&&(C=Math.min(C,s-1)),m+1>=i&&(y=Math.max(y,s+1))}c++}if(u)(function s(){setTimeout(function(){if(c>f||Date.now()>d)return u();T()||s()},0)})();else for(;c<=f&&Date.now()<=d;){var b=T();if(b)return b}},addToPath:function(t,e,n,r,u){var o=t.lastComponent;return o&&!u.oneChangePerToken&&o.added===e&&o.removed===n?{oldPos:t.oldPos+r,lastComponent:{count:o.count+1,added:e,removed:n,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+r,lastComponent:{count:1,added:e,removed:n,previousComponent:o}}},extractCommon:function(t,e,n,r,u){for(var o=e.length,a=n.length,i=t.oldPos,l=i-r,c=0;l+1<o&&i+1<a&&this.equals(n[i+1],e[l+1],u);)l++,i++,c++,u.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return c&&!u.oneChangePerToken&&(t.lastComponent={count:c,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=i,l},equals:function(t,e,n){return n.comparator?n.comparator(t,e):t===e||n.ignoreCase&&t.toLowerCase()===e.toLowerCase()},removeEmpty:function(t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(t[n]);return e},castInput:function(t){return t},tokenize:function(t){return Array.from(t)},join:function(t){return t.join("")},postProcess:function(t){return t}};function F(t,e,n,r,u){for(var o=[],a;e;)o.push(e),a=e.previousComponent,delete e.previousComponent,e=a;o.reverse();for(var i=0,l=o.length,c=0,f=0;i<l;i++){var p=o[i];if(p.removed)p.value=t.join(r.slice(f,f+p.count)),f+=p.count;else{if(!p.added&&u){var d=n.slice(c,c+p.count);d=d.map(function(v,m){var y=r[f+m];return y.length>v.length?y:v}),p.value=t.join(d)}else p.value=t.join(n.slice(c,c+p.count));c+=p.count,p.added||(f+=p.count)}}return o}function M(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function W(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function I(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function N(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function k(t,e){return I(t,e,"")}function z(t,e){return N(t,e,"")}function A(t,e){return e.slice(0,_(t,e))}function _(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var u=Array(r),o=0;u[0]=0;for(var a=1;a<r;a++){for(e[a]==e[o]?u[a]=u[o]:u[a]=o;o>0&&e[a]!=e[o];)o=u[o];e[a]==e[o]&&o++}o=0;for(var i=n;i<t.length;i++){for(;o>0&&t[i]!=e[o];)o=u[o];t[i]==e[o]&&o++}return o}var j="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",B=new RegExp("[".concat(j,"]+|\\s+|[^").concat(j,"]"),"ug"),E=new h;E.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()},E.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(o){return o.segment})}else n=t.match(B)||[];var r=[],u=null;return n.forEach(function(o){/\s/.test(o)?u==null?r.push(o):r.push(r.pop()+o):/\s/.test(u)?r[r.length-1]==u?r.push(r.pop()+o):r.push(u+o):r.push(o),u=o}),r},E.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")},E.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,r=null,u=null;return t.forEach(function(o){o.added?r=o:o.removed?u=o:((r||u)&&R(n,u,r,o),n=o,r=null,u=null)}),(r||u)&&R(n,u,r,null),t};function R(t,e,n,r){if(e&&n){var u=e.value.match(/^\s*/)[0],o=e.value.match(/\s*$/)[0],a=n.value.match(/^\s*/)[0],i=n.value.match(/\s*$/)[0];if(t){var l=M(u,a);t.value=N(t.value,a,l),e.value=k(e.value,l),n.value=k(n.value,l)}if(r){var c=W(o,i);r.value=I(r.value,i,c),e.value=z(e.value,c),n.value=z(n.value,c)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),r&&(r.value=r.value.replace(/^\s*/,""));else if(t&&r){var f=r.value.match(/^\s*/)[0],p=e.value.match(/^\s*/)[0],d=e.value.match(/\s*$/)[0],v=M(f,p);e.value=k(e.value,v);var m=W(k(f,v),d);e.value=z(e.value,m),r.value=I(r.value,f,m),t.value=N(t.value,f,f.slice(0,f.length-m.length))}else if(r){var y=r.value.match(/^\s*/)[0],C=e.value.match(/\s*$/)[0],T=A(C,y);e.value=z(e.value,T)}else if(t){var b=t.value.match(/\s*$/)[0],s=e.value.match(/^\s*/)[0],g=A(b,s);e.value=k(e.value,g)}}var Z=new h;Z.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(j,"]+|[^\\S\\n\\r]+|[^").concat(j,"]"),"ug");return t.match(e)||[]};function G(t,e,n){return Z.diff(t,e,n)}var O=new h;O.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var u=0;u<r.length;u++){var o=r[u];u%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n},O.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),h.prototype.equals.call(this,t,e,n)};function H(t,e,n){return O.diff(t,e,n)}var Q=new h;Q.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var U=new h;U.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function $(t){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(t)}var S=new h;S.useLongestToken=!0,S.tokenize=O.tokenize,S.castInput=function(t,e){var n=e.undefinedReplacement,r=e.stringifyReplacer,u=r===void 0?function(o,a){return typeof a>"u"?n:a}:r;return typeof t=="string"?t:JSON.stringify(x(t,null,null,u),u,"  ")},S.equals=function(t,e,n){return h.prototype.equals.call(S,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function x(t,e,n,r,u){e=e||[],n=n||[],r&&(t=r(u,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var a;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),o=0;o<t.length;o+=1)a[o]=x(t[o],e,n,r,u);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),$(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var i=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&i.push(l);for(i.sort(),o=0;o<i.length;o+=1)l=i[o],a[l]=x(t[l],e,n,r,l);e.pop(),n.pop()}else a=t;return a}var q=new h;q.tokenize=function(t){return t.slice()},q.join=q.removeEmpty=function(t){return t};export{h as Diff,x as canonicalize,H as diffLines,G as diffWordsWithSpace};
